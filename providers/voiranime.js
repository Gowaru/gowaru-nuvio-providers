/**
 * voiranime - Built from src/voiranime/
 * Generated: 2026-02-25T11:06:32.981Z
 */
var K=Object.create;var E=Object.defineProperty,J=Object.defineProperties,B=Object.getOwnPropertyDescriptor,G=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols,Q=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var H=(t,s,e)=>s in t?E(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,d=(t,s)=>{for(var e in s||(s={}))L.call(s,e)&&H(t,e,s[e]);if(F)for(var e of F(s))X.call(s,e)&&H(t,e,s[e]);return t},S=(t,s)=>J(t,G(s));var Y=(t,s)=>{for(var e in s)E(t,e,{get:s[e],enumerable:!0})},P=(t,s,e,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let n of O(s))!L.call(t,n)&&n!==e&&E(t,n,{get:()=>s[n],enumerable:!(r=B(s,n))||r.enumerable});return t};var Z=(t,s,e)=>(e=t!=null?K(Q(t)):{},P(s||!t||!t.__esModule?E(e,"default",{value:t,enumerable:!0}):e,t)),tt=t=>P(E({},"__esModule",{value:!0}),t);var a=(t,s,e)=>new Promise((r,n)=>{var o=c=>{try{i(e.next(c))}catch(f){n(f)}},u=c=>{try{i(e.throw(c))}catch(f){n(f)}},i=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,u);i((e=e.apply(t,s)).next())});var wt={};Y(wt,{getStreams:()=>dt});module.exports=tt(wt);var et={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function R(e){return a(this,arguments,function*(t,s={}){console.log(`[VoirAnime] Fetching: ${t}`);let r=yield fetch(t,d({headers:d(d({},et),s.headers)},s));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var M=Z(require("cheerio"));var st={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"};function y(e){return a(this,arguments,function*(t,s={}){try{let r=new AbortController,n=setTimeout(()=>r.abort(),12e3),o=yield fetch(t,S(d({},s),{headers:d(d({},st),s.headers),signal:r.signal}));return clearTimeout(n),o}catch(r){return console.error(`[Resolver] Fetch failed for ${t}: ${r.message}`),null}})}function rt(t){return a(this,null,function*(){let s=yield y(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!s)return t;let e=yield s.text(),r=e.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||e.match(/src\s*:\s*"([^"]+\.mp4)"/)||e.match(/player\.setVideo\(\s*\{\s*"url"\s*:\s*"([^"]+)"/);if(r){let n=r[1];return n.startsWith("//")?n=`https:${n}`:n.startsWith("/")&&(n=`https://video.sibnet.ru${n}`),n}return t})}function q(t){return a(this,null,function*(){let s=yield y(t,{headers:{Referer:"https://vidmoly.to/"}});if(!s)return t;let e=yield s.text(),r=e.match(/file\s*:\s*"([^"]+\.m3u8)"/)||e.match(/file\s*:\s*"([^"]+\.mp4)"/)||e.match(/sources\s*:\s*\[\s*\{\s*file\s*:\s*"([^"]+)"/);return r?r[1]:t})}function nt(t){return a(this,null,function*(){let s=yield y(t,{headers:{Referer:"https://uqload.com/"}});if(!s)return t;let e=yield s.text(),r=e.match(/sources\s*:\s*\["([^"]+\.(?:mp4|m3u8))"\]/)||e.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/)||e.match(/file\s*:\s*"([^"]+\.(?:mp4|m3u8))"/);return r?r[1]:t})}function ot(t){return a(this,null,function*(){let s=yield y(t);if(!s)return t;let e=yield s.text(),r=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/window\.location\.href\s*=\s*'([^']+)'/);if(r){let n=r[1];if(n.includes("base64"))try{let o=n.split(",")[1]||n;typeof atob=="function"&&(n=atob(o))}catch(o){}return n}return t})}function it(t){return a(this,null,function*(){let s=yield y(t);if(!s)return t;let e=yield s.text(),r=e.match(/sources\s*:\s*\[\s*\{\s*"file"\s*:\s*"([^"]+)"/i)||e.match(/file\s*:\s*"([^"]+)"/i)||e.match(/src\s*:\s*"([^"]+\.m3u8)"/i);return r?r[1]:t})}function at(t){return a(this,null,function*(){let s=yield y(t);if(!s)return t;let e=yield s.text(),r=e.match(/file\s*:\s*"([^"]+)"/i)||e.match(/source\s*:\s*"([^"]+)"/i)||e.match(/video\s+src="([^"]+)"/i);return r?r[1]:t})}function ct(t){return a(this,null,function*(){let s=yield y(t);if(!s)return t;let e=yield s.text(),r=e.match(/file\s*:\s*"([^"]+)"/i)||e.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8|mkv))"/i);return r?r[1]:t})}function lt(t){return a(this,null,function*(){let s=yield y(t);if(!s)return t;let e=yield s.text(),r=e.match(/robotlink\.innerHTML\s*=\s*'([^']+)'\s*\+\s*'([^']+)'/);if(r)return`https:${r[1]}${r[2].substring(3)}`;let n=e.match(/id="robotlink">([^<]+)/);return n?`https:${n[1]}`:t})}function mt(t){return a(this,null,function*(){let s=yield y(t);if(!s)return t;let e=yield s.text(),r=e.match(/source\s+src="([^"]+\.mp4)"/i)||e.match(/video_source\s*:\s*"([^"]+)"/);return r?r[1]:t})}function ut(t){return a(this,null,function*(){let s="https://dood.to",e=yield y(t,{headers:{Referer:s}});if(!e)return t;let r=yield e.text(),n=r.match(/\$.get\('\/pass_md5\/([^']+)'/);if(n){let u=`${s}/pass_md5/${n[1]}`,i=yield y(u,{headers:{Referer:t}});if(i)return`${yield i.text()}z72899?token=${n[1]}&expiry=${Date.now()}`}let o=r.match(/window\.open\('([^']+)'\)/);return o?o[1]:t})}function k(t){return a(this,null,function*(){let s=t.url,e=s.toLowerCase();if(e.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return S(d({},t),{isDirect:!0});try{let r=s,n=d({},t.headers);if(e.includes("sibnet.ru")?(r=yield rt(s),n.Referer="https://video.sibnet.ru/"):e.includes("vidmoly.")?(r=yield q(s),n.Referer="https://vidmoly.to/"):e.includes("uqload.")?(r=yield nt(s),n.Referer="https://uqload.com/"):e.includes("voe.sx")||e.includes("christopheruntilpoint")?r=yield ot(s):e.includes("moonplayer")||e.includes("moonembed")?r=yield it(s):e.includes("mytv")||e.includes("mycloud")||e.includes("mclls.net")?(r=yield at(s),n.Referer="https://mycloud.cc/"):e.includes("fhd")||e.includes("fhd1")?r=yield ct(s):e.includes("upstream.")?r=yield q(s):e.includes("vido.")||e.includes("vidlo.")?r=yield q(s):e.includes("streamtape.com")?r=yield lt(s):e.includes("sendvid.com")?r=yield mt(s):(e.includes("dood")||e.includes("ds2play")||e.includes("viddood"))&&(r=yield ut(s)),r!==s&&r.startsWith("http"))return console.log(`[Resolver] Success: ${s.substring(0,30)}... -> ${r.substring(0,30)}...`),S(d({},t),{url:r,isDirect:!0,headers:n,originalUrl:s})}catch(r){console.error(`[Resolver] Failed for ${s}:`,r)}return S(d({},t),{isDirect:!1})})}var j="https://arm.haglund.dev/api/v2",W="https://api.jikan.moe/v4",ft="https://v3-cinemeta.strem.io";function T(e){return a(this,arguments,function*(t,s={}){try{let r=new AbortController,n=setTimeout(()=>r.abort(),8e3),o=yield fetch(t,S(d({},s),{signal:r.signal}));return clearTimeout(n),o}catch(r){return console.error(`[ArmSync] Fetch failed: ${t}`,r.message),null}})}function I(t,s){return a(this,null,function*(){if(!t)return null;let e=yield T(`${j}/themoviedb?id=${t}`);if(e){let r=yield e.json(),n=Array.isArray(r)?r[0]:r;if(n&&n.imdb)return n.imdb}return null})}function N(t,s,e){return a(this,null,function*(){var i,c,f;if(!t)return null;let r=s===0||s===void 0?"movie":"series",n=yield T(`${ft}/meta/${r}/${t}.json`);if(!n)return null;let o=yield n.json();if(r==="movie")return((c=(i=o==null?void 0:o.meta)==null?void 0:i.released)==null?void 0:c.split("T")[0])||null;if(!((f=o==null?void 0:o.meta)!=null&&f.videos))return null;let u=o.meta.videos.find(m=>m.season==s&&m.episode==e);return u&&u.released?u.released.split("T")[0]:null})}function _(t,s){return a(this,null,function*(){var o,u,i,c;if(!t||!s)return null;let e=yield T(`${j}/imdb?id=${t}`);if(!e)return null;let r=yield e.json();if(!Array.isArray(r))return null;let n=new Date(s);for(let f of r){let m=f.myanimelist;if(!m)continue;let g=yield T(`${W}/anime/${m}`);if(!g)continue;let l=(o=yield g.json())==null?void 0:o.data;if(!l)continue;let U=(u=l.aired)!=null&&u.from?new Date(l.aired.from):null,D=(i=l.aired)!=null&&i.to?new Date(l.aired.to):null;if(U){let A=new Date(U);A.setDate(A.getDate()-2);let b=D?new Date(D):new Date;if(b.setDate(b.getDate()+2),n>=A&&n<=b){if(l.type==="Movie"||l.episodes===1)return{malId:m,absoluteEpisode:1,type:l.type};let w=yield T(`${W}/anime/${m}/episodes`);if(w){let h=(c=yield w.json())==null?void 0:c.data;if(Array.isArray(h)){let p=h.find(x=>{if(!x.aired)return!1;let v=new Date(x.aired);return Math.abs(n-v)/(1e3*60*60*24)<=2});if(p)return{malId:m,absoluteEpisode:p.mal_id,title:l.title,animeType:l.type}}}return{malId:m,absoluteEpisode:null,potentialMatch:!0}}}}return null})}var V="https://v6.voiranime.com";function ht(t,s){return a(this,null,function*(){try{let e=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}?language=en-US`,r=yield R(e),n=M.default.load(r),o=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[VoirAnime] TMDB Title found: ${o}`),o}catch(e){return console.error(`[VoirAnime] Failed to get title from TMDB: ${e.message}`),null}})}function C(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function pt(t){return a(this,null,function*(){let s=[C(t),C(t.replace(/'s/gi,"")),C(t.replace(/'s/gi,"s"))],e=[];s.forEach(n=>{n.startsWith("the-")?e.push(n.substring(4)):e.push("the-"+n)});let r=[...new Set([...s,...e])];console.log(`[VoirAnime] Probing slugs: ${r.join(", ")}`);for(let n of r){let o=`${V}/anime/${n}/`;try{return yield R(o,{method:"HEAD"}),console.log(`[VoirAnime] Predicted slug found: ${n}`),o}catch(u){}}try{let n=`${V}/?s=${encodeURIComponent(t)}`,o=yield R(n),u=M.default.load(o),i=[];u(".post-title a").each((g,l)=>{i.push({title:u(l).text().trim(),url:u(l).attr("href")})});let c=g=>g.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),f=c(t);console.log(`[VoirAnime] Search results: ${i.length}`);let m=i.find(g=>c(g.title)===f);return m||(m=i.find(g=>{let l=c(g.title);return l.includes(f)&&!l.includes("film")&&!l.includes("log")&&!l.includes("kai")})),m||(m=i[0]),m?(console.log(`[VoirAnime] Selected from search: ${m.title} -> ${m.url}`),m.url):null}catch(n){return console.error(`[VoirAnime] Search error: ${n.message}`),null}})}function z(t,s,e,r){return a(this,null,function*(){let n=yield ht(t,s);if(!n)return[];let o=[r];try{let i=yield I(t,s);if(i){let c=yield N(i,e,r);if(c){let f=yield _(i,c);f&&f.absoluteEpisode&&(console.log(`[VoirAnime] ArmSync: S${e}E${r} -> Absolute ${f.absoluteEpisode}`),o.push(f.absoluteEpisode))}}}catch(i){console.warn(`[VoirAnime] ArmSync failed: ${i.message}`)}let u=yield pt(n);if(!u)return[];try{let i=yield R(u),c=M.default.load(i),f=r.toString(),m=["","0","00","000"],g=[];for(let w of o){let h=w.toString();m.forEach(p=>g.push((p+h).slice(-Math.max(h.length,p.length))))}let l=null;if(c(".listing-chapters a, .list-chapter a, .wp-manga-chapter a").each((w,h)=>{let p=c(h).text().trim(),x=c(h).attr("href");for(let v of g){let $=new RegExp(`(?:[^0-9]|^)${v}(?:[^0-9]|$)`);if($.test(p)||$.test(x))return l=x,!1}}),!l)return[];console.log(`[VoirAnime] Episode URL: ${l}`);let U=yield R(l),D=M.default.load(U),A=[],b=[];if(D('[name="host"] option, .host-select option').each((w,h)=>{let p=D(h).val();p&&p!=="Choisir un lecteur"&&b.push(p)}),b.length===0){let w=D('iframe[src*="embed"], iframe[src*="e/"]').first().attr("src");if(w){let h=yield k({name:"VoirAnime",title:"Default Player",quality:"HD",url:w,headers:{Referer:V}});A.push(h)}}else for(let w of b)try{let h=`${l}${l.includes("?")?"&":"?"}host=${encodeURIComponent(w)}`,p=yield R(h),x=p.match(/<iframe\s+.*?src="(https?:\/\/[^"]+)".*?><\/iframe>/i),v=x?x[1]:null;if(!v){let $=p.match(/https?:\/\/[^"']+\/(?:embed|e)\/[^"']+/);$&&!$[0].includes("voiranime.com")&&(v=$[0])}if(v){let $=yield k({name:`VoirAnime (${w})`,title:`${w} Player`,url:v,quality:"HD",headers:{Referer:V}});A.push($)}}catch(h){}return A}catch(i){return console.error(`[VoirAnime] Extraction error: ${i.message}`),[]}})}function dt(t,s,e,r){return a(this,null,function*(){console.log(`[VoirAnime] Request: ${s} ${t} S${e}E${r}`);try{return yield z(t,s,e,r)}catch(n){return console.error("[VoirAnime] Error:",n),[]}})}
