/**
 * voiranime - Built from src/voiranime/
 * Generated: 2026-02-25T22:30:07.635Z
 */
var G=Object.create;var M=Object.defineProperty,Q=Object.defineProperties,X=Object.getOwnPropertyDescriptor,Y=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertyNames,H=Object.getOwnPropertySymbols,tt=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var I=(t,s,e)=>s in t?M(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,m=(t,s)=>{for(var e in s||(s={}))_.call(s,e)&&I(t,e,s[e]);if(H)for(var e of H(s))et.call(s,e)&&I(t,e,s[e]);return t},$=(t,s)=>Q(t,Y(s));var st=(t,s)=>{for(var e in s)M(t,e,{get:s[e],enumerable:!0})},P=(t,s,e,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of Z(s))!_.call(t,o)&&o!==e&&M(t,o,{get:()=>s[o],enumerable:!(r=X(s,o))||r.enumerable});return t};var rt=(t,s,e)=>(e=t!=null?G(tt(t)):{},P(s||!t||!t.__esModule?M(e,"default",{value:t,enumerable:!0}):e,t)),nt=t=>P(M({},"__esModule",{value:!0}),t);var f=(t,s,e)=>new Promise((r,o)=>{var n=c=>{try{l(e.next(c))}catch(u){o(u)}},a=c=>{try{l(e.throw(c))}catch(u){o(u)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(n,a);l((e=e.apply(t,s)).next())});var At={};st(At,{getStreams:()=>bt});module.exports=nt(At);var it={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function b(e){return f(this,arguments,function*(t,s={}){console.log(`[VoirAnime] Fetching: ${t}`);let r=yield fetch(t,m({headers:m(m({},it),s.headers)},s));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var R=rt(require("cheerio"));var ot={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36"},N=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(s){return t}};function w(e){return f(this,arguments,function*(t,s={}){try{let r=yield fetch(t,$(m({},s),{headers:m(m({},ot),s.headers),redirect:"follow"}));if(!r.ok)return null;let o=yield r.text();return{text:()=>Promise.resolve(o),ok:!0,url:r.url,headers:r.headers}}catch(r){return null}})}function T(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let s=new RegExp("eval\\s*\\(\\s*function\\s*\\(\\s*p\\s*,\\s*a\\s*,\\s*c\\s*,\\s*k\\s*,\\s*e\\s*,\\s*d\\s*\\).*?\\}\\s*\\((.*?)\\)\\s*\\)","gs"),e=t,r;for(;(r=s.exec(t))!==null;)try{let n=r[1].match(new RegExp("^'(.*?)',\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*'(.*?)'\\.split\\('\\|'\\)","s"));if(!n)continue;let a=n[1].replace(/\\'/g,"'"),l=parseInt(n[2]),c=parseInt(n[3]),u=n[4].split("|"),i=p=>(p<l?"":i(parseInt(p/l)))+((p=p%l)>35?String.fromCharCode(p+29):p.toString(36)),h={};for(;c--;)h[i(c)]=u[c]||i(c);let g=a.replace(/\b\w+\b/g,p=>h[p]||p);e=e.replace(r[0],g)}catch(o){}return e}catch(s){return t}}function at(t){return f(this,null,function*(){try{let s=yield w(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!s)return{url:t};let e=yield s.text(),r=e.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||e.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let o=r[1];return o.startsWith("//")?o="https:"+o:o.startsWith("/")&&(o="https://video.sibnet.ru"+o),{url:o,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(s){}return{url:t}})}function ct(t){return f(this,null,function*(){try{let s=yield w(t,{headers:{Referer:"https://vidmoly.to/"}});if(!s)return{url:t};let e=yield s.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=T(e));let r=e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(s){}return{url:t}})}function lt(t){return f(this,null,function*(){try{let s=yield w(t,{headers:{Referer:"https://uqload.com/"}});if(!s)return{url:t};let e=yield s.text(),r=e.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(r)return{url:r[1],headers:{Referer:"https://uqload.com/"}}}catch(s){}return{url:t}})}function ut(t){return f(this,null,function*(){try{let s=yield w(t);if(!s)return{url:t};let e=yield s.text(),r=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r){let n=yield w(r[1]);n&&(e=yield n.text())}let o=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(o){let n=o[1]||o[0];return n.includes("base64")&&(n=N(n.split(",")[1]||n)),{url:n,headers:{Referer:t}}}}catch(s){}return{url:t}})}function ht(t){return f(this,null,function*(){try{let s=yield w(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=T(e));let r=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(r){let o="https:"+r[1],n=r[2].split("+");for(let a of n){let l=a.match(/['"]([^'"]+)['"]/);if(l){let c=l[1],u=a.match(/substring\((\d+)\)/);u&&(c=c.substring(parseInt(u[1]))),o+=c}}return{url:o,headers:{Referer:"https://streamtape.com/"}}}}catch(s){}return{url:t}})}function ft(t){return f(this,null,function*(){try{let s=yield w(t);if(!s)return{url:t};let e=yield s.text(),r=e.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.mp4[^"']*)["']/);if(r)return{url:r[1]}}catch(s){}return{url:t}})}function mt(t){return f(this,null,function*(){try{let s=yield w(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=T(e));let r=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r){let o=r[1];return o.includes("base64")&&(o=N(o.split(",")[1]||o)),{url:o,headers:{Referer:t}}}}catch(s){}return{url:t}})}function pt(t){return f(this,null,function*(){try{let s=yield w(t);if(!s)return{url:t};let r=(yield s.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:t}}}catch(s){}return{url:t}})}function dt(t){return f(this,null,function*(){var s;try{let e=((s=t.match(/https?:\/\/([^\/]+)/))==null?void 0:s[1])||"dood.to",r=yield w(t);if(!r)return{url:t};let o=yield r.text();o.includes("eval(function(p,a,c,k,e,d)")&&(o=T(o));let n=o.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(n){let a=n[1],l=`https://${e}/pass_md5/${a}`,c=yield fetch(l,{headers:{Referer:t}});if(c.ok){let u=yield c.text(),i=Math.random().toString(36).substring(2,12);return{url:u+i+"?token="+a+"&expiry="+Date.now(),headers:{Referer:`https://${e}/`}}}}}catch(e){}return{url:t}})}function wt(t){return f(this,null,function*(){try{let s=yield w(t);if(!s)return{url:t};let r=(yield s.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:t}}}catch(s){}return{url:t}})}function C(t,s=0){return f(this,null,function*(){var o;if(s>3)return $(m({},t),{isDirect:!1});let e=t.url,r=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(r.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!r.includes("html"))return $(m({},t),{isDirect:!0});try{let n=null;if(r.includes("sibnet.ru")?n=yield at(e):r.includes("vidmoly.")?n=yield ct(e):r.includes("uqload.")||r.includes("oneupload.")?n=yield lt(e):r.includes("voe.")?n=yield ut(e):r.includes("streamtape.com")||r.includes("stape")?n=yield ht(e):r.includes("dood")||r.includes("ds2play")?n=yield dt(e):r.includes("moonplayer")||r.includes("moon.")?n=yield wt(e):r.includes("sendvid.")?n=yield ft(e):r.includes("luluvid.")||r.includes("lulu.")?n=yield mt(e):(r.includes("hgcloud.")||r.includes("savefiles."))&&(n=yield pt(e)),n&&n.url!==e)return $(m({},t),{url:n.url,headers:m(m({},t.headers),n.headers||{}),isDirect:!0,originalUrl:e});if(!n||n.url===e){let a=yield w(e,{headers:t.headers});if(a){let l=yield a.text();l.includes("p,a,c,k,e,d")&&(l=T(l));let c=l.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||l.match(/https?:\/\/[^"']+\.mp4[^"']*/)||l.match(/file\s*:\s*["']([^"']+)["']/);if(c){let u=c[1]||c[0];u.startsWith("//")&&(u="https:"+u),u.startsWith("http")&&!u.includes(gt)&&(n={url:u})}if(!n){let u=l.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(u){let i=u[1];if(i.startsWith("//")&&(i="https:"+i),i.startsWith("/")){let h=(o=e.match(/^https?:\/\/[^\/]+/))==null?void 0:o[0];h&&(i=h+i)}if(i.startsWith("http")&&i!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${i}`),yield C($(m({},t),{url:i}),s+1)}}}}if(n&&n.url!==e&&n.url.startsWith("http"))return $(m({},t),{url:n.url,headers:m(m({},t.headers),n.headers||{}),isDirect:!0,originalUrl:e})}catch(n){}return $(m({},t),{isDirect:!1})})}var gt="googletagmanager";var yt="https://arm.haglund.dev/api/v2";var $t="https://v3-cinemeta.strem.io";function W(e){return f(this,arguments,function*(t,s={}){try{let r=new AbortController,o=setTimeout(()=>r.abort(),8e3),n=yield fetch(t,$(m({},s),{signal:r.signal}));return clearTimeout(o),n}catch(r){return console.error(`[ArmSync] Fetch failed: ${t}`,r.message),null}})}function B(t,s){return f(this,null,function*(){if(!t)return null;let e=yield W(`${yt}/themoviedb?id=${t}`);if(e)try{let n=yield e.json(),a=Array.isArray(n)?n[0]:n;if(a&&a.imdb)return a.imdb}catch(n){}let r=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}`,o=yield W(r);if(o){let a=(yield o.text()).match(/imdb\.com\/title\/(tt\d+)/);if(a)return a[1]}return null})}function z(t,s,e){return f(this,null,function*(){var u;if(!t||s===0)return null;let r=yield W(`${$t}/meta/series/${t}.json`);if(!r)return null;let o=yield r.json();if(!((u=o==null?void 0:o.meta)!=null&&u.videos))return null;let n=o.meta.videos.filter(i=>i.season>0&&i.episode>0).sort((i,h)=>i.season-h.season||i.episode-h.episode),a=[],l=new Set;for(let i of n){let h=`${i.season}-${i.episode}`;l.has(h)||(l.add(h),a.push(i))}let c=a.findIndex(i=>i.season==s&&i.episode==e);if(c!==-1){let i=c+1;return console.log(`[ArmSync] Resolved: S${s}E${e} -> Absolute ${i}`),i}return null})}var V="https://v6.voiranime.com";function vt(t,s){return f(this,null,function*(){try{let e=[],r=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}?language=en-US`,o=yield b(r),n=R.load(o),a=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();a&&a.includes(" (")&&(a=a.split(" (")[0]),a&&a.includes(" - ")&&(a=a.split(" - ")[0]),a&&e.push(a.trim());let l=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}?language=fr-FR`,c=yield b(l),u=R.load(c),i=u('meta[property="og:title"]').attr("content")||u("h1").first().text()||u("h2").first().text();return i&&i.includes(" (")&&(i=i.split(" (")[0]),i&&i.includes(" - ")&&(i=i.split(" - ")[0]),i&&i.trim()!==(a==null?void 0:a.trim())&&e.push(i.trim()),console.log(`[VoirAnime] TMDB Titles found: ${e.join(", ")}`),e}catch(e){return console.error(`[VoirAnime] Failed to get titles from TMDB: ${e.message}`),[]}})}function q(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function xt(t){return f(this,null,function*(){let s=[q(t),q(t.replace(/'s/gi,"")),q(t.replace(/'s/gi,"s"))],e=[];s.forEach(n=>{n.startsWith("the-")?e.push(n.substring(4)):e.push("the-"+n)});let r=[...new Set([...s,...e])];console.log(`[VoirAnime] Probing slugs: ${r.join(", ")}`);let o=[];for(let n of r){let a=`${V}/anime/${n}/`;try{yield b(a,{method:"HEAD"}),console.log(`[VoirAnime] Predicted slug found: ${n}`),o.push({title:t,url:a});break}catch(l){}}if(o.length>0)return o;try{let n=`${V}/?s=${encodeURIComponent(t)}`,a=yield b(n),l=R.load(a),c=[];l(".post-title a").each((g,p)=>{c.push({title:l(p).text().trim(),url:l(p).attr("href")})});let u=g=>g.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),i=u(t);console.log(`[VoirAnime] Search results: ${c.length}`);let h=c.filter(g=>u(g.title).includes(i));return h.length===0&&c.length>0&&(h=c),h.length>0?(console.log(`[VoirAnime] Found ${h.length} matches for ${t}`),h):[]}catch(n){return console.error(`[VoirAnime] Search error: ${n.message}`),[]}})}function K(t,s,e,r){return f(this,null,function*(){let o=yield vt(t,s);if(o.length===0)return[];let n=[r];try{let i=yield B(t,s);if(i){let h=yield z(i,e,r);h&&h!==r&&n.push(h)}}catch(i){console.warn(`[VoirAnime] ArmSync failed: ${i.message}`)}let a=[];for(let i of o)if(a=yield xt(i),a&&a.length>0)break;if(!a||a.length===0)return[];a=a.sort((i,h)=>{let g=i.title.toLowerCase(),p=h.title.toLowerCase(),k=`saison ${e}`,D=g.includes(k),A=p.includes(k);return D&&!A?-1:!D&&A?1:0});let l=[],c=new Set;for(let i of a){if(c.has(i.url))continue;c.add(i.url);let h=i.title.toLowerCase(),g=i.url,p=i.title.toUpperCase().includes("VF")||g.includes("-vf")?"VF":"VOSTFR",k=h.match(/saison\s*(\d+)/);if(!(k&&parseInt(k[1])!==e&&n.length===1))try{let D=yield b(g),A=R.load(D),J=["","0","00"],j=[];for(let v of n){let d=v.toString();J.forEach(y=>j.push(y+d))}let E=null;if(A(".listing-chapters a, .list-chapter a, .wp-manga-chapter a").each((v,d)=>{let y=A(d).text().trim(),U=A(d).attr("href");for(let S of j){let x=new RegExp(`(?:^|[^0-9])${S}(?:$|[^0-9])`,"i");if(x.test(y)||x.test(U))return E=U,!1}}),!E)continue;let O=yield b(E),F=R.load(O),L=[];if(F('[name="host"] option, .host-select option').each((v,d)=>{let y=F(d).val();y&&y!=="Choisir un lecteur"&&L.push(y)}),L.length===0){let v=F('iframe[src*="embed"], iframe[src*="e/"]').first().attr("src");if(v){let d=yield C({name:`VoirAnime (${p})`,title:`Default Player - ${p}`,quality:"HD",url:v,headers:{Referer:V}});d&&l.push(d)}}else for(let v of L)try{let d=`${E}${E.includes("?")?"&":"?"}host=${encodeURIComponent(v)}`,y=yield b(d),U=y.match(/<iframe\s+.*?src="(https?:\/\/[^"]+)".*?><\/iframe>/i),S=U?U[1]:null;if(!S){let x=y.match(/https?:\/\/[^"']+\/(?:embed|e)\/[^"']+/);x&&!x[0].includes("voiranime.com")&&(S=x[0])}if(S){let x=yield C({name:`VoirAnime (${p})`,title:`${v} - ${p}`,url:S,quality:"HD",headers:{Referer:V}});x&&l.push(x)}}catch(d){}}catch(D){}}let u=l.filter(i=>i&&i.isDirect);return console.log(`[VoirAnime] Total streams found: ${u.length}`),u})}function bt(t,s,e,r){return f(this,null,function*(){console.log(`[VoirAnime] Request: ${s} ${t} S${e}E${r}`);try{return yield K(t,s,e,r)}catch(o){return console.error("[VoirAnime] Error:",o),[]}})}
