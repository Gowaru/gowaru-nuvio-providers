/**
 * voiranime - Built from src/voiranime/
 * Generated: 2026-02-25T15:40:09.561Z
 */
var N=Object.create;var S=Object.defineProperty,_=Object.defineProperties,z=Object.getOwnPropertyDescriptor,K=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertyNames,V=Object.getOwnPropertySymbols,J=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var q=(t,e,s)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,m=(t,e)=>{for(var s in e||(e={}))C.call(e,s)&&q(t,s,e[s]);if(V)for(var s of V(e))G.call(e,s)&&q(t,s,e[s]);return t},y=(t,e)=>_(t,K(e));var O=(t,e)=>{for(var s in e)S(t,s,{get:e[s],enumerable:!0})},H=(t,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of B(e))!C.call(t,r)&&r!==s&&S(t,r,{get:()=>e[r],enumerable:!(n=z(e,r))||n.enumerable});return t};var Q=(t,e,s)=>(s=t!=null?N(J(t)):{},H(e||!t||!t.__esModule?S(s,"default",{value:t,enumerable:!0}):s,t)),X=t=>H(S({},"__esModule",{value:!0}),t);var l=(t,e,s)=>new Promise((n,r)=>{var o=i=>{try{a(s.next(i))}catch(p){r(p)}},c=i=>{try{a(s.throw(i))}catch(p){r(p)}},a=i=>i.done?n(i.value):Promise.resolve(i.value).then(o,c);a((s=s.apply(t,e)).next())});var ft={};O(ft,{getStreams:()=>ht});module.exports=X(ft);var Y={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function v(s){return l(this,arguments,function*(t,e={}){console.log(`[VoirAnime] Fetching: ${t}`);let n=yield fetch(t,m({headers:m(m({},Y),e.headers)},e));if(!n.ok)throw new Error(`HTTP error ${n.status} for ${t}`);return yield n.text()})}var R=Q(require("cheerio"));var j={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"};function x(s){return l(this,arguments,function*(t,e={}){try{let n=yield fetch(t,y(m({},e),{headers:m(m({},j),e.headers),redirect:"follow"}));if(!n.ok)return null;let r=yield n.text(),o=r.match(/window\.location\.(?:replace|href)\s*\(['"]([^'"]+)['"]\)/i);if(o){let c=o[1];c.startsWith("/")&&(c=t.match(/https?:\/\/[^\/]+/)[0]+c);let a=yield fetch(c,y(m({},e),{headers:m(y(m({},j),{Referer:t}),e.headers)}));if(a.ok){let i=yield a.text();return{text:()=>Promise.resolve(i),ok:!0,url:a.url}}}return{text:()=>Promise.resolve(r),ok:!0,url:n.url}}catch(n){return null}})}function Z(t){return l(this,null,function*(){let e=yield x(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!e)return t;let s=yield e.text(),n=s.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||s.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||s.match(/video_url\s*:\s*'([^']+)'/);if(n){let r=n[1];return r.startsWith("//")?r="https:"+r:r.startsWith("/")&&(r="https://video.sibnet.ru"+r),r}return t})}function tt(t){return l(this,null,function*(){let e=yield x(t,{headers:{Referer:"https://vidmoly.to/"}});if(!e)return t;let s=yield e.text(),n=s.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/)||s.match(/sources\s*:\s*\[\s*\{\s*file\s*:\s*["']([^"']+)["']/)||s.match(/["']?file["']?\s*:\s*["']([^"']+)["']/);return n?n[1]:t})}function et(t){return l(this,null,function*(){let e=yield x(t,{headers:{Referer:"https://uqload.com/"}});if(!e)return t;let s=yield e.text(),n=s.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||s.match(/src\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/)||s.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);return n?n[1]:t})}function st(t){return l(this,null,function*(){let e=yield x(t);if(!e)return t;let s=yield e.text(),n=s.match(/'hls'\s*:\s*'([^']+)'/)||s.match(/"hls"\s*:\s*"([^"]+)"/);if(n){let o=n[1];if(o.includes("base64"))try{let c=o.split(",")[1]||o;o=atob(c)}catch(c){}return o}let r=s.match(/https?:\/\/[^"']+\.m3u8[^"']*/);return r?r[0]:t})}function nt(t){return l(this,null,function*(){let e=yield x(t);if(!e)return t;let s=yield e.text(),n=s.match(/document\.getElementById\(['"]robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*(?:['"]([^'"]+)['"]|(\w+))/);if(n){let o=n[1],c=n[2]||"";return"https:"+o+c}let r=s.match(/id=['"]robotlink['"]>([^<]+)/);return r?"https:"+r[1]:t})}function rt(t){return l(this,null,function*(){try{let e=t.match(/https?:\/\/([^\/]+)/)[1],s=yield x(t);if(!s)return t;let r=(yield s.text()).match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(r){let o=`https://${e}/pass_md5/${r[1]}`,c=yield fetch(o,{headers:{Referer:t}});if(c.ok)return(yield c.text())+"z762vpz?token="+r[1]+"&expiry="+Date.now()}}catch(e){}return t})}function ot(t){return l(this,null,function*(){let e=yield x(t);if(!e)return t;let s=yield e.text(),n=s.match(/source\s*src=['"]([^'"]+\.mp4)['"]/)||s.match(/content=['"]([^'"]+\.mp4)['"]/);return n?n[1]:t})}function it(t){return l(this,null,function*(){let e=yield x(t);if(!e)return t;let s=yield e.text(),n=s.match(/vurl=["']([^"']+)["']/)||s.match(/file\s*:\s*["']([^"']+)["']/);if(n){let r=n[1];return r.startsWith("//")&&(r="https:"+r),r}return t})}function at(t){return l(this,null,function*(){let e=yield x(t);if(!e)return t;let n=(yield e.text()).match(/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/);return n?n[1]:t})}function U(t){return l(this,null,function*(){let e=t.url,s=e.toLowerCase();if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return y(m({},t),{isDirect:!0});try{let n=e,r=m({},t.headers);if(s.includes("sibnet.ru")?(n=yield Z(e),r.Referer="https://video.sibnet.ru/"):s.includes("vidmoly.")?(n=yield tt(e),r.Referer="https://vidmoly.to/"):s.includes("uqload.")||s.includes("oneupload.")?(n=yield et(e),r.Referer="https://uqload.com/"):s.includes("voe.")?n=yield st(e):s.includes("streamtape.com")||s.includes("stape")?n=yield nt(e):s.includes("dood")||s.includes("ds2play")?n=yield rt(e):s.includes("sendvid.com")?n=yield ot(e):s.includes("myvi.")||s.includes("mytv")?n=yield it(e):(s.includes("moonplayer")||s.includes("moon."))&&(n=yield at(e)),n!==e&&n.startsWith("http"))return y(m({},t),{url:n,isDirect:!0,headers:r})}catch(n){}return y(m({},t),{isDirect:!1})})}var ct="https://arm.haglund.dev/api/v2";var lt="https://v3-cinemeta.strem.io";function W(s){return l(this,arguments,function*(t,e={}){try{let n=new AbortController,r=setTimeout(()=>n.abort(),8e3),o=yield fetch(t,y(m({},e),{signal:n.signal}));return clearTimeout(r),o}catch(n){return console.error(`[ArmSync] Fetch failed: ${t}`,n.message),null}})}function P(t,e){return l(this,null,function*(){if(!t)return null;let s=yield W(`${ct}/themoviedb?id=${t}`);if(s){let n=yield s.json(),r=Array.isArray(n)?n[0]:n;if(r&&r.imdb)return r.imdb}return null})}function L(t,e,s){return l(this,null,function*(){var a;if(!t||e===0)return null;let n=yield W(`${lt}/meta/series/${t}.json`);if(!n)return null;let r=yield n.json();if(!((a=r==null?void 0:r.meta)!=null&&a.videos))return null;let c=r.meta.videos.filter(i=>i.season>0).sort((i,p)=>i.season-p.season||i.episode-p.episode).findIndex(i=>i.season==e&&i.episode==s);if(c!==-1){let i=c+1;return console.log(`[ArmSync] Resolved: S${e}E${s} -> Absolute ${i}`),i}return null})}var D="https://v6.voiranime.com";function mt(t,e){return l(this,null,function*(){try{let s=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,n=yield v(s),r=R.default.load(n),o=r('meta[property="og:title"]').attr("content")||r("h1").first().text()||r("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[VoirAnime] TMDB Title found: ${o}`),o}catch(s){return console.error(`[VoirAnime] Failed to get title from TMDB: ${s.message}`),null}})}function k(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function ut(t){return l(this,null,function*(){let e=[k(t),k(t.replace(/'s/gi,"")),k(t.replace(/'s/gi,"s"))],s=[];e.forEach(r=>{r.startsWith("the-")?s.push(r.substring(4)):s.push("the-"+r)});let n=[...new Set([...e,...s])];console.log(`[VoirAnime] Probing slugs: ${n.join(", ")}`);for(let r of n){let o=`${D}/anime/${r}/`;try{return yield v(o,{method:"HEAD"}),console.log(`[VoirAnime] Predicted slug found: ${r}`),o}catch(c){}}try{let r=`${D}/?s=${encodeURIComponent(t)}`,o=yield v(r),c=R.default.load(o),a=[];c(".post-title a").each((g,u)=>{a.push({title:c(u).text().trim(),url:c(u).attr("href")})});let i=g=>g.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),p=i(t);console.log(`[VoirAnime] Search results: ${a.length}`);let d=a.find(g=>i(g.title)===p);return d||(d=a.find(g=>{let u=i(g.title);return u.includes(p)&&!u.includes("film")&&!u.includes("log")&&!u.includes("kai")})),d||(d=a[0]),d?(console.log(`[VoirAnime] Selected from search: ${d.title} -> ${d.url}`),d.url):null}catch(r){return console.error(`[VoirAnime] Search error: ${r.message}`),null}})}function F(t,e,s,n){return l(this,null,function*(){let r=yield mt(t,e);if(!r)return[];let o=[n];try{let a=yield P(t,e);if(a){let i=yield L(a,s,n);i&&o.push(i)}}catch(a){console.warn(`[VoirAnime] ArmSync failed: ${a.message}`)}let c=yield ut(r);if(!c)return[];try{let a=yield v(c),i=R.default.load(a),p=n.toString(),d=["","0","00","000"],g=[];for(let w of o){let h=w.toString();d.forEach(f=>g.push((f+h).slice(-Math.max(h.length,f.length))))}let u=null;if(i(".listing-chapters a, .list-chapter a, .wp-manga-chapter a").each((w,h)=>{let f=i(h).text().trim(),b=i(h).attr("href");for(let A of g){let $=new RegExp(`(?:[^0-9]|^)${A}(?:[^0-9]|$)`);if($.test(f)||$.test(b))return u=b,!1}}),!u)return[];console.log(`[VoirAnime] Episode URL: ${u}`);let I=yield v(u),E=R.default.load(I),M=[],T=[];if(E('[name="host"] option, .host-select option').each((w,h)=>{let f=E(h).val();f&&f!=="Choisir un lecteur"&&T.push(f)}),T.length===0){let w=E('iframe[src*="embed"], iframe[src*="e/"]').first().attr("src");if(w){let h=yield U({name:"VoirAnime",title:"Default Player",quality:"HD",url:w,headers:{Referer:D}});M.push(h)}}else for(let w of T)try{let h=`${u}${u.includes("?")?"&":"?"}host=${encodeURIComponent(w)}`,f=yield v(h),b=f.match(/<iframe\s+.*?src="(https?:\/\/[^"]+)".*?><\/iframe>/i),A=b?b[1]:null;if(!A){let $=f.match(/https?:\/\/[^"']+\/(?:embed|e)\/[^"']+/);$&&!$[0].includes("voiranime.com")&&(A=$[0])}if(A){let $=yield U({name:`VoirAnime (${w})`,title:`${w} Player`,url:A,quality:"HD",headers:{Referer:D}});M.push($)}}catch(h){}return M}catch(a){return console.error(`[VoirAnime] Extraction error: ${a.message}`),[]}})}function ht(t,e,s,n){return l(this,null,function*(){console.log(`[VoirAnime] Request: ${e} ${t} S${s}E${n}`);try{return yield F(t,e,s,n)}catch(r){return console.error("[VoirAnime] Error:",r),[]}})}
