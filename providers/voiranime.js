/**
 * voiranime - Built from src/voiranime/
 * Generated: 2026-02-26T11:28:28.708Z
 */
var X=Object.create;var E=Object.defineProperty,tt=Object.defineProperties,et=Object.getOwnPropertyDescriptor,st=Object.getOwnPropertyDescriptors,rt=Object.getOwnPropertyNames,P=Object.getOwnPropertySymbols,nt=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable;var I=(t,r,e)=>r in t?E(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,d=(t,r)=>{for(var e in r||(r={}))H.call(r,e)&&I(t,e,r[e]);if(P)for(var e of P(r))at.call(r,e)&&I(t,e,r[e]);return t},A=(t,r)=>tt(t,st(r));var it=(t,r)=>{for(var e in r)E(t,e,{get:r[e],enumerable:!0})},z=(t,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of rt(r))!H.call(t,a)&&a!==e&&E(t,a,{get:()=>r[a],enumerable:!(s=et(r,a))||s.enumerable});return t};var ot=(t,r,e)=>(e=t!=null?X(nt(t)):{},z(r||!t||!t.__esModule?E(e,"default",{value:t,enumerable:!0}):e,t)),ct=t=>z(E({},"__esModule",{value:!0}),t);var m=(t,r,e)=>new Promise((s,a)=>{var n=c=>{try{l(e.next(c))}catch(u){a(u)}},o=c=>{try{l(e.throw(c))}catch(u){a(u)}},l=c=>c.done?s(c.value):Promise.resolve(c.value).then(n,o);l((e=e.apply(t,r)).next())});var Dt={};it(Dt,{getStreams:()=>kt});module.exports=ct(Dt);var lt={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function D(e){return m(this,arguments,function*(t,r={}){console.log(`[VoirAnime] Fetching: ${t}`);let s=yield fetch(t,d({headers:d(d({},lt),r.headers)},r));if(!s.ok)throw new Error(`HTTP error ${s.status} for ${t}`);return yield s.text()})}var C=ot(require("cheerio-without-node-native"));var ut={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36"},N=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(r){return t}};function g(e){return m(this,arguments,function*(t,r={}){try{let s=yield fetch(t,A(d({},r),{headers:d(d({},ut),r.headers),redirect:"follow"}));if(!s.ok)return null;let a=yield s.text();return{text:()=>Promise.resolve(a),ok:!0,url:s.url,headers:s.headers}}catch(s){return null}})}function M(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let r=new RegExp("eval\\s*\\(\\s*function\\s*\\(\\s*p\\s*,\\s*a\\s*,\\s*c\\s*,\\s*k\\s*,\\s*e\\s*,\\s*d\\s*\\).*?\\}\\s*\\((.*?)\\)\\s*\\)","gs"),e=t,s;for(;(s=r.exec(t))!==null;)try{let n=s[1].match(new RegExp("^'(.*?)',\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*'(.*?)'\\.split\\('\\|'\\)","s"));if(!n)continue;let o=n[1].replace(/\\'/g,"'"),l=parseInt(n[2]),c=parseInt(n[3]),u=n[4].split("|"),i=f=>(f<l?"":i(parseInt(f/l)))+((f=f%l)>35?String.fromCharCode(f+29):f.toString(36)),h={};for(;c--;)h[i(c)]=u[c]||i(c);let y=o.replace(/\b\w+\b/g,f=>h[f]||f);e=e.replace(s[0],y)}catch(a){}return e}catch(r){return t}}function ht(t){return m(this,null,function*(){try{let r=yield g(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!r)return{url:t};let e=yield r.text(),s=e.match(/file\s*:\s*["']([^"']*\.mp4[^"']*)['"]/i)||e.match(/src\s*:\s*["']([^"']*\.mp4[^"']*)['"]/i)||e.match(/["']((?:https?:)?\/\/[^"'\s]+\.mp4[^"'\s]*)["']/i);if(s){let a=s[1];return a.startsWith("//")?a="https:"+a:a.startsWith("/")&&(a="https://video.sibnet.ru"+a),{url:a,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(r){}return{url:t}})}function mt(t){return m(this,null,function*(){try{let r={Referer:"https://vidmoly.to/",Origin:"https://vidmoly.to"},e=yield g(t,{headers:r});if(!e)return{url:t};let s=yield e.text(),a=s.match(/window\.location\.replace\(['"]([^'"]+)['"]\)/)||s.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);a&&a[1]!==t&&(e=yield g(a[1],{headers:r}),e&&(s=yield e.text())),s.includes("eval(function(p,a,c,k,e,d)")&&(s=M(s));let n=s.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/i)||s.match(/["'](https?:\/\/[^"']+\.(?:m3u8|mp4)[^"']*)["']/i);if(n)return{url:n[1],headers:{Referer:"https://vidmoly.to/"}}}catch(r){}return{url:t}})}function ft(t){return m(this,null,function*(){let r=t.replace(/^https?:\/\/[^/]+/,""),e=["uqload.co","uqload.com","uqload.io","uqloads.xyz","uqload.to"],s="https://uqload.co/";for(let a of e)try{let n=`https://${a}${r}`,o=yield g(n,{headers:{Referer:s}});if(!o)continue;let l=yield o.text(),c=l.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||l.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/)||l.match(/["'](https?:\/\/[^"']+\.(?:mp4|m3u8)[^"']*)["']/i);if(c)return{url:c[1],headers:{Referer:s}}}catch(n){}return{url:t}})}function dt(t){return m(this,null,function*(){try{let r=yield g(t);if(!r)return{url:t};let e=yield r.text(),s=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(s){let n=yield g(s[1]);n&&(e=yield n.text())}let a=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(a){let n=a[1]||a[0];return n.includes("base64")&&(n=N(n.split(",")[1]||n)),{url:n,headers:{Referer:t}}}}catch(r){}return{url:t}})}function pt(t){return m(this,null,function*(){try{let r=yield g(t);if(!r)return{url:t};let e=yield r.text();e.includes("p,a,c,k,e,d")&&(e=M(e));let s=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(s){let a="https:"+s[1],n=s[2].split("+");for(let o of n){let l=o.match(/['"]([^'"]+)['"]/);if(l){let c=l[1],u=o.match(/substring\((\d+)\)/);u&&(c=c.substring(parseInt(u[1]))),a+=c}}return{url:a,headers:{Referer:"https://streamtape.com/"}}}}catch(r){}return{url:t}})}function wt(t){return m(this,null,function*(){try{let r=t.includes("/embed/")?t:t.replace(/sendvid\.com\/([a-z0-9]+)/i,"sendvid.com/embed/$1"),e=yield g(r,{headers:{Referer:"https://sendvid.com/"}});if(!e)return{url:t};let s=yield e.text(),a=s.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["|']/)||s.match(/source\s+src=["']([^"']+\.mp4[^"']*)["|']/)||s.match(/<source[^>]+src=["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/)||s.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["|']/)||s.match(/["'](https?:\/\/[^"']+\.mp4[^"']*)["']/);if(a)return{url:a[1],headers:{Referer:"https://sendvid.com/"}}}catch(r){}return{url:t}})}function gt(t){return m(this,null,function*(){try{let r=yield g(t);if(!r)return{url:t};let e=yield r.text();e.includes("p,a,c,k,e,d")&&(e=M(e));let s=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(s){let a=s[1];return a.includes("base64")&&(a=N(a.split(",")[1]||a)),{url:a,headers:{Referer:t}}}}catch(r){}return{url:t}})}function yt(t){return m(this,null,function*(){try{let r=yield g(t);if(!r)return{url:t};let s=(yield r.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(s)return{url:s[1],headers:{Referer:t}}}catch(r){}return{url:t}})}function vt(t){return m(this,null,function*(){var r;try{let e=((r=t.match(/https?:\/\/([^\/]+)/))==null?void 0:r[1])||"dood.to",s=yield g(t);if(!s)return{url:t};let a=yield s.text();a.includes("eval(function(p,a,c,k,e,d)")&&(a=M(a));let n=a.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(n){let o=n[1],l=`https://${e}/pass_md5/${o}`,c=yield fetch(l,{headers:{Referer:t}});if(c.ok){let u=yield c.text(),i=Math.random().toString(36).substring(2,12);return{url:u+i+"?token="+o+"&expiry="+Date.now(),headers:{Referer:`https://${e}/`}}}}}catch(e){}return{url:t}})}function $t(t){return m(this,null,function*(){try{let r=yield g(t,{headers:{Referer:"https://www.myvi.ru/"}});if(!r)return{url:t};let e=yield r.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=M(e));let s=e.match(/["'](?:file|src|url|stream_url)["']\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/)||e.match(/["'](https?:\/\/[^"']+\.(?:mp4|m3u8)[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.(?:mp4|m3u8)[^"']*)/);if(s)return{url:s[1],headers:{Referer:"https://www.myvi.ru/"}};let a=t.match(/\/(?:embed\/|watch\/|video\/)([a-zA-Z0-9_-]+)/);if(a){let n=`https://www.myvi.ru/api/video/${a[1]}`,o=yield g(n,{headers:{Referer:t}});if(o){let c=(yield o.text()).match(/["'](?:url|src|file)["']\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(c)return{url:c[1],headers:{Referer:"https://www.myvi.ru/"}}}}}catch(r){}return{url:t}})}function xt(t){return m(this,null,function*(){try{let r=yield g(t);if(!r)return{url:t};let s=(yield r.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(s)return{url:s[1],headers:{Referer:t}}}catch(r){}return{url:t}})}function _(t,r=0){return m(this,null,function*(){var a;if(r>3)return A(d({},t),{isDirect:!1});let e=t.url,s=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!s.includes("html"))return A(d({},t),{isDirect:!0});try{let n=null;if(s.includes("sibnet.ru")?n=yield ht(e):s.includes("vidmoly.")?n=yield mt(e):s.includes("uqload.")||s.includes("oneupload.")?n=yield ft(e):s.includes("voe.")?n=yield dt(e):s.includes("streamtape.com")||s.includes("stape")?n=yield pt(e):s.includes("dood")||s.includes("ds2play")?n=yield vt(e):s.includes("moonplayer")||s.includes("moon.")?n=yield xt(e):s.includes("sendvid.")?n=yield wt(e):s.includes("myvi.")||s.includes("mytv.")?n=yield $t(e):s.includes("luluvid.")||s.includes("lulu.")?n=yield gt(e):(s.includes("hgcloud.")||s.includes("savefiles."))&&(n=yield yt(e)),n&&n.url!==e)return A(d({},t),{url:n.url,headers:d(d({},t.headers),n.headers||{}),isDirect:!0,originalUrl:e});if(!n||n.url===e){let o=yield g(e,{headers:t.headers});if(o){let l=yield o.text();l.includes("p,a,c,k,e,d")&&(l=M(l));let c=l.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||l.match(/https?:\/\/[^"']+\.mp4[^"']*/)||l.match(/file\s*:\s*["']([^"']+)["']/);if(c){let u=c[1]||c[0];u.startsWith("//")&&(u="https:"+u),u.startsWith("http")&&!u.includes(bt)&&(n={url:u})}if(!n){let u=l.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(u){let i=u[1];if(i.startsWith("//")&&(i="https:"+i),i.startsWith("/")){let h=(a=e.match(/^https?:\/\/[^\/]+/))==null?void 0:a[0];h&&(i=h+i)}if(i.startsWith("http")&&i!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${i}`),yield _(A(d({},t),{url:i}),r+1)}}}}if(n&&n.url!==e&&n.url.startsWith("http"))return A(d({},t),{url:n.url,headers:d(d({},t.headers),n.headers||{}),isDirect:!0,originalUrl:e})}catch(n){}return A(d({},t),{isDirect:!1})})}var bt="googletagmanager";var At="https://arm.haglund.dev/api/v2";var Rt="https://v3-cinemeta.strem.io";function j(e){return m(this,arguments,function*(t,r={}){try{let s=new AbortController,a=setTimeout(()=>s.abort(),8e3),n=yield fetch(t,A(d({},r),{signal:s.signal}));return clearTimeout(a),n}catch(s){return console.error(`[ArmSync] Fetch failed: ${t}`,s.message),null}})}function B(t,r){return m(this,null,function*(){if(!t)return null;let e=yield j(`${At}/themoviedb?id=${t}`);if(e)try{let n=yield e.json(),o=Array.isArray(n)?n[0]:n;if(o&&o.imdb)return o.imdb}catch(n){}let s=`https://www.themoviedb.org/${r==="movie"?"movie":"tv"}/${t}`,a=yield j(s);if(a){let o=(yield a.text()).match(/imdb\.com\/title\/(tt\d+)/);if(o)return o[1]}return null})}function K(t,r,e){return m(this,null,function*(){var u;if(!t||r===0)return null;let s=yield j(`${Rt}/meta/series/${t}.json`);if(!s)return null;let a=yield s.json();if(!((u=a==null?void 0:a.meta)!=null&&u.videos))return null;let n=a.meta.videos.filter(i=>i.season>0&&i.episode>0).sort((i,h)=>i.season-h.season||i.episode-h.episode),o=[],l=new Set;for(let i of n){let h=`${i.season}-${i.episode}`;l.has(h)||(l.add(h),o.push(i))}let c=o.findIndex(i=>i.season==r&&i.episode==e);if(c!==-1){let i=c+1;return console.log(`[ArmSync] Resolved: S${r}E${e} -> Absolute ${i}`),i}return null})}var O="8265bd1679663a7ea12ac168da84d2e8",J="https://api.themoviedb.org/3";function G(t){return m(this,null,function*(){try{let r=new AbortController,e=setTimeout(()=>r.abort(),8e3),s=yield fetch(t,{headers:{"User-Agent":"Mozilla/5.0",Accept:"application/json"},signal:r.signal});return clearTimeout(e),s.ok?s:null}catch(r){return null}})}function Y(t,r){return m(this,null,function*(){var a,n,o,l,c,u;let e=r==="movie"?"movie":"tv",s=[];try{let i=`${J}/${e}/${t}?api_key=${O}&language=en-US`,h=yield G(i);if(h){let x=yield h.json(),p=(a=e==="movie"?x.title:x.name)==null?void 0:a.trim(),w=(n=e==="movie"?x.original_title:x.original_name)==null?void 0:n.trim();p&&s.push(p),w&&w!==p&&/^[\x00-\x7F\u00C0-\u024F\s]+$/.test(w)&&s.push(w)}let y=`${J}/${e}/${t}/translations?api_key=${O}`,f=yield G(y);if(f){let p=((yield f.json()).translations||[]).find(q=>q.iso_639_1==="fr"),w=((l=(o=p==null?void 0:p.data)==null?void 0:o.name)==null?void 0:l.trim())||((u=(c=p==null?void 0:p.data)==null?void 0:c.title)==null?void 0:u.trim());w&&!s.includes(w)&&s.push(w)}}catch(i){console.error(`[Metadata] TMDB API error: ${i.message}`)}return console.log(`[Metadata] Titles for ${t}: ${s.join(" | ")}`),s})}var V="https://v6.voiranime.com";function W(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function St(t){return m(this,null,function*(){let r=[W(t),W(t.replace(/'s/gi,"")),W(t.replace(/'s/gi,"s"))],e=[];r.forEach(n=>{n.startsWith("the-")?e.push(n.substring(4)):e.push("the-"+n)});let s=[...new Set([...r,...e])];console.log(`[VoirAnime] Probing slugs: ${s.join(", ")}`);let a=[];for(let n of s){let o=`${V}/anime/${n}/`;try{yield D(o,{method:"HEAD"}),console.log(`[VoirAnime] Predicted slug found: ${n}`),a.push({title:t,url:o});break}catch(l){}}if(a.length>0)return a;try{let n=`${V}/?s=${encodeURIComponent(t)}`,o=yield D(n),l=C.load(o),c=[];l(".post-title a").each((y,f)=>{c.push({title:l(f).text().trim(),url:l(f).attr("href")})});let u=y=>y.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),i=u(t);console.log(`[VoirAnime] Search results: ${c.length}`);let h=c.filter(y=>u(y.title).includes(i));return h.length===0&&c.length>0&&(h=c),h.length>0?(console.log(`[VoirAnime] Found ${h.length} matches for ${t}`),h):[]}catch(n){return console.error(`[VoirAnime] Search error: ${n.message}`),[]}})}function Z(t,r,e,s){return m(this,null,function*(){let a=yield Y(t,r);if(a.length===0)return[];let n=[s];try{let i=yield B(t,r);if(i){let h=yield K(i,e,s);h&&h!==s&&n.push(h)}}catch(i){console.warn(`[VoirAnime] ArmSync failed: ${i.message}`)}let o=[];for(let i of a)if(o=yield St(i),o&&o.length>0)break;if(!o||o.length===0)return[];o=o.sort((i,h)=>{let y=i.title.toLowerCase(),f=h.title.toLowerCase(),x=`saison ${e}`,p=y.includes(x),w=f.includes(x);return p&&!w?-1:!p&&w?1:0});let l=[],c=new Set;for(let i of o){if(c.has(i.url))continue;c.add(i.url);let h=i.title.toLowerCase(),y=i.url,f=i.title.toUpperCase().includes("VF")||y.includes("-vf")?"VF":"VOSTFR",x=h.match(/saison\s*(\d+)/);if(!(x&&parseInt(x[1])!==e&&n.length===1))try{let p=yield D(y),w=C.load(p),q=["","0","00"],L=[];for(let b of n){let v=b.toString();q.forEach($=>L.push($+v))}let U=null;if(w(".listing-chapters a, .list-chapter a, .wp-manga-chapter a").each((b,v)=>{let $=w(v).text().trim(),R=w(v).attr("href");for(let k of L){let S=new RegExp(`(?:^|[^0-9])${k}(?:$|[^0-9])`,"i");if(S.test($)||S.test(R))return U=R,!1}}),!U)continue;let Q=yield D(U),T=C.load(Q),F=[];if(T('[name="host"] option, .host-select option').each((b,v)=>{let $=T(v).val();$&&$!=="Choisir un lecteur"&&F.push($)}),F.length===0){let b=null;if(T("iframe").each((v,$)=>{let R=T($).attr("src")||"";if(R.startsWith("http")&&!R.includes("voiranime.com"))return b=R,!1}),b){let v=yield _({name:`VoirAnime (${f})`,title:`Default Player - ${f}`,quality:"HD",url:b,headers:{Referer:V}});v&&l.push(v)}}else for(let b of F)try{let v=`${U}${U.includes("?")?"&":"?"}host=${encodeURIComponent(b)}`,$=yield D(v),R=$.match(/<iframe[^>]+src=["'](https?:\/\/[^"']+)["']/i),k=R?R[1]:null;if(!k){let S=$.match(/https?:\/\/[^"'\s<>]+\/(?:embed|e|v|player)\/[^"'\s<>]+/);S&&!S[0].includes("voiranime.com")&&(k=S[0])}if(k){let S=yield _({name:`VoirAnime (${f})`,title:`${b} - ${f}`,url:k,quality:"HD",headers:{Referer:V}});S&&l.push(S)}}catch(v){}}catch(p){}}let u=l.filter(i=>i&&i.isDirect);return console.log(`[VoirAnime] Total streams found: ${u.length}`),u})}function kt(t,r,e,s){return m(this,null,function*(){console.log(`[VoirAnime] Request: ${r} ${t} S${e}E${s}`);try{return yield Z(t,r,e,s)}catch(a){return console.error("[VoirAnime] Error:",a),[]}})}
