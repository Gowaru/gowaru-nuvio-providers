/**
 * voiranime - Built from src/voiranime/
 * Generated: 2026-02-25T18:32:18.234Z
 */
var K=Object.create;var R=Object.defineProperty,J=Object.defineProperties,O=Object.getOwnPropertyDescriptor,G=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertyNames,W=Object.getOwnPropertySymbols,X=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var H=(t,r,e)=>r in t?R(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,h=(t,r)=>{for(var e in r||(r={}))I.call(r,e)&&H(t,e,r[e]);if(W)for(var e of W(r))Y.call(r,e)&&H(t,e,r[e]);return t},g=(t,r)=>J(t,G(r));var Z=(t,r)=>{for(var e in r)R(t,e,{get:r[e],enumerable:!0})},_=(t,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of Q(r))!I.call(t,i)&&i!==e&&R(t,i,{get:()=>r[i],enumerable:!(s=O(r,i))||s.enumerable});return t};var tt=(t,r,e)=>(e=t!=null?K(X(t)):{},_(r||!t||!t.__esModule?R(e,"default",{value:t,enumerable:!0}):e,t)),et=t=>_(R({},"__esModule",{value:!0}),t);var f=(t,r,e)=>new Promise((s,i)=>{var n=u=>{try{l(e.next(u))}catch(a){i(a)}},c=u=>{try{l(e.throw(u))}catch(a){i(a)}},l=u=>u.done?s(u.value):Promise.resolve(u.value).then(n,c);l((e=e.apply(t,r)).next())});var xt={};Z(xt,{getStreams:()=>$t});module.exports=et(xt);var rt={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function v(e){return f(this,arguments,function*(t,r={}){console.log(`[VoirAnime] Fetching: ${t}`);let s=yield fetch(t,h({headers:h(h({},rt),r.headers)},r));if(!s.ok)throw new Error(`HTTP error ${s.status} for ${t}`);return yield s.text()})}var E=tt(require("cheerio"));var st={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"},j=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(r){return t}};function d(e){return f(this,arguments,function*(t,r={}){try{let s=yield fetch(t,g(h({},r),{headers:h(h({},st),r.headers),redirect:"follow"}));if(!s.ok)return null;let i=yield s.text();return{text:()=>Promise.resolve(i),ok:!0,url:s.url,headers:s.headers}}catch(s){return null}})}function D(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let r=t.match(/}\s*\((.*)\)\s*$/);if(!r)return t;let e=r[1].match(/(".+"|\d+)/g);if(e.length<4)return t;let[s,i,n,c]=[e[0].replace(/^"|"$/g,""),parseInt(e[1]),parseInt(e[2]),e[3].replace(/^"|"$/g,"").split("|")],l=a=>(a<i?"":l(parseInt(a/i)))+((a=a%i)>35?String.fromCharCode(a+29):a.toString(36)),u={};for(;n--;)u[l(n)]=c[n]||l(n);return s.replace(/\b\w+\b/g,a=>u[a]||a)}catch(r){return t}}function nt(t){return f(this,null,function*(){try{let r=yield d(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!r)return{url:t};let e=yield r.text(),s=e.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||e.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(s){let i=s[1];return i.startsWith("//")&&(i="https:"+i),{url:i,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(r){}return{url:t}})}function it(t){return f(this,null,function*(){try{let r=yield d(t,{headers:{Referer:"https://vidmoly.to/"}});if(!r)return{url:t};let e=yield r.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=D(e));let s=e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(s)return{url:s[1],headers:{Referer:"https://vidmoly.to/"}}}catch(r){}return{url:t}})}function at(t){return f(this,null,function*(){try{let r=yield d(t,{headers:{Referer:"https://uqload.com/"}});if(!r)return{url:t};let e=yield r.text(),s=e.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(s)return{url:s[1],headers:{Referer:"https://uqload.com/"}}}catch(r){}return{url:t}})}function ot(t){return f(this,null,function*(){try{let r=yield d(t);if(!r)return{url:t};let e=yield r.text(),s=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(s){let n=yield d(s[1]);n&&(e=yield n.text())}let i=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(i){let n=i[1]||i[0];return n.includes("base64")&&(n=j(n.split(",")[1]||n)),{url:n}}}catch(r){}return{url:t}})}function ct(t){return f(this,null,function*(){try{let r=yield d(t);if(!r)return{url:t};let e=yield r.text();e.includes("p,a,c,k,e,d")&&(e=D(e));let s=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(s){let i="https:"+s[1],n=s[2].split("+");for(let c of n){let l=c.match(/['"]([^'"]+)['"]/);if(l){let u=l[1],a=c.match(/substring\((\d+)\)/);a&&(u=u.substring(parseInt(a[1]))),i+=u}}return{url:i,headers:{Referer:"https://streamtape.com/"}}}}catch(r){}return{url:t}})}function lt(t){return f(this,null,function*(){try{let r=yield d(t);if(!r)return{url:t};let e=yield r.text(),s=e.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.mp4[^"']*)["']/);if(s)return{url:s[1]}}catch(r){}return{url:t}})}function ut(t){return f(this,null,function*(){try{let r=yield d(t);if(!r)return{url:t};let e=yield r.text();e.includes("p,a,c,k,e,d")&&(e=D(e));let s=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(s){let i=s[1];return i.includes("base64")&&(i=j(i.split(",")[1]||i)),{url:i}}}catch(r){}return{url:t}})}function ft(t){return f(this,null,function*(){try{let r=yield d(t);if(!r)return{url:t};let s=(yield r.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(s)return{url:s[1]}}catch(r){}return{url:t}})}function mt(t){return f(this,null,function*(){var r;try{let e=((r=t.match(/https?:\/\/([^\/]+)/))==null?void 0:r[1])||"dood.to",s=yield d(t);if(!s)return{url:t};let i=yield s.text();i.includes("eval(function(p,a,c,k,e,d)")&&(i=D(i));let n=i.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(n){let c=n[1],l=`https://${e}/pass_md5/${c}`,u=yield fetch(l,{headers:{Referer:t}});if(u.ok){let a=yield u.text(),o=Math.random().toString(36).substring(2,12);return{url:a+o+"?token="+c+"&expiry="+Date.now()}}}}catch(e){}return{url:t}})}function ht(t){return f(this,null,function*(){try{let r=yield d(t);if(!r)return{url:t};let s=(yield r.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(s)return{url:s[1]}}catch(r){}return{url:t}})}function k(t,r=0){return f(this,null,function*(){var i;if(r>3)return g(h({},t),{isDirect:!1});let e=t.url,s=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!s.includes("html"))return g(h({},t),{isDirect:!0});try{let n=null;if(s.includes("sibnet.ru")?n=yield nt(e):s.includes("vidmoly.")?n=yield it(e):s.includes("uqload.")||s.includes("oneupload.")?n=yield at(e):s.includes("voe.")?n=yield ot(e):s.includes("streamtape.com")||s.includes("stape")?n=yield ct(e):s.includes("dood")||s.includes("ds2play")?n=yield mt(e):s.includes("moonplayer")||s.includes("moon.")?n=yield ht(e):s.includes("sendvid.")?n=yield lt(e):s.includes("luluvid.")||s.includes("lulu.")?n=yield ut(e):(s.includes("hgcloud.")||s.includes("savefiles."))&&(n=yield ft(e)),!n||n.url===e){let c=yield d(e,{headers:t.headers});if(c){let l=yield c.text();l.includes("p,a,c,k,e,d")&&(l=D(l));let u=l.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||l.match(/https?:\/\/[^"']+\.mp4[^"']*/)||l.match(/file\s*:\s*["']([^"']+)["']/);if(u){let a=u[1]||u[0];a.startsWith("//")&&(a="https:"+a),a.startsWith("http")&&!a.includes(pt)&&(n={url:a})}if(!n){let a=l.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(a){let o=a[1];if(o.startsWith("//")&&(o="https:"+o),o.startsWith("/")){let m=(i=e.match(/^https?:\/\/[^\/]+/))==null?void 0:i[0];m&&(o=m+o)}if(o.startsWith("http")&&o!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${o}`),yield k(g(h({},t),{url:o}),r+1)}}}}if(n&&n.url!==e&&n.url.startsWith("http")){let c=yield k(g(h({},t),{url:n.url,headers:h(h({},t.headers),n.headers||{})}),r+1);return g(h({},c),{isDirect:!0,originalUrl:e})}}catch(n){}return g(h({},t),{isDirect:!1})})}var pt="googletagmanager";var dt="https://arm.haglund.dev/api/v2";var wt="https://v3-cinemeta.strem.io";function C(e){return f(this,arguments,function*(t,r={}){try{let s=new AbortController,i=setTimeout(()=>s.abort(),8e3),n=yield fetch(t,g(h({},r),{signal:s.signal}));return clearTimeout(i),n}catch(s){return console.error(`[ArmSync] Fetch failed: ${t}`,s.message),null}})}function L(t,r){return f(this,null,function*(){if(!t)return null;let e=yield C(`${dt}/themoviedb?id=${t}`);if(e)try{let n=yield e.json(),c=Array.isArray(n)?n[0]:n;if(c&&c.imdb)return c.imdb}catch(n){}let s=`https://www.themoviedb.org/${r==="movie"?"movie":"tv"}/${t}`,i=yield C(s);if(i){let c=(yield i.text()).match(/imdb\.com\/title\/(tt\d+)/);if(c)return c[1]}return null})}function P(t,r,e){return f(this,null,function*(){var a;if(!t||r===0)return null;let s=yield C(`${wt}/meta/series/${t}.json`);if(!s)return null;let i=yield s.json();if(!((a=i==null?void 0:i.meta)!=null&&a.videos))return null;let n=i.meta.videos.filter(o=>o.season>0&&o.episode>0).sort((o,m)=>o.season-m.season||o.episode-m.episode),c=[],l=new Set;for(let o of n){let m=`${o.season}-${o.episode}`;l.has(m)||(l.add(m),c.push(o))}let u=c.findIndex(o=>o.season==r&&o.episode==e);if(u!==-1){let o=u+1;return console.log(`[ArmSync] Resolved: S${r}E${e} -> Absolute ${o}`),o}return null})}var U="https://v6.voiranime.com";function gt(t,r){return f(this,null,function*(){try{let e=`https://www.themoviedb.org/${r==="movie"?"movie":"tv"}/${t}?language=en-US`,s=yield v(e),i=E.default.load(s),n=i('meta[property="og:title"]').attr("content")||i("h1").first().text()||i("h2").first().text();return n&&n.includes(" (")&&(n=n.split(" (")[0]),n&&n.includes(" - ")&&(n=n.split(" - ")[0]),n=n?n.trim():null,console.log(`[VoirAnime] TMDB Title found: ${n}`),n}catch(e){return console.error(`[VoirAnime] Failed to get title from TMDB: ${e.message}`),null}})}function q(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function yt(t){return f(this,null,function*(){let r=[q(t),q(t.replace(/'s/gi,"")),q(t.replace(/'s/gi,"s"))],e=[];r.forEach(i=>{i.startsWith("the-")?e.push(i.substring(4)):e.push("the-"+i)});let s=[...new Set([...r,...e])];console.log(`[VoirAnime] Probing slugs: ${s.join(", ")}`);for(let i of s){let n=`${U}/anime/${i}/`;try{return yield v(n,{method:"HEAD"}),console.log(`[VoirAnime] Predicted slug found: ${i}`),n}catch(c){}}try{let i=`${U}/?s=${encodeURIComponent(t)}`,n=yield v(i),c=E.default.load(n),l=[];c(".post-title a").each((m,y)=>{l.push({title:c(y).text().trim(),url:c(y).attr("href")})});let u=m=>m.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),a=u(t);console.log(`[VoirAnime] Search results: ${l.length}`);let o=l.find(m=>u(m.title)===a);return o||(o=l.find(m=>{let y=u(m.title);return y.includes(a)&&!y.includes("film")&&!y.includes("log")&&!y.includes("kai")})),o||(o=l[0]),o?(console.log(`[VoirAnime] Selected from search: ${o.title} -> ${o.url}`),o.url):null}catch(i){return console.error(`[VoirAnime] Search error: ${i.message}`),null}})}function N(t,r,e,s){return f(this,null,function*(){let i=yield gt(t,r);if(!i)return[];let n=[s];try{let a=yield L(t,r);if(a){let o=yield P(a,e,s);o&&n.push(o)}}catch(a){console.warn(`[VoirAnime] ArmSync failed: ${a.message}`)}let c=yield yt(i);if(!c||c.length===0)return[];let l=[],u=new Set;for(let a of c)if(!u.has(a.url)){u.add(a.url);try{let o=a.url,m=a.title.toUpperCase().includes("VF")||o.includes("-vf")?"VF":"VOSTFR",y=yield v(o),M=E.default.load(y),B=["","0","00"],F=[];for(let $ of n){let p=$.toString();B.forEach(w=>F.push(w+p))}let A=null;if(M(".listing-chapters a, .list-chapter a, .wp-manga-chapter a").each(($,p)=>{let w=M(p).text().trim(),S=M(p).attr("href");for(let b of F){let x=new RegExp(`(?:[^0-9]|^)${b}(?:[^0-9]|$)`);if(x.test(w)||x.test(S))return A=S,!1}}),!A)continue;let z=yield v(A),T=E.default.load(z),V=[];if(T('[name="host"] option, .host-select option').each(($,p)=>{let w=T(p).val();w&&w!=="Choisir un lecteur"&&V.push(w)}),V.length===0){let $=T('iframe[src*="embed"], iframe[src*="e/"]').first().attr("src");if($){let p=yield k({name:`VoirAnime (${m})`,title:`Default Player - ${m}`,quality:"HD",url:$,headers:{Referer:U}});p&&l.push(p)}}else for(let $ of V)try{let p=`${A}${A.includes("?")?"&":"?"}host=${encodeURIComponent($)}`,w=yield v(p),S=w.match(/<iframe\s+.*?src="(https?:\/\/[^"]+)".*?><\/iframe>/i),b=S?S[1]:null;if(!b){let x=w.match(/https?:\/\/[^"']+\/(?:embed|e)\/[^"']+/);x&&!x[0].includes("voiranime.com")&&(b=x[0])}if(b){let x=yield k({name:`VoirAnime (${m})`,title:`${$} - ${m}`,url:b,quality:"HD",headers:{Referer:U}});x&&l.push(x)}}catch(p){}}catch(o){}}return l})}function $t(t,r,e,s){return f(this,null,function*(){console.log(`[VoirAnime] Request: ${r} ${t} S${e}E${s}`);try{return yield N(t,r,e,s)}catch(i){return console.error("[VoirAnime] Error:",i),[]}})}
