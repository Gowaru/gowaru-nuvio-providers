/**
 * voiranime - Built from src/voiranime/
 * Generated: 2026-02-25T10:36:17.675Z
 */
var W=Object.create;var A=Object.defineProperty,F=Object.defineProperties,N=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertyNames,E=Object.getOwnPropertySymbols,K=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var M=(e,t,s)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,m=(e,t)=>{for(var s in t||(t={}))H.call(t,s)&&M(e,s,t[s]);if(E)for(var s of E(t))B.call(t,s)&&M(e,s,t[s]);return e},S=(e,t)=>F(e,P(t));var J=(e,t)=>{for(var s in t)A(e,s,{get:t[s],enumerable:!0})},k=(e,t,s,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of z(t))!H.call(e,n)&&n!==s&&A(e,n,{get:()=>t[n],enumerable:!(r=N(t,n))||r.enumerable});return e};var _=(e,t,s)=>(s=e!=null?W(K(e)):{},k(t||!e||!e.__esModule?A(s,"default",{value:e,enumerable:!0}):s,e)),G=e=>k(A({},"__esModule",{value:!0}),e);var i=(e,t,s)=>new Promise((r,n)=>{var o=a=>{try{c(s.next(a))}catch(v){n(v)}},f=a=>{try{c(s.throw(a))}catch(v){n(v)}},c=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,f);c((s=s.apply(e,t)).next())});var me={};J(me,{getStreams:()=>le});module.exports=G(me);var O={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function $(s){return i(this,arguments,function*(e,t={}){console.log(`[VoirAnime] Fetching: ${e}`);let r=yield fetch(e,m({headers:m(m({},O),t.headers)},t));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${e}`);return yield r.text()})}var U=_(require("cheerio"));var j={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"};function h(s){return i(this,arguments,function*(e,t={}){try{let r=new AbortController,n=setTimeout(()=>r.abort(),1e4),o=yield fetch(e,S(m({},t),{headers:m(m({},j),t.headers),signal:r.signal}));return clearTimeout(n),o}catch(r){return console.error(`[Resolver] Fetch failed for ${e}: ${r.message}`),null}})}function I(e){return i(this,null,function*(){let t=yield h(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!t)return e;let s=yield t.text(),r=s.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||s.match(/src\s*:\s*"([^"]+\.mp4)"/)||s.match(/player\.setVideo\(\s*\{\s*"url"\s*:\s*"([^"]+)"/);if(r){let n=r[1];return n.startsWith("//")?n=`https:${n}`:n.startsWith("/")&&(n=`https://video.sibnet.ru${n}`),n}return e})}function Q(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let r=(yield t.text()).match(/file\s*:\s*"([^"]+)"/);return r?r[1]:e})}function X(e){return i(this,null,function*(){let t=yield h(e,{headers:{Referer:"https://uqload.com/"}});if(!t)return e;let s=yield t.text(),r=s.match(/sources\s*:\s*\["([^"]+)"\]/)||s.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/);return r?r[1]:e})}function Y(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let s=yield t.text(),r=s.match(/'hls'\s*:\s*'([^']+)'/)||s.match(/"hls"\s*:\s*"([^"]+)"/)||s.match(/window\.location\.href\s*=\s*'([^']+)'/);if(r){let n=r[1];if(n.includes("base64"))try{let o=n.split(",")[1]||n;typeof atob!="undefined"&&(n=atob(o))}catch(o){}return n}return e})}function Z(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let s=yield t.text(),r=s.match(/sources\s*:\s*\[\s*\{\s*"file"\s*:\s*"([^"]+)"/i)||s.match(/file\s*:\s*"([^"]+)"/i);return r?r[1]:e})}function ee(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let s=yield t.text(),r=s.match(/file\s*:\s*"([^"]+)"/i)||s.match(/source\s*:\s*"([^"]+)"/i);return r?r[1]:e})}function te(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let s=yield t.text(),r=s.match(/file\s*:\s*"([^"]+)"/i)||s.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/i);return r?r[1]:e})}function se(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let r=(yield t.text()).match(/file\s*:\s*"([^"]+)"/);return r?r[1]:e})}function re(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let r=(yield t.text()).match(/file\s*:\s*"([^"]+)"/);return r?r[1]:e})}function ne(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let s=yield t.text(),r=s.match(/robotlink\.innerHTML\s*=\s*'([^']+)'/);if(r){let o=r[1];return o.startsWith("//")&&(o=`https:${o}`),o}return s.match(/video_link\s*:\s*"([^"]+)"/)?r[2]:e})}function oe(e){return i(this,null,function*(){let t=yield h(e);if(!t)return e;let s=yield t.text(),r=s.match(/source\s+src="([^"]+\.mp4)"/i)||s.match(/video_source\s*:\s*"([^"]+)"/);return r?r[1]:e})}function ie(e){return i(this,null,function*(){let t=e.replace("/e/","/d/"),s=yield h(t);if(!s)return e;let n=(yield s.text()).match(/window\.open\('([^']+)'\)/);return n?n[1]:e})}function C(e){return i(this,null,function*(){let t=e.url,s=t.toLowerCase();if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return S(m({},e),{isDirect:!0});try{let r=t,n=m({},e.headers);if(s.includes("sibnet.ru")?(r=yield I(t),n.Referer="https://video.sibnet.ru/"):s.includes("vidmoly.")?(r=yield Q(t),n.Referer="https://vidmoly.to/"):s.includes("uqload.")?(r=yield X(t),n.Referer="https://uqload.com/"):s.includes("voe.sx")||s.includes("christopheruntilpoint")?r=yield Y(t):s.includes("moonplayer")||s.includes("moonembed")?r=yield Z(t):s.includes("mytv")||s.includes("mycloud")||s.includes("mclls.net")?r=yield ee(t):s.includes("fhd")||s.includes("fhd1")?r=yield te(t):s.includes("upstream.")?r=yield se(t):s.includes("vido.")||s.includes("vidlo.")?r=yield re(t):s.includes("streamtape.com")?r=yield ne(t):s.includes("sendvid.com")?r=yield oe(t):(s.includes("dood")||s.includes("ds2play")||s.includes("viddood"))&&(r=yield ie(t)),r!==t&&r.startsWith("http"))return console.log(`[Resolver] Success: ${t.substring(0,30)}... -> ${r.substring(0,30)}...`),S(m({},e),{url:r,isDirect:!0,headers:n,originalUrl:t})}catch(r){console.error(`[Resolver] Failed for ${t}:`,r)}return S(m({},e),{isDirect:!1})})}var R="https://v6.voiranime.com";function ae(e,t){return i(this,null,function*(){try{let s=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,r=yield $(s),n=U.default.load(r),o=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[VoirAnime] TMDB Title found: ${o}`),o}catch(s){return console.error(`[VoirAnime] Failed to get title from TMDB: ${s.message}`),null}})}function D(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function ce(e){return i(this,null,function*(){let t=[D(e),D(e.replace(/'s/gi,"")),D(e.replace(/'s/gi,"s"))],s=[];t.forEach(n=>{n.startsWith("the-")?s.push(n.substring(4)):s.push("the-"+n)});let r=[...new Set([...t,...s])];console.log(`[VoirAnime] Probing slugs: ${r.join(", ")}`);for(let n of r){let o=`${R}/anime/${n}/`;try{return yield $(o,{method:"HEAD"}),console.log(`[VoirAnime] Predicted slug found: ${n}`),o}catch(f){}}try{let n=`${R}/?s=${encodeURIComponent(e)}`,o=yield $(n),f=U.default.load(o),c=[];f(".post-title a").each((l,d)=>{c.push({title:f(d).text().trim(),url:f(d).attr("href")})});let a=l=>l.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),v=a(e);console.log(`[VoirAnime] Search results: ${c.length}`);let p=c.find(l=>a(l.title)===v);return p||(p=c.find(l=>{let d=a(l.title);return d.includes(v)&&!d.includes("film")&&!d.includes("log")&&!d.includes("kai")})),p||(p=c[0]),p?(console.log(`[VoirAnime] Selected from search: ${p.title} -> ${p.url}`),p.url):null}catch(n){return console.error(`[VoirAnime] Search error: ${n.message}`),null}})}function L(e,t,s,r){return i(this,null,function*(){let n=yield ae(e,t);if(!n)return[];let o=yield ce(n);if(!o)return[];try{let f=yield $(o),c=U.default.load(f),a=r.toString(),p=["","0","00","000"].map(u=>(u+a).slice(-Math.max(a.length,u.length))),l=null;if(c(".listing-chapters a, .list-chapter a, .wp-manga-chapter a").each((u,w)=>{let g=c(w).text().trim(),b=c(w).attr("href");for(let y of p){let x=new RegExp(`(?:[^0-9]|^)${y}(?:[^0-9]|$)`);if(x.test(g)||x.test(b))return l=b,!1}}),!l)return[];console.log(`[VoirAnime] Episode URL: ${l}`);let d=yield $(l),q=U.default.load(d),V=[],T=[];if(q('[name="host"] option, .host-select option').each((u,w)=>{let g=q(w).val();g&&g!=="Choisir un lecteur"&&T.push(g)}),T.length===0){let u=q('iframe[src*="embed"], iframe[src*="e/"]').first().attr("src");if(u){let w=yield C({name:"VoirAnime",title:"Default Player",quality:"HD",url:u,headers:{Referer:R}});V.push(w)}}else for(let u of T)try{let w=`${l}${l.includes("?")?"&":"?"}host=${encodeURIComponent(u)}`,g=yield $(w),b=g.match(/<iframe\s+.*?src="(https?:\/\/[^"]+)".*?><\/iframe>/i),y=b?b[1]:null;if(!y){let x=g.match(/https?:\/\/[^"']+\/(?:embed|e)\/[^"']+/);x&&!x[0].includes("voiranime.com")&&(y=x[0])}if(y){let x=yield C({name:`VoirAnime (${u})`,title:`${u} Player`,url:y,quality:"HD",headers:{Referer:R}});V.push(x)}}catch(w){}return V}catch(f){return console.error(`[VoirAnime] Extraction error: ${f.message}`),[]}})}function le(e,t,s,r){return i(this,null,function*(){console.log(`[VoirAnime] Request: ${t} ${e} S${s}E${r}`);try{return yield L(e,t,s,r)}catch(n){return console.error("[VoirAnime] Error:",n),[]}})}
