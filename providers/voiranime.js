/**
 * voiranime - Built from src/voiranime/
 * Generated: 2026-02-25T10:09:14.934Z
 */
var W=Object.create;var S=Object.defineProperty,k=Object.defineProperties,N=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertyNames,D=Object.getOwnPropertySymbols,K=Object.getPrototypeOf,M=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var H=(e,t,r)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))M.call(t,r)&&H(e,r,t[r]);if(D)for(var r of D(t))B.call(t,r)&&H(e,r,t[r]);return e},E=(e,t)=>k(e,P(t));var J=(e,t)=>{for(var r in t)S(e,r,{get:t[r],enumerable:!0})},L=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of z(t))!M.call(e,n)&&n!==r&&S(e,n,{get:()=>t[n],enumerable:!(o=N(t,n))||o.enumerable});return e};var G=(e,t,r)=>(r=e!=null?W(K(e)):{},L(t||!e||!e.__esModule?S(r,"default",{value:e,enumerable:!0}):r,e)),O=e=>L(S({},"__esModule",{value:!0}),e);var i=(e,t,r)=>new Promise((o,n)=>{var s=a=>{try{c(r.next(a))}catch(x){n(x)}},h=a=>{try{c(r.throw(a))}catch(x){n(x)}},c=a=>a.done?o(a.value):Promise.resolve(a.value).then(s,h);c((r=r.apply(e,t)).next())});var ne={};J(ne,{getStreams:()=>oe});module.exports=O(ne);var j={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function $(r){return i(this,arguments,function*(e,t={}){console.log(`[VoirAnime] Fetching: ${e}`);let o=yield fetch(e,d({headers:d(d({},j),t.headers)},t));if(!o.ok)throw new Error(`HTTP error ${o.status} for ${e}`);return yield o.text()})}var b=G(require("cheerio"));var I={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"*/*"};function y(r){return i(this,arguments,function*(e,t={}){try{let o=new AbortController,n=setTimeout(()=>o.abort(),1e4),s=yield fetch(e,E(d({},t),{headers:d(d({},I),t.headers),signal:o.signal}));return clearTimeout(n),s}catch(o){return console.error(`[Resolver] Fetch failed for ${e}: ${o.message}`),null}})}function _(e){return i(this,null,function*(){let t=yield y(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!t)return e;let o=(yield t.text()).match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(o){let n=o[1];return n.startsWith("/")&&(n=`https://video.sibnet.ru${n}`),n}return e})}function Q(e){return i(this,null,function*(){let t=yield y(e);if(!t)return e;let o=(yield t.text()).match(/file\s*:\s*"([^"]+)"/);return o?o[1]:e})}function X(e){return i(this,null,function*(){let t=yield y(e);if(!t)return e;let o=(yield t.text()).match(/sources\s*:\s*\["([^"]+)"\]/);return o?o[1]:e})}function Y(e){return i(this,null,function*(){let t=yield y(e);if(!t)return e;let r=yield t.text(),o=r.match(/'hls'\s*:\s*'([^']+)'/)||r.match(/"hls"\s*:\s*"([^"]+)"/);return o?o[1]:e})}function Z(e){return i(this,null,function*(){let t=yield y(e);if(!t)return e;let o=(yield t.text()).match(/source\s+src="([^"]+\.mp4)"/i);return o?o[1]:e})}function ee(e){return i(this,null,function*(){let t=yield y(e.replace("/e/","/d/"));if(!t)return e;let o=(yield t.text()).match(/window\.open\('([^']+)'\)/);return o?o[1]:e})}function C(e){return i(this,null,function*(){let t=e.url,r=t.toLowerCase();try{let o=t;if(r.includes("sibnet.ru")?o=yield _(t):r.includes("vidmoly.")?o=yield Q(t):r.includes("uqload.")?o=yield X(t):r.includes("voe.sx")||r.includes("christopheruntilpoint")?o=yield Y(t):r.includes("sendvid.com")?o=yield Z(t):(r.includes("dood")||r.includes("ds2play")||r.includes("viddood"))&&(o=yield ee(t)),o!==t)return console.log(`[Resolver] Success: ${t.substring(0,30)}... -> ${o.substring(0,30)}...`),E(d({},e),{url:o,isDirect:!0,originalUrl:t})}catch(o){console.error(`[Resolver] Failed for ${t}:`,o)}return e})}var U="https://v6.voiranime.com";function te(e,t){return i(this,null,function*(){try{let r=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,o=yield $(r),n=b.default.load(o),s=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();return s&&s.includes(" (")&&(s=s.split(" (")[0]),s&&s.includes(" - ")&&(s=s.split(" - ")[0]),s=s?s.trim():null,console.log(`[VoirAnime] TMDB Title found: ${s}`),s}catch(r){return console.error(`[VoirAnime] Failed to get title from TMDB: ${r.message}`),null}})}function q(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function re(e){return i(this,null,function*(){let t=[q(e),q(e.replace(/'s/gi,"")),q(e.replace(/'s/gi,"s"))],r=[];t.forEach(n=>{n.startsWith("the-")?r.push(n.substring(4)):r.push("the-"+n)});let o=[...new Set([...t,...r])];console.log(`[VoirAnime] Probing slugs: ${o.join(", ")}`);for(let n of o){let s=`${U}/anime/${n}/`;try{return yield $(s,{method:"HEAD"}),console.log(`[VoirAnime] Predicted slug found: ${n}`),s}catch(h){}}try{let n=`${U}/?s=${encodeURIComponent(e)}`,s=yield $(n),h=b.default.load(s),c=[];h(".post-title a").each((l,f)=>{c.push({title:h(f).text().trim(),url:h(f).attr("href")})});let a=l=>l.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),x=a(e);console.log(`[VoirAnime] Search results: ${c.length}`);let u=c.find(l=>a(l.title)===x);return u||(u=c.find(l=>{let f=a(l.title);return f.includes(x)&&!f.includes("film")&&!f.includes("log")&&!f.includes("kai")})),u||(u=c[0]),u?(console.log(`[VoirAnime] Selected from search: ${u.title} -> ${u.url}`),u.url):null}catch(n){return console.error(`[VoirAnime] Search error: ${n.message}`),null}})}function F(e,t,r,o){return i(this,null,function*(){let n=yield te(e,t);if(!n)return[];let s=yield re(n);if(!s)return[];try{let h=yield $(s),c=b.default.load(h),a=o.toString(),u=["","0","00","000"].map(m=>(m+a).slice(-Math.max(a.length,m.length))),l=null;if(c(".listing-chapters a, .list-chapter a, .wp-manga-chapter a").each((m,p)=>{let g=c(p).text().trim(),A=c(p).attr("href");for(let v of u){let w=new RegExp(`(?:[^0-9]|^)${v}(?:[^0-9]|$)`);if(w.test(g)||w.test(A))return l=A,!1}}),!l)return[];console.log(`[VoirAnime] Episode URL: ${l}`);let f=yield $(l),V=b.default.load(f),R=[],T=[];if(V('[name="host"] option, .host-select option').each((m,p)=>{let g=V(p).val();g&&g!=="Choisir un lecteur"&&T.push(g)}),T.length===0){let m=V('iframe[src*="embed"], iframe[src*="e/"]').first().attr("src");if(m){let p=yield C({name:"VoirAnime",title:"Default Player",quality:"HD",url:m,headers:{Referer:U}});R.push(p)}}else for(let m of T)try{let p=`${l}${l.includes("?")?"&":"?"}host=${encodeURIComponent(m)}`,g=yield $(p),A=g.match(/<iframe\s+.*?src="(https?:\/\/[^"]+)".*?><\/iframe>/i),v=A?A[1]:null;if(!v){let w=g.match(/https?:\/\/[^"']+\/(?:embed|e)\/[^"']+/);w&&!w[0].includes("voiranime.com")&&(v=w[0])}if(v){let w=yield C({name:`VoirAnime (${m})`,title:`${m} Player`,url:v,quality:"HD",headers:{Referer:U}});R.push(w)}}catch(p){}return R}catch(h){return console.error(`[VoirAnime] Extraction error: ${h.message}`),[]}})}function oe(e,t,r,o){return i(this,null,function*(){console.log(`[VoirAnime] Request: ${t} ${e} S${r}E${o}`);try{return yield F(e,t,r,o)}catch(n){return console.error("[VoirAnime] Error:",n),[]}})}
