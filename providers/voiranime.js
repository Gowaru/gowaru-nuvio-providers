/**
 * voiranime - Built from src/voiranime/
 * Generated: 2026-02-24T23:41:23.030Z
 */
var M=Object.create;var S=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,k=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var q=(e,t,r)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,V=(e,t)=>{for(var r in t||(t={}))C.call(t,r)&&q(e,r,t[r]);if(R)for(var r of R(t))F.call(t,r)&&q(e,r,t[r]);return e};var N=(e,t)=>{for(var r in t)S(e,r,{get:t[r],enumerable:!0})},D=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of P(t))!C.call(e,o)&&o!==r&&S(e,o,{get:()=>t[o],enumerable:!(i=L(t,o))||i.enumerable});return e};var z=(e,t,r)=>(r=e!=null?M(k(e)):{},D(t||!e||!e.__esModule?S(r,"default",{value:e,enumerable:!0}):r,e)),W=e=>D(S({},"__esModule",{value:!0}),e);var p=(e,t,r)=>new Promise((i,o)=>{var n=s=>{try{a(r.next(s))}catch(g){o(g)}},m=s=>{try{a(r.throw(s))}catch(g){o(g)}},a=s=>s.done?i(s.value):Promise.resolve(s.value).then(n,m);a((r=r.apply(e,t)).next())});var j={};N(j,{getStreams:()=>O});module.exports=W(j);var B={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function $(r){return p(this,arguments,function*(e,t={}){console.log(`[VoirAnime] Fetching: ${e}`);let i=yield fetch(e,V({headers:V(V({},B),t.headers)},t));if(!i.ok)throw new Error(`HTTP error ${i.status} for ${e}`);return yield i.text()})}var y=z(require("cheerio-without-node-native"));var v="https://v6.voiranime.com";function J(e,t){return p(this,null,function*(){try{let r=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,i=yield $(r),o=y.default.load(i),n=o('meta[property="og:title"]').attr("content")||o("h1").first().text()||o("h2").first().text();return n&&n.includes(" (")&&(n=n.split(" (")[0]),n&&n.includes(" - ")&&(n=n.split(" - ")[0]),n=n?n.trim():null,console.log(`[VoirAnime] TMDB Title found: ${n}`),n}catch(r){return console.error(`[VoirAnime] Failed to get title from TMDB: ${r.message}`),null}})}function E(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function K(e){return p(this,null,function*(){let t=[E(e),E(e.replace(/'s/gi,"")),E(e.replace(/'s/gi,"s"))],r=[];t.forEach(o=>{o.startsWith("the-")?r.push(o.substring(4)):r.push("the-"+o)});let i=[...new Set([...t,...r])];console.log(`[VoirAnime] Probing slugs: ${i.join(", ")}`);for(let o of i){let n=`${v}/anime/${o}/`;try{return yield $(n,{method:"HEAD"}),console.log(`[VoirAnime] Predicted slug found: ${o}`),n}catch(m){}}try{let o=`${v}/?s=${encodeURIComponent(e)}`,n=yield $(o),m=y.default.load(n),a=[];m(".post-title a").each((c,u)=>{a.push({title:m(u).text().trim(),url:m(u).attr("href")})});let s=c=>c.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),g=s(e);console.log(`[VoirAnime] Search results: ${a.length}`);let h=a.find(c=>s(c.title)===g);return h||(h=a.find(c=>{let u=s(c.title);return u.includes(g)&&!u.includes("film")&&!u.includes("log")&&!u.includes("kai")})),h||(h=a[0]),h?(console.log(`[VoirAnime] Selected from search: ${h.title} -> ${h.url}`),h.url):null}catch(o){return console.error(`[VoirAnime] Search error: ${o.message}`),null}})}function H(e,t,r,i){return p(this,null,function*(){let o=yield J(e,t);if(!o)return[];let n=yield K(o);if(!n)return[];try{let m=yield $(n),a=y.default.load(m),s=i.toString(),h=["","0","00","000"].map(l=>(l+s).slice(-Math.max(s.length,l.length))),c=null;if(a(".listing-chapters a, .list-chapter a, .wp-manga-chapter a").each((l,d)=>{let f=a(d).text().trim(),A=a(d).attr("href");for(let w of h){let x=new RegExp(`(?:[^0-9]|^)${w}(?:[^0-9]|$)`);if(x.test(f)||x.test(A))return c=A,!1}}),!c)return[];console.log(`[VoirAnime] Episode URL: ${c}`);let u=yield $(c),T=y.default.load(u),U=[],b=[];if(T('[name="host"] option, .host-select option').each((l,d)=>{let f=T(d).val();f&&f!=="Choisir un lecteur"&&b.push(f)}),b.length===0){let l=T('iframe[src*="embed"], iframe[src*="e/"]').first().attr("src");l&&U.push({name:"VoirAnime",title:"Default Player",quality:"HD",url:l,headers:{Referer:v}})}else for(let l of b)try{let d=`${c}${c.includes("?")?"&":"?"}host=${encodeURIComponent(l)}`,f=yield $(d),A=f.match(/<iframe\s+.*?src="(https?:\/\/[^"]+)".*?><\/iframe>/i),w=A?A[1]:null;if(!w){let x=f.match(/https?:\/\/[^"']+\/(?:embed|e)\/[^"']+/);x&&!x[0].includes("voiranime.com")&&(w=x[0])}w&&U.push({name:`VoirAnime (${l})`,title:`${l} Player`,url:w,quality:"HD",headers:{Referer:v}})}catch(d){}return U}catch(m){return console.error(`[VoirAnime] Extraction error: ${m.message}`),[]}})}function O(e,t,r,i){return p(this,null,function*(){console.log(`[VoirAnime] Request: ${t} ${e} S${r}E${i}`);try{return yield H(e,t,r,i)}catch(o){return console.error("[VoirAnime] Error:",o),[]}})}
