/**
 * anime-sama - Built from src/anime-sama/
 * Generated: 2026-02-27T23:53:39.822Z
 */
var J=Object.create;var _=Object.defineProperty,Y=Object.defineProperties,Z=Object.getOwnPropertyDescriptor,Q=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols,tt=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var P=(t,a,e)=>a in t?_(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e,p=(t,a)=>{for(var e in a||(a={}))W.call(a,e)&&P(t,e,a[e]);if(F)for(var e of F(a))et.call(a,e)&&P(t,e,a[e]);return t},S=(t,a)=>Y(t,Q(a));var st=(t,a,e,s)=>{if(a&&typeof a=="object"||typeof a=="function")for(let n of X(a))!W.call(t,n)&&n!==e&&_(t,n,{get:()=>a[n],enumerable:!(s=Z(a,n))||s.enumerable});return t};var at=(t,a,e)=>(e=t!=null?J(tt(t)):{},st(a||!t||!t.__esModule?_(e,"default",{value:t,enumerable:!0}):e,t));var h=(t,a,e)=>new Promise((s,n)=>{var r=l=>{try{c(e.next(l))}catch(u){n(u)}},i=l=>{try{c(e.throw(l))}catch(u){n(u)}},c=l=>l.done?s(l.value):Promise.resolve(l.value).then(r,i);c((e=e.apply(t,a)).next())});var nt={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0","Sec-Ch-Ua":'"Chromium";v="122", "Not(A:Brand";v="24", "Google Chrome";v="122"',"Sec-Ch-Ua-Mobile":"?0","Sec-Ch-Ua-Platform":'"Windows"',"Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1","Upgrade-Insecure-Requests":"1"};function C(e){return h(this,arguments,function*(t,a={}){console.log(`[Anime-Sama] Fetching: ${t}`);let s=yield fetch(t,p({headers:p(p({},nt),a.headers)},a));if(!s.ok)throw new Error(`HTTP error ${s.status} for ${t}`);return yield s.text()})}var O=at(require("cheerio-without-node-native"));var rt={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36"},I=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(a){return t}};function y(e){return h(this,arguments,function*(t,a={}){let s,n;try{s=new AbortController,n=setTimeout(()=>s.abort(),1e4);let r=yield fetch(t,S(p({},a),{headers:p(p({},rt),a.headers),redirect:"follow",signal:s.signal}));if(clearTimeout(n),!r.ok)return null;let i=yield r.text();return{text:()=>Promise.resolve(i),ok:!0,url:r.url,headers:r.headers}}catch(r){return n&&clearTimeout(n),null}})}function U(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let a=new RegExp("eval\\s*\\(\\s*function\\s*\\(\\s*p\\s*,\\s*a\\s*,\\s*c\\s*,\\s*k\\s*,\\s*e\\s*,\\s*d\\s*\\).*?\\}\\s*\\((.*?)\\)\\s*\\)","gs"),e=t,s;for(;(s=a.exec(t))!==null;)try{let r=s[1].match(new RegExp("^'(.*?)',\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*'(.*?)'\\.split\\('\\|'\\)","s"));if(!r)continue;let i=r[1].replace(/\\'/g,"'"),c=parseInt(r[2]),l=parseInt(r[3]),u=r[4].split("|"),o=m=>(m<c?"":o(parseInt(m/c)))+((m=m%c)>35?String.fromCharCode(m+29):m.toString(36)),w={};for(;l--;)w[o(l)]=u[l]||o(l);let A=i.replace(/\b\w+\b/g,m=>w[m]||m);e=e.replace(s[0],A)}catch(n){}return e}catch(a){return t}}function it(t){return h(this,null,function*(){try{let a=yield y(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!a)return{url:t};let e=yield a.text(),s=e.match(/file\s*:\s*["']([^"']*\.mp4[^"']*)['"]/i)||e.match(/src\s*:\s*["']([^"']*\.mp4[^"']*)['"]/i)||e.match(/["']((?:https?:)?\/\/[^"'\s]+\.mp4[^"'\s]*)["']/i);if(s){let n=s[1];return n.startsWith("//")?n="https:"+n:n.startsWith("/")&&(n="https://video.sibnet.ru"+n),{url:n,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(a){}return{url:t}})}function ot(t){return h(this,null,function*(){try{let a=t.replace(/vidmoly\.(net|to|ru|is)/,"vidmoly.me"),e={Referer:"https://vidmoly.me/",Origin:"https://vidmoly.me"},s=yield y(a,{headers:e});if(!s)return{url:t};let n=yield s.text(),r=n.match(/window\.location\.replace\(['"]([^'"]+)['"]\)/)||n.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);r&&r[1]!==a&&(s=yield y(r[1],{headers:e}),s&&(n=yield s.text())),n.includes("eval(function(p,a,c,k,e,d)")&&(n=U(n));let i=n.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/i)||n.match(/["'](https?:\/\/[^"']+\.(?:m3u8|mp4)[^"']*)["']/i);if(i)return{url:i[1],headers:{Referer:"https://vidmoly.me/"}}}catch(a){}return{url:t}})}function ct(t){return h(this,null,function*(){let a=t.replace(/^https?:\/\/[^/]+/,""),e=["uqload.is","uqload.co","uqload.com","uqload.io","uqloads.xyz","uqload.to"],s="https://uqload.is/";for(let n of e)try{let r=`https://${n}${a}`,i=yield y(r,{headers:{Referer:s}});if(!i)continue;let c=yield i.text(),l=c.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||c.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(l)return{url:l[1],headers:{Referer:s}}}catch(r){}return{url:t}})}function lt(t){return h(this,null,function*(){try{let a=yield y(t);if(!a)return{url:t};let e=yield a.text(),s=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(s){let r=yield y(s[1]);r&&(e=yield r.text())}let n=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(n){let r=n[1]||n[0];return r.includes("base64")&&(r=I(r.split(",")[1]||r)),{url:r,headers:{Referer:t}}}}catch(a){}return{url:t}})}function ut(t){return h(this,null,function*(){try{let a=yield y(t);if(!a)return{url:t};let e=yield a.text();e.includes("p,a,c,k,e,d")&&(e=U(e));let s=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(s){let n="https:"+s[1],r=s[2].split("+");for(let i of r){let c=i.match(/['"]([^'"]+)['"]/);if(c){let l=c[1],u=i.match(/substring\((\d+)\)/);u&&(l=l.substring(parseInt(u[1]))),n+=l}}return{url:n,headers:{Referer:"https://streamtape.com/"}}}}catch(a){}return{url:t}})}function mt(t){return h(this,null,function*(){try{let a=t.includes("/embed/")?t:t.replace(/sendvid\.com\/([a-z0-9]+)/i,"sendvid.com/embed/$1"),e=yield y(a,{headers:{Referer:"https://sendvid.com/"}});if(!e)return{url:t};let s=yield e.text(),n=s.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["|']/)||s.match(/source\s+src=["']([^"']+\.mp4[^"']*)["|']/)||s.match(/<source[^>]+src=["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/)||s.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["|']/)||s.match(/["'](https?:\/\/[^"']+\.mp4[^"']*)["']/);if(n)return{url:n[1],headers:{Referer:"https://sendvid.com/"}}}catch(a){}return{url:t}})}function ft(t){return h(this,null,function*(){try{let a=yield y(t);if(!a)return{url:t};let e=yield a.text();e.includes("p,a,c,k,e,d")&&(e=U(e));let s=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(s){let n=s[1];return n.includes("base64")&&(n=I(n.split(",")[1]||n)),{url:n,headers:{Referer:t}}}}catch(a){}return{url:t}})}function ht(t){return h(this,null,function*(){try{let a=yield y(t);if(!a)return{url:t};let s=(yield a.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(s)return{url:s[1],headers:{Referer:t}}}catch(a){}return{url:t}})}function dt(t){return h(this,null,function*(){var a;try{let e=((a=t.match(/https?:\/\/([^\/]+)/))==null?void 0:a[1])||"dood.to",s=yield y(t);if(!s)return{url:t};let n=yield s.text();n.includes("eval(function(p,a,c,k,e,d)")&&(n=U(n));let r=n.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(r){let i=r[1],c=`https://${e}/pass_md5/${i}`,l=yield fetch(c,{headers:{Referer:t}});if(l.ok){let u=yield l.text(),o=Math.random().toString(36).substring(2,12);return{url:u+o+"?token="+i+"&expiry="+Date.now(),headers:{Referer:`https://${e}/`}}}}}catch(e){}return{url:t}})}function pt(t){return h(this,null,function*(){try{let a=yield y(t,{headers:{Referer:"https://www.myvi.ru/"}});if(!a)return{url:t};let e=yield a.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=U(e));let s=e.match(/["'](?:file|src|url|stream_url)["']\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/)||e.match(/["'](https?:\/\/[^"']+\.(?:mp4|m3u8)[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.(?:mp4|m3u8)[^"']*)/);if(s)return{url:s[1],headers:{Referer:"https://www.myvi.ru/"}};let n=t.match(/\/(?:embed\/|watch\/|video\/)([a-zA-Z0-9_-]+)/);if(n){let r=`https://www.myvi.ru/api/video/${n[1]}`,i=yield y(r,{headers:{Referer:t}});if(i){let l=(yield i.text()).match(/["'](?:url|src|file)["']\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(l)return{url:l[1],headers:{Referer:"https://www.myvi.ru/"}}}}}catch(a){}return{url:t}})}function wt(t){return h(this,null,function*(){try{let a=yield y(t);if(!a)return{url:t};let s=(yield a.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(s)return{url:s[1],headers:{Referer:t}}}catch(a){}return{url:t}})}function T(t,a=0){return h(this,null,function*(){var n;if(a>3)return S(p({},t),{isDirect:!1});let e=t.url,s=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!s.includes("html"))return S(p({},t),{isDirect:!0});try{let r=null;if(s.includes("sibnet.ru")?r=yield it(e):s.includes("vidmoly.")?r=yield ot(e):s.includes("uqload.")||s.includes("oneupload.")?r=yield ct(e):s.includes("voe.")?r=yield lt(e):s.includes("streamtape.com")||s.includes("stape")?r=yield ut(e):s.includes("dood")||s.includes("ds2play")?r=yield dt(e):s.includes("moonplayer")||s.includes("moon.")?r=yield wt(e):s.includes("sendvid.")?r=yield mt(e):s.includes("myvi.")||s.includes("mytv.")?r=yield pt(e):s.includes("luluvid.")||s.includes("lulu.")?r=yield ft(e):(s.includes("hgcloud.")||s.includes("savefiles."))&&(r=yield ht(e)),r&&r.url!==e)return S(p({},t),{url:r.url,headers:p(p({},t.headers),r.headers||{}),isDirect:!0,originalUrl:e});if(!r||r.url===e){let i=yield y(e,{headers:t.headers});if(i){let c=yield i.text();c.includes("p,a,c,k,e,d")&&(c=U(c));let l=c.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||c.match(/https?:\/\/[^"']+\.mp4[^"']*/)||c.match(/file\s*:\s*["']([^"']+)["']/);if(l){let u=l[1]||l[0];u.startsWith("//")&&(u="https:"+u);let o=u.match(/\.(css|js|html|php|jpg|png|gif|svg)(\?.*)?$/i);u.startsWith("http")&&!u.includes(gt)&&!o&&(r={url:u})}if(!r){let u=c.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(u){let o=u[1];if(o.startsWith("//")&&(o="https:"+o),o.startsWith("/")){let w=(n=e.match(/^https?:\/\/[^\/]+/))==null?void 0:n[0];w&&(o=w+o)}if(o.startsWith("http")&&o!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${o}`),yield T(S(p({},t),{url:o}),a+1)}}}}if(r&&r.url!==e&&r.url.startsWith("http"))return S(p({},t),{url:r.url,headers:p(p({},t.headers),r.headers||{}),isDirect:!0,originalUrl:e})}catch(r){}return S(p({},t),{isDirect:!1})})}var gt="googletagmanager";var yt="https://arm.haglund.dev/api/v2";var vt="https://v3-cinemeta.strem.io";function q(e){return h(this,arguments,function*(t,a={}){try{let s=new AbortController,n=setTimeout(()=>s.abort(),8e3),r=yield fetch(t,S(p({},a),{signal:s.signal}));return clearTimeout(n),r}catch(s){return console.error(`[ArmSync] Fetch failed: ${t}`,s.message),null}})}function N(t,a){return h(this,null,function*(){if(!t)return null;let e=yield q(`${yt}/themoviedb?id=${t}`);if(e)try{let r=yield e.json(),i=Array.isArray(r)?r[0]:r;if(i&&i.imdb)return i.imdb}catch(r){}let s=`https://www.themoviedb.org/${a==="movie"?"movie":"tv"}/${t}`,n=yield q(s);if(n){let i=(yield n.text()).match(/imdb\.com\/title\/(tt\d+)/);if(i)return i[1]}return null})}function z(t,a,e){return h(this,null,function*(){var u;if(!t||a===0)return null;let s=yield q(`${vt}/meta/series/${t}.json`);if(!s)return null;let n=yield s.json();if(!((u=n==null?void 0:n.meta)!=null&&u.videos))return null;let r=n.meta.videos.filter(o=>o.season>0&&o.episode>0).sort((o,w)=>o.season-w.season||o.episode-w.episode),i=[],c=new Set;for(let o of r){let w=`${o.season}-${o.episode}`;c.has(w)||(c.add(w),i.push(o))}let l=i.findIndex(o=>o.season==a&&o.episode==e);if(l!==-1){let o=l+1;return console.log(`[ArmSync] Resolved: S${a}E${e} -> Absolute ${o}`),o}return null})}var H="8265bd1679663a7ea12ac168da84d2e8",L="https://api.themoviedb.org/3";function B(t){return h(this,null,function*(){try{let a=new AbortController,e=setTimeout(()=>a.abort(),8e3),s=yield fetch(t,{headers:{"User-Agent":"Mozilla/5.0",Accept:"application/json"},signal:a.signal});return clearTimeout(e),s.ok?s:null}catch(a){return null}})}function V(t,a){return h(this,null,function*(){var n,r,i,c,l,u;let e=a==="movie"?"movie":"tv",s=[];try{let o=`${L}/${e}/${t}?api_key=${H}&language=en-US`,w=yield B(o);if(w){let g=yield w.json(),f=(n=e==="movie"?g.title:g.name)==null?void 0:n.trim(),d=(r=e==="movie"?g.original_title:g.original_name)==null?void 0:r.trim();f&&s.push(f),d&&d!==f&&/^[\x00-\x7F\u00C0-\u024F\s]+$/.test(d)&&s.push(d)}let A=`${L}/${e}/${t}/translations?api_key=${H}`,m=yield B(A);if(m){let f=((yield m.json()).translations||[]).find(v=>v.iso_639_1==="fr"),d=((c=(i=f==null?void 0:f.data)==null?void 0:i.name)==null?void 0:c.trim())||((u=(l=f==null?void 0:f.data)==null?void 0:l.title)==null?void 0:u.trim());d&&!s.includes(d)&&s.push(d)}}catch(o){console.error(`[Metadata] TMDB API error: ${o.message}`)}return console.log(`[Metadata] Titles for ${t}: ${s.join(" | ")}`),s})}var b="https://anime-sama.tv";function $t(t){return h(this,null,function*(){try{let a=yield C(`${b}/template-php/defaut/fetch.php`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:b},body:`query=${encodeURIComponent(t)}`}),e=O.default.load(a),s=[];return e('a[href*="/catalogue/"]').each((n,r)=>{let c=e(r).attr("href").match(/\/catalogue\/([^/]+)\/?/);c&&!s.includes(c[1])&&s.push(c[1])}),s}catch(a){return[]}})}function xt(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function K(t,a){return a.includes("sibnet")?"Sibnet":a.includes("vidmoly")?"Vidmoly":a.includes("sendvid")?"Sendvid":a.includes("voe")?"Voe":a.includes("stape")||a.includes("streamtape")?"Streamtape":a.includes("dood")?"Doodstream":a.includes("uqload")||a.includes("oneupload")?"Uqload":"Player"}function G(t,a,e,s){return h(this,null,function*(){var w,A;let n=yield V(t,a);if(n.length===0)return[];let r=n[0],i=s;try{let m=yield N(t,a);if(m){let g=yield z(m,e,s);g&&(i=g)}}catch(m){}let c=xt(r),l=["vostfr","vf"],u=[];for(let m of l){let g=[`${b}/catalogue/${c}/saison${e}/${m}/episodes.js`,`${b}/catalogue/${c}/${m}/episodes.js`];e>1&&i&&g.push(`${b}/catalogue/${c}/saison1/${m}/episodes.js`);for(let f of g)try{let d=yield C(f),v=/var\s+([a-z0-9]+)\s*=\s*\[([\s\S]*?)\s*\];/gm,$;for(;($=v.exec(d))!==null;){let E=$[1],D=((w=$[2].match(/['"]([^'"]+)['"]/g))==null?void 0:w.map(k=>k.slice(1,-1)))||[],x=null;if(f.includes(`saison${e}`)?x=D[s-1]:(f.includes("saison1")||!f.includes("saison"))&&(e>1&&i!==s?x=D[i-1]:x=D[s-1]),x&&x.startsWith("http")){let k=yield T({name:`Anime-Sama (${m.toUpperCase()})`,title:`${K(E,x)} - Ep ${s}`,url:x,quality:"HD",headers:{Referer:b}});u.push(k)}}}catch(d){}}if(u.length===0){let m=[];for(let f of n)(yield $t(f)).forEach(v=>{m.includes(v)||m.push(v)});let g=new Set([c]);for(let f of m)if(!g.has(f)){g.add(f);for(let d of l){let v=[`${b}/catalogue/${f}/saison${e}/${d}/episodes.js`,`${b}/catalogue/${f}/${d}/episodes.js`];e>1&&i&&v.push(`${b}/catalogue/${f}/saison1/${d}/episodes.js`);for(let $ of v)try{let E=yield C($),D=/var\s+([a-z0-9]+)\s*=\s*\[([\s\S]*?)\s*\];/gm,x;for(;(x=D.exec(E))!==null;){let k=x[1],j=((A=x[2].match(/['"]([^'"]+)['"]/g))==null?void 0:A.map(M=>M.slice(1,-1)))||[],R=null;if($.includes(`saison${e}`)?R=j[s-1]:($.includes("saison1")||!$.includes("saison"))&&(e>1&&i!==s?R=j[i-1]:R=j[s-1]),R&&R.startsWith("http")){let M=yield T({name:`Anime-Sama (${d.toUpperCase()})`,title:`${K(k,R)} - Ep ${s}`,url:R,quality:"HD",headers:{Referer:b}});M&&u.push(M)}}}catch(E){}}}}let o=u.filter(m=>m&&m.isDirect);return console.log(`[Anime-Sama] Total streams found: ${o.length}`),o.sort((m,g)=>{let f=$=>$&&($.toUpperCase().includes("VF")||$.toUpperCase().includes("FRENCH")),d=f(m.name)||f(m.title),v=f(g.name)||f(g.title);return d&&!v?-1:!d&&v?1:0}),o})}function St(t,a,e,s){return h(this,null,function*(){try{return console.log(`[Anime-Sama] Request: ${a} ${t} S${e}E${s}`),yield G(t,a,e,s)}catch(n){return console.error(`[Anime-Sama] Error: ${n.message}`),[]}})}module.exports={getStreams:St};
