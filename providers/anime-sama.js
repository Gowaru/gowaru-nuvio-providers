/**
 * anime-sama - Built from src/anime-sama/
 * Generated: 2026-02-24T23:41:22.977Z
 */
var b=Object.create;var C=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames,E=Object.getOwnPropertySymbols,j=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var R=(t,e,r)=>e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,d=(t,e)=>{for(var r in e||(e={}))q.call(e,r)&&R(t,r,e[r]);if(E)for(var r of E(e))z.call(e,r)&&R(t,r,e[r]);return t};var H=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of W(e))!q.call(t,a)&&a!==r&&C(t,a,{get:()=>e[a],enumerable:!(n=D(e,a))||n.enumerable});return t};var J=(t,e,r)=>(r=t!=null?b(j(t)):{},H(e||!t||!t.__esModule?C(r,"default",{value:t,enumerable:!0}):r,t));var m=(t,e,r)=>new Promise((n,a)=>{var o=c=>{try{s(r.next(c))}catch(u){a(u)}},i=c=>{try{s(r.throw(c))}catch(u){a(u)}},s=c=>c.done?n(c.value):Promise.resolve(c.value).then(o,i);s((r=r.apply(t,e)).next())});var L={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0","Sec-Ch-Ua":'"Chromium";v="122", "Not(A:Brand";v="24", "Google Chrome";v="122"',"Sec-Ch-Ua-Mobile":"?0","Sec-Ch-Ua-Platform":'"Windows"',"Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1","Upgrade-Insecure-Requests":"1"};function g(r){return m(this,arguments,function*(t,e={}){console.log(`[Anime-Sama] Fetching: ${t}`);let n=yield fetch(t,d({headers:d(d({},L),e.headers)},e));if(!n.ok)throw new Error(`HTTP error ${n.status} for ${t}`);return yield n.text()})}var A=J(require("cheerio-without-node-native"));var p="https://anime-sama.tv";function P(t,e){return m(this,null,function*(){try{let r=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,n=yield g(r),a=A.default.load(n),o=a('meta[property="og:title"]').attr("content")||a("h1").first().text()||a("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[Anime-Sama] TMDB Title found: ${o}`),o}catch(r){return console.error(`[Anime-Sama] Failed to get title from TMDB: ${r.message}`),null}})}function B(t){return m(this,null,function*(){try{let e=`${p}/?s=${encodeURIComponent(t)}`,r=yield g(e),a=A.default.load(r)('a[href*="/catalogue/"]').first();if(a.length){let i=a.attr("href").match(/\/catalogue\/([^/]+)\/?/);if(i)return console.log(`[Anime-Sama] Search found slug: ${i[1]}`),i[1]}return null}catch(e){return console.error(`[Anime-Sama] Search Error: ${e.message}`),null}})}function k(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function T(t,e){return e.includes("sibnet")?"Sibnet":e.includes("sendvid")?"Sendvid":e.includes("mycloud")?"MyCloud":e.includes("vidmoly")?"Vidmoly":e.includes("vido")?"Vido":`Player ${t.toUpperCase()}`}function F(t,e,r,n){return m(this,null,function*(){var c,u;let a=yield P(t,e);if(!a)return[];let o=k(a),i=["vostfr","vf"],s=[];for(let $ of i){let M=`${p}/catalogue/${o}/saison${r}/${$}/episodes.js`;try{let y=yield g(M),f=new RegExp("var\\s+([a-z0-9]+)\\s*=\\s*\\[(.*?)\\s*\\]","gs"),h;for(;(h=f.exec(y))!==null;){let v=h[1],l=(((c=h[2].match(/'(.*?)'/g))==null?void 0:c.map(x=>x.slice(1,-1)))||[])[n-1];l&&l.startsWith("http")&&s.push({name:`Anime-Sama (${$.toUpperCase()})`,title:`${T(v,l)} - Ep ${n}`,url:l,quality:"HD",headers:{Referer:p}})}}catch(y){if(console.warn(`[Anime-Sama] episodes.js not found or error for ${$}: ${y.message}`),$===i[0]&&s.length===0){let f=yield B(a);if(f&&f!==o){for(let h of i){let v=`${p}/catalogue/${f}/saison${r}/${h}/episodes.js`;try{let w=yield g(v),U=new RegExp("var\\s+([a-z0-9]+)\\s*=\\s*\\[(.*?)\\s*\\]","gs"),l;for(;(l=U.exec(w))!==null;){let x=l[1],S=(((u=l[2].match(/'(.*?)'/g))==null?void 0:u.map(N=>N.slice(1,-1)))||[])[n-1];S&&S.startsWith("http")&&s.push({name:`Anime-Sama (${h.toUpperCase()})`,title:`${T(x,S)} - Ep ${n}`,url:S,quality:"HD",headers:{Referer:p}})}}catch(w){}}if(s.length>0)return s}}}}return s})}function G(t,e,r,n){return m(this,null,function*(){try{return console.log(`[Anime-Sama] Request: ${e} ${t} S${r}E${n}`),yield F(t,e,r,n)}catch(a){return console.error(`[Anime-Sama] Error: ${a.message}`),[]}})}module.exports={getStreams:G};
