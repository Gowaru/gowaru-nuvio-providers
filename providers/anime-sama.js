/**
 * anime-sama - Built from src/anime-sama/
 * Generated: 2026-02-25T10:36:17.622Z
 */
var k=Object.create;var C=Object.defineProperty,H=Object.defineProperties,N=Object.getOwnPropertyDescriptor,z=Object.getOwnPropertyDescriptors,V=Object.getOwnPropertyNames,E=Object.getOwnPropertySymbols,j=Object.getPrototypeOf,M=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var F=(t,e,s)=>e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,i=(t,e)=>{for(var s in e||(e={}))M.call(e,s)&&F(t,s,e[s]);if(E)for(var s of E(e))J.call(e,s)&&F(t,s,e[s]);return t},w=(t,e)=>H(t,z(e));var P=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of V(e))!M.call(t,n)&&n!==s&&C(t,n,{get:()=>e[n],enumerable:!(r=N(e,n))||r.enumerable});return t};var B=(t,e,s)=>(s=t!=null?k(j(t)):{},P(e||!t||!t.__esModule?C(s,"default",{value:t,enumerable:!0}):s,t));var o=(t,e,s)=>new Promise((r,n)=>{var a=m=>{try{l(s.next(m))}catch(f){n(f)}},u=m=>{try{l(s.throw(m))}catch(f){n(f)}},l=m=>m.done?r(m.value):Promise.resolve(m.value).then(a,u);l((s=s.apply(t,e)).next())});var K={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0","Sec-Ch-Ua":'"Chromium";v="122", "Not(A:Brand";v="24", "Google Chrome";v="122"',"Sec-Ch-Ua-Mobile":"?0","Sec-Ch-Ua-Platform":'"Windows"',"Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1","Upgrade-Insecure-Requests":"1"};function v(s){return o(this,arguments,function*(t,e={}){console.log(`[Anime-Sama] Fetching: ${t}`);let r=yield fetch(t,i({headers:i(i({},K),e.headers)},e));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var q=B(require("cheerio"));var G={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"};function c(s){return o(this,arguments,function*(t,e={}){try{let r=new AbortController,n=setTimeout(()=>r.abort(),1e4),a=yield fetch(t,w(i({},e),{headers:i(i({},G),e.headers),signal:r.signal}));return clearTimeout(n),a}catch(r){return console.error(`[Resolver] Fetch failed for ${t}: ${r.message}`),null}})}function _(t){return o(this,null,function*(){let e=yield c(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!e)return t;let s=yield e.text(),r=s.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||s.match(/src\s*:\s*"([^"]+\.mp4)"/)||s.match(/player\.setVideo\(\s*\{\s*"url"\s*:\s*"([^"]+)"/);if(r){let n=r[1];return n.startsWith("//")?n=`https:${n}`:n.startsWith("/")&&(n=`https://video.sibnet.ru${n}`),n}return t})}function O(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let r=(yield e.text()).match(/file\s*:\s*"([^"]+)"/);return r?r[1]:t})}function I(t){return o(this,null,function*(){let e=yield c(t,{headers:{Referer:"https://uqload.com/"}});if(!e)return t;let s=yield e.text(),r=s.match(/sources\s*:\s*\["([^"]+)"\]/)||s.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/);return r?r[1]:t})}function Q(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let s=yield e.text(),r=s.match(/'hls'\s*:\s*'([^']+)'/)||s.match(/"hls"\s*:\s*"([^"]+)"/)||s.match(/window\.location\.href\s*=\s*'([^']+)'/);if(r){let n=r[1];if(n.includes("base64"))try{let a=n.split(",")[1]||n;typeof atob!="undefined"&&(n=atob(a))}catch(a){}return n}return t})}function X(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let s=yield e.text(),r=s.match(/sources\s*:\s*\[\s*\{\s*"file"\s*:\s*"([^"]+)"/i)||s.match(/file\s*:\s*"([^"]+)"/i);return r?r[1]:t})}function Y(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let s=yield e.text(),r=s.match(/file\s*:\s*"([^"]+)"/i)||s.match(/source\s*:\s*"([^"]+)"/i);return r?r[1]:t})}function Z(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let s=yield e.text(),r=s.match(/file\s*:\s*"([^"]+)"/i)||s.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/i);return r?r[1]:t})}function ee(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let r=(yield e.text()).match(/file\s*:\s*"([^"]+)"/);return r?r[1]:t})}function te(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let r=(yield e.text()).match(/file\s*:\s*"([^"]+)"/);return r?r[1]:t})}function se(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let s=yield e.text(),r=s.match(/robotlink\.innerHTML\s*=\s*'([^']+)'/);if(r){let a=r[1];return a.startsWith("//")&&(a=`https:${a}`),a}return s.match(/video_link\s*:\s*"([^"]+)"/)?r[2]:t})}function re(t){return o(this,null,function*(){let e=yield c(t);if(!e)return t;let s=yield e.text(),r=s.match(/source\s+src="([^"]+\.mp4)"/i)||s.match(/video_source\s*:\s*"([^"]+)"/);return r?r[1]:t})}function ne(t){return o(this,null,function*(){let e=t.replace("/e/","/d/"),s=yield c(e);if(!s)return t;let n=(yield s.text()).match(/window\.open\('([^']+)'\)/);return n?n[1]:t})}function R(t){return o(this,null,function*(){let e=t.url,s=e.toLowerCase();if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return w(i({},t),{isDirect:!0});try{let r=e,n=i({},t.headers);if(s.includes("sibnet.ru")?(r=yield _(e),n.Referer="https://video.sibnet.ru/"):s.includes("vidmoly.")?(r=yield O(e),n.Referer="https://vidmoly.to/"):s.includes("uqload.")?(r=yield I(e),n.Referer="https://uqload.com/"):s.includes("voe.sx")||s.includes("christopheruntilpoint")?r=yield Q(e):s.includes("moonplayer")||s.includes("moonembed")?r=yield X(e):s.includes("mytv")||s.includes("mycloud")||s.includes("mclls.net")?r=yield Y(e):s.includes("fhd")||s.includes("fhd1")?r=yield Z(e):s.includes("upstream.")?r=yield ee(e):s.includes("vido.")||s.includes("vidlo.")?r=yield te(e):s.includes("streamtape.com")?r=yield se(e):s.includes("sendvid.com")?r=yield re(e):(s.includes("dood")||s.includes("ds2play")||s.includes("viddood"))&&(r=yield ne(e)),r!==e&&r.startsWith("http"))return console.log(`[Resolver] Success: ${e.substring(0,30)}... -> ${r.substring(0,30)}...`),w(i({},t),{url:r,isDirect:!0,headers:n,originalUrl:e})}catch(r){console.error(`[Resolver] Failed for ${e}:`,r)}return w(i({},t),{isDirect:!1})})}var y="https://anime-sama.tv";function ae(t,e){return o(this,null,function*(){try{let s=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,r=yield v(s),n=q.default.load(r),a=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();return a&&a.includes(" (")&&(a=a.split(" (")[0]),a&&a.includes(" - ")&&(a=a.split(" - ")[0]),a=a?a.trim():null,console.log(`[Anime-Sama] TMDB Title found: ${a}`),a}catch(s){return console.error(`[Anime-Sama] Failed to get title from TMDB: ${s.message}`),null}})}function oe(t){return o(this,null,function*(){try{let e=`${y}/?s=${encodeURIComponent(t)}`,s=yield v(e),n=q.default.load(s)('a[href*="/catalogue/"]').first();if(n.length){let u=n.attr("href").match(/\/catalogue\/([^/]+)\/?/);if(u)return console.log(`[Anime-Sama] Search found slug: ${u[1]}`),u[1]}return null}catch(e){return console.error(`[Anime-Sama] Search Error: ${e.message}`),null}})}function ie(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function W(t,e){return e.includes("sibnet")?"Sibnet":e.includes("sendvid")?"Sendvid":e.includes("mycloud")?"MyCloud":e.includes("vidmoly")?"Vidmoly":e.includes("vido")?"Vido":`Player ${t.toUpperCase()}`}function D(t,e,s,r){return o(this,null,function*(){var m,f;let n=yield ae(t,e);if(!n)return[];let a=ie(n),u=["vostfr","vf"],l=[];for(let x of u){let L=`${y}/catalogue/${a}/saison${s}/${x}/episodes.js`;try{let S=yield v(L),d=new RegExp("var\\s+([a-z0-9]+)\\s*=\\s*\\[(.*?)\\s*\\]","gs"),p;for(;(p=d.exec(S))!==null;){let U=p[1],h=(((m=p[2].match(/'(.*?)'/g))==null?void 0:m.map(g=>g.slice(1,-1)))||[])[r-1];if(h&&h.startsWith("http")){let g=yield R({name:`Anime-Sama (${x.toUpperCase()})`,title:`${W(U,h)} - Ep ${r}`,url:h,quality:"HD",headers:{Referer:y}});l.push(g)}}}catch(S){if(console.warn(`[Anime-Sama] episodes.js not found or error for ${x}: ${S.message}`),x===u[0]&&l.length===0){let d=yield oe(n);if(d&&d!==a){for(let p of u){let U=`${y}/catalogue/${d}/saison${s}/${p}/episodes.js`;try{let b=yield v(U),T=new RegExp("var\\s+([a-z0-9]+)\\s*=\\s*\\[(.*?)\\s*\\]","gs"),h;for(;(h=T.exec(b))!==null;){let g=h[1],$=(((f=h[2].match(/'(.*?)'/g))==null?void 0:f.map(A=>A.slice(1,-1)))||[])[r-1];if($&&$.startsWith("http")){let A=yield R({name:`Anime-Sama (${p.toUpperCase()})`,title:`${W(g,$)} - Ep ${r}`,url:$,quality:"HD",headers:{Referer:y}});l.push(A)}}}catch(b){}}if(l.length>0)return l}}}}return l})}function ce(t,e,s,r){return o(this,null,function*(){try{return console.log(`[Anime-Sama] Request: ${e} ${t} S${s}E${r}`),yield D(t,e,s,r)}catch(n){return console.error(`[Anime-Sama] Error: ${n.message}`),[]}})}module.exports={getStreams:ce};
