/**
 * vostfree - Built from src/vostfree/
 * Generated: 2026-02-25T22:30:07.641Z
 */
var K=Object.create;var R=Object.defineProperty,O=Object.defineProperties,J=Object.getOwnPropertyDescriptor,z=Object.getOwnPropertyDescriptors,G=Object.getOwnPropertyNames,_=Object.getOwnPropertySymbols,Q=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var W=(t,s,e)=>s in t?R(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,h=(t,s)=>{for(var e in s||(s={}))q.call(s,e)&&W(t,e,s[e]);if(_)for(var e of _(s))X.call(s,e)&&W(t,e,s[e]);return t},$=(t,s)=>O(t,z(s));var Y=(t,s)=>{for(var e in s)R(t,e,{get:s[e],enumerable:!0})},I=(t,s,e,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let i of G(s))!q.call(t,i)&&i!==e&&R(t,i,{get:()=>s[i],enumerable:!(r=J(s,i))||r.enumerable});return t};var Z=(t,s,e)=>(e=t!=null?K(Q(t)):{},I(s||!t||!t.__esModule?R(e,"default",{value:t,enumerable:!0}):e,t)),tt=t=>I(R({},"__esModule",{value:!0}),t);var f=(t,s,e)=>new Promise((r,i)=>{var o=c=>{try{u(e.next(c))}catch(l){i(l)}},a=c=>{try{u(e.throw(c))}catch(l){i(l)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,a);u((e=e.apply(t,s)).next())});var vt={};Y(vt,{getStreams:()=>yt});module.exports=tt(vt);var et={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function A(e){return f(this,arguments,function*(t,s={}){console.log(`[Vostfree] Fetching: ${t}`);let r=yield fetch(t,h({headers:h(h({},et),s.headers)},s));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var D=Z(require("cheerio"));var st={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36"},j=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(s){return t}};function y(e){return f(this,arguments,function*(t,s={}){try{let r=yield fetch(t,$(h({},s),{headers:h(h({},st),s.headers),redirect:"follow"}));if(!r.ok)return null;let i=yield r.text();return{text:()=>Promise.resolve(i),ok:!0,url:r.url,headers:r.headers}}catch(r){return null}})}function k(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let s=new RegExp("eval\\s*\\(\\s*function\\s*\\(\\s*p\\s*,\\s*a\\s*,\\s*c\\s*,\\s*k\\s*,\\s*e\\s*,\\s*d\\s*\\).*?\\}\\s*\\((.*?)\\)\\s*\\)","gs"),e=t,r;for(;(r=s.exec(t))!==null;)try{let o=r[1].match(new RegExp("^'(.*?)',\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*'(.*?)'\\.split\\('\\|'\\)","s"));if(!o)continue;let a=o[1].replace(/\\'/g,"'"),u=parseInt(o[2]),c=parseInt(o[3]),l=o[4].split("|"),n=m=>(m<u?"":n(parseInt(m/u)))+((m=m%u)>35?String.fromCharCode(m+29):m.toString(36)),d={};for(;c--;)d[n(c)]=l[c]||n(c);let x=a.replace(/\b\w+\b/g,m=>d[m]||m);e=e.replace(r[0],x)}catch(i){}return e}catch(s){return t}}function rt(t){return f(this,null,function*(){try{let s=yield y(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!s)return{url:t};let e=yield s.text(),r=e.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||e.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let i=r[1];return i.startsWith("//")?i="https:"+i:i.startsWith("/")&&(i="https://video.sibnet.ru"+i),{url:i,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(s){}return{url:t}})}function nt(t){return f(this,null,function*(){try{let s=yield y(t,{headers:{Referer:"https://vidmoly.to/"}});if(!s)return{url:t};let e=yield s.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=k(e));let r=e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(s){}return{url:t}})}function ot(t){return f(this,null,function*(){try{let s=yield y(t,{headers:{Referer:"https://uqload.com/"}});if(!s)return{url:t};let e=yield s.text(),r=e.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(r)return{url:r[1],headers:{Referer:"https://uqload.com/"}}}catch(s){}return{url:t}})}function it(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let e=yield s.text(),r=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r){let o=yield y(r[1]);o&&(e=yield o.text())}let i=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(i){let o=i[1]||i[0];return o.includes("base64")&&(o=j(o.split(",")[1]||o)),{url:o,headers:{Referer:t}}}}catch(s){}return{url:t}})}function at(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=k(e));let r=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(r){let i="https:"+r[1],o=r[2].split("+");for(let a of o){let u=a.match(/['"]([^'"]+)['"]/);if(u){let c=u[1],l=a.match(/substring\((\d+)\)/);l&&(c=c.substring(parseInt(l[1]))),i+=c}}return{url:i,headers:{Referer:"https://streamtape.com/"}}}}catch(s){}return{url:t}})}function ct(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let e=yield s.text(),r=e.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.mp4[^"']*)["']/);if(r)return{url:r[1]}}catch(s){}return{url:t}})}function lt(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=k(e));let r=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r){let i=r[1];return i.includes("base64")&&(i=j(i.split(",")[1]||i)),{url:i,headers:{Referer:t}}}}catch(s){}return{url:t}})}function ut(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let r=(yield s.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:t}}}catch(s){}return{url:t}})}function ft(t){return f(this,null,function*(){var s;try{let e=((s=t.match(/https?:\/\/([^\/]+)/))==null?void 0:s[1])||"dood.to",r=yield y(t);if(!r)return{url:t};let i=yield r.text();i.includes("eval(function(p,a,c,k,e,d)")&&(i=k(i));let o=i.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(o){let a=o[1],u=`https://${e}/pass_md5/${a}`,c=yield fetch(u,{headers:{Referer:t}});if(c.ok){let l=yield c.text(),n=Math.random().toString(36).substring(2,12);return{url:l+n+"?token="+a+"&expiry="+Date.now(),headers:{Referer:`https://${e}/`}}}}}catch(e){}return{url:t}})}function ht(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let r=(yield s.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:t}}}catch(s){}return{url:t}})}function U(t,s=0){return f(this,null,function*(){var i;if(s>3)return $(h({},t),{isDirect:!1});let e=t.url,r=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(r.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!r.includes("html"))return $(h({},t),{isDirect:!0});try{let o=null;if(r.includes("sibnet.ru")?o=yield rt(e):r.includes("vidmoly.")?o=yield nt(e):r.includes("uqload.")||r.includes("oneupload.")?o=yield ot(e):r.includes("voe.")?o=yield it(e):r.includes("streamtape.com")||r.includes("stape")?o=yield at(e):r.includes("dood")||r.includes("ds2play")?o=yield ft(e):r.includes("moonplayer")||r.includes("moon.")?o=yield ht(e):r.includes("sendvid.")?o=yield ct(e):r.includes("luluvid.")||r.includes("lulu.")?o=yield lt(e):(r.includes("hgcloud.")||r.includes("savefiles."))&&(o=yield ut(e)),o&&o.url!==e)return $(h({},t),{url:o.url,headers:h(h({},t.headers),o.headers||{}),isDirect:!0,originalUrl:e});if(!o||o.url===e){let a=yield y(e,{headers:t.headers});if(a){let u=yield a.text();u.includes("p,a,c,k,e,d")&&(u=k(u));let c=u.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||u.match(/https?:\/\/[^"']+\.mp4[^"']*/)||u.match(/file\s*:\s*["']([^"']+)["']/);if(c){let l=c[1]||c[0];l.startsWith("//")&&(l="https:"+l),l.startsWith("http")&&!l.includes(dt)&&(o={url:l})}if(!o){let l=u.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(l){let n=l[1];if(n.startsWith("//")&&(n="https:"+n),n.startsWith("/")){let d=(i=e.match(/^https?:\/\/[^\/]+/))==null?void 0:i[0];d&&(n=d+n)}if(n.startsWith("http")&&n!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${n}`),yield U($(h({},t),{url:n}),s+1)}}}}if(o&&o.url!==e&&o.url.startsWith("http"))return $(h({},t),{url:o.url,headers:h(h({},t.headers),o.headers||{}),isDirect:!0,originalUrl:e})}catch(o){}return $(h({},t),{isDirect:!1})})}var dt="googletagmanager";var mt="https://arm.haglund.dev/api/v2";var pt="https://v3-cinemeta.strem.io";function V(e){return f(this,arguments,function*(t,s={}){try{let r=new AbortController,i=setTimeout(()=>r.abort(),8e3),o=yield fetch(t,$(h({},s),{signal:r.signal}));return clearTimeout(i),o}catch(r){return console.error(`[ArmSync] Fetch failed: ${t}`,r.message),null}})}function N(t,s){return f(this,null,function*(){if(!t)return null;let e=yield V(`${mt}/themoviedb?id=${t}`);if(e)try{let o=yield e.json(),a=Array.isArray(o)?o[0]:o;if(a&&a.imdb)return a.imdb}catch(o){}let r=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}`,i=yield V(r);if(i){let a=(yield i.text()).match(/imdb\.com\/title\/(tt\d+)/);if(a)return a[1]}return null})}function P(t,s,e){return f(this,null,function*(){var l;if(!t||s===0)return null;let r=yield V(`${pt}/meta/series/${t}.json`);if(!r)return null;let i=yield r.json();if(!((l=i==null?void 0:i.meta)!=null&&l.videos))return null;let o=i.meta.videos.filter(n=>n.season>0&&n.episode>0).sort((n,d)=>n.season-d.season||n.episode-d.episode),a=[],u=new Set;for(let n of o){let d=`${n.season}-${n.episode}`;u.has(d)||(u.add(d),a.push(n))}let c=a.findIndex(n=>n.season==s&&n.episode==e);if(c!==-1){let n=c+1;return console.log(`[ArmSync] Resolved: S${s}E${e} -> Absolute ${n}`),n}return null})}var F="https://vostfree.ws";function wt(t,s){return f(this,null,function*(){try{let e=[],r=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}?language=en-US`,i=yield A(r),o=D.load(i),a=o('meta[property="og:title"]').attr("content")||o("h1").first().text()||o("h2").first().text();a&&a.includes(" (")&&(a=a.split(" (")[0]),a&&a.includes(" - ")&&(a=a.split(" - ")[0]),a&&e.push(a.trim());let u=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}?language=fr-FR`,c=yield A(u),l=D.load(c),n=l('meta[property="og:title"]').attr("content")||l("h1").first().text()||l("h2").first().text();return n&&n.includes(" (")&&(n=n.split(" (")[0]),n&&n.includes(" - ")&&(n=n.split(" - ")[0]),n&&n.trim()!==(a==null?void 0:a.trim())&&e.push(n.trim()),console.log(`[Vostfree] TMDB Titles found: ${e.join(", ")}`),e}catch(e){return console.error(`[Vostfree] Failed to get titles from TMDB: ${e.message}`),[]}})}function gt(t){return f(this,null,function*(){try{let s=`do=search&subaction=search&story=${encodeURIComponent(t)}`,e=yield A(`${F}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:F},body:s}),r=D.load(e),i=[];r(".title a, .search-result-item a, .movie-title a").each((c,l)=>{let n=r(l).attr("href");n&&(n.includes(".html")||n.includes("/anime/"))&&i.push({title:r(l).text().trim()||r(l).attr("title"),url:n})});let o=c=>c.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),a=o(t);console.log(`[Vostfree] Results found: ${i.length}`);let u=i.filter(c=>o(c.title).includes(a));return u.length>0&&console.log(`[Vostfree] Found ${u.length} matches for ${t}`),u}catch(s){return console.error(`[Vostfree] Search error: ${s.message}`),[]}})}function H(t,s,e,r){return f(this,null,function*(){let i=yield wt(t,s);if(i.length===0)return[];let o=[r];try{let n=yield N(t,s);if(n){let d=yield P(n,e,r);d&&d!==r&&o.push(d)}}catch(n){console.warn(`[Vostfree] ArmSync failed: ${n.message}`)}let a=[];for(let n of i)if(a=yield gt(n),a&&a.length>0)break;if(!a||a.length===0)return[];a=a.sort((n,d)=>{let x=n.title.toLowerCase(),m=d.title.toLowerCase(),S=`saison ${e}`,b=x.includes(S),v=m.includes(S);return b&&!v?-1:!b&&v?1:0});let u=[],c=new Set;for(let n of a){if(c.has(n.url))continue;c.add(n.url);let d=n.title.toLowerCase(),x=n.url,m=n.title.toUpperCase().includes(" VF")||n.url.includes("/vf/")?"VF":"VOSTFR",S=d.match(/saison\s*(\d+)/);if(!(S&&parseInt(S[1])!==e&&o.length===1))try{let b=yield A(x),v=D.load(b),C=null;if(v("select.new_player_selector option").each((T,E)=>{let p=v(E).text();for(let M of o){let w=M.toString(),g=w.padStart(2,"0");if(new RegExp(`(?:^|[^0-9])(?:Episode\\s*)?(?:${w}|${g})(?:$|[^0-9])`,"i").test(p))return C=v(E).val(),!1}}),!C){console.warn(`[Vostfree] Episode ${r} not found in selector on ${x}`);continue}console.log(`[Vostfree] Using buttons ID: ${C} for ${m}`);let B=v(`#${C} div[id^="player_"]`).toArray();for(let T of B){let E=v(T).attr("id").replace("player_",""),p=v(T).text().trim()||"Player",M=`content_player_${E}`,w=v(`#${M}`).text().trim();if(w){let g=w;if(g.startsWith("http")||(p.toLowerCase().includes("sibnet")?g=`https://video.sibnet.ru/shell.php?videoid=${w}`:p.toLowerCase().includes("vidmoly")?g=`https://vidmoly.to/embed-${w}.html`:p.toLowerCase().includes("uqload")||p.toLowerCase().includes("oneupload")?g=`https://uqload.com/embed-${w}.html`:p.toLowerCase().includes("sendvid")?g=`https://sendvid.com/embed/${w}`:p.toLowerCase().includes("voe")?g=`https://voe.sx/e/${w}`:p.toLowerCase().includes("dood")?g=`https://dood.to/e/${w}`:(p.toLowerCase().includes("stape")||p.toLowerCase().includes("streamtape"))&&(g=`https://streamtape.com/e/${w}`)),g.startsWith("http")){let L=yield U({name:`Vostfree (${m})`,title:`${p} - ${m}`,url:g,quality:"HD",headers:{Referer:F}});L&&u.push(L)}}}}catch(b){console.error(`[Vostfree] Match handle error: ${b.message}`)}}let l=u.filter(n=>n&&n.isDirect);return console.log(`[Vostfree] Total streams found: ${l.length}`),l})}function yt(t,s,e,r){return f(this,null,function*(){console.log(`[Vostfree] Request: ${s} ${t} S${e}E${r}`);try{return yield H(t,s,e,r)}catch(i){return console.error("[Vostfree] Error:",i),[]}})}
