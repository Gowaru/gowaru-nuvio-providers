/**
 * vostfree - Built from src/vostfree/
 * Generated: 2026-02-25T16:19:28.051Z
 */
var F=Object.create;var k=Object.defineProperty,H=Object.defineProperties,P=Object.getOwnPropertyDescriptor,N=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,z=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var E=(t,e,s)=>e in t?k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,u=(t,e)=>{for(var s in e||(e={}))D.call(e,s)&&E(t,s,e[s]);if(R)for(var s of R(e))K.call(e,s)&&E(t,s,e[s]);return t},m=(t,e)=>H(t,N(e));var J=(t,e)=>{for(var s in e)k(t,s,{get:e[s],enumerable:!0})},T=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of B(e))!D.call(t,o)&&o!==s&&k(t,o,{get:()=>e[o],enumerable:!(r=P(e,o))||r.enumerable});return t};var O=(t,e,s)=>(s=t!=null?F(z(t)):{},T(e||!t||!t.__esModule?k(s,"default",{value:t,enumerable:!0}):s,t)),G=t=>T(k({},"__esModule",{value:!0}),t);var d=(t,e,s)=>new Promise((r,o)=>{var n=a=>{try{i(s.next(a))}catch(c){o(c)}},l=a=>{try{i(s.throw(a))}catch(c){o(c)}},i=a=>a.done?r(a.value):Promise.resolve(a.value).then(n,l);i((s=s.apply(t,e)).next())});var de={};J(de,{getStreams:()=>ue});module.exports=G(de);var Q={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function b(s){return d(this,arguments,function*(t,e={}){console.log(`[Vostfree] Fetching: ${t}`);let r=yield fetch(t,u({headers:u(u({},Q),e.headers)},e));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var C=O(require("cheerio"));var M={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"};function v(s){return d(this,arguments,function*(t,e={}){try{let r=yield fetch(t,m(u({},e),{headers:u(u({},M),e.headers),redirect:"follow"}));if(!r.ok)return null;let o=yield r.text(),n={};r.headers&&r.headers.forEach((i,a)=>{n[a.toLowerCase()]=i});let l=o.match(/window\.location\.(?:replace|href)\s*\(['"]([^'"]+)['"]\)/i);if(l){let i=l[1];i.startsWith("/")&&(i=t.match(/https?:\/\/[^\/]+/)[0]+i);let a=n["set-cookie"]||"",c=yield fetch(i,m(u({},e),{headers:u(m(u({},M),{Referer:t,Cookie:a}),e.headers)}));if(c.ok){let h=yield c.text(),x={};return c.headers&&c.headers.forEach((y,$)=>x[$.toLowerCase()]=y),{text:()=>Promise.resolve(h),ok:!0,url:c.url,headers:u(u({},n),x)}}}return{text:()=>Promise.resolve(o),ok:!0,url:r.url,headers:n}}catch(r){return null}})}function g(t){if(!t)return"";let e=t["set-cookie"];return e?Array.isArray(e)?e.map(s=>s.split(";")[0]).join("; "):e.split(";")[0]:""}function L(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let e=t.match(/}\s*\((.*)\)\s*$/);if(!e)return t;let s=e[1].match(/(".+"|\d+)/g);if(s.length<4)return t;let[r,o,n,l]=[s[0].replace(/^"|"$/g,""),parseInt(s[1]),parseInt(s[2]),s[3].replace(/^"|"$/g,"").split("|")],i=c=>(c<o?"":i(parseInt(c/o)))+((c=c%o)>35?String.fromCharCode(c+29):c.toString(36)),a={};for(;n--;)a[i(n)]=l[n]||i(n);return r.replace(/\b\w+\b/g,c=>a[c]||c)}catch(e){return t}}function X(s){return d(this,arguments,function*(t,e={}){try{let r=yield fetch(t,{method:"GET",headers:m(u({},e),{Range:"bytes=0-1"})});if(r.status===200||r.status===206){let o=r.headers.get("content-type")||"";return o.includes("video")||o.includes("mpegurl")||o.includes("application/octet-stream")}return!1}catch(r){return!1}})}function Y(t){return d(this,null,function*(){try{let e=yield v(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!e)return{url:t};let s=yield e.text(),r=g(e.headers),o=s.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||s.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||s.match(/video_url\s*:\s*'([^']+)'/);if(o){let n=o[1];return n.startsWith("//")?n="https:"+n:n.startsWith("/")&&(n="https://video.sibnet.ru"+n),{url:n,headers:{Cookie:r}}}}catch(e){}return{url:t}})}function Z(t){return d(this,null,function*(){try{let e=yield v(t,{headers:{Referer:"https://vidmoly.to/"}});if(!e)return{url:t};let s=yield e.text(),r=g(e.headers);s.includes("eval(function(p,a,c,k,e,d)")&&(s=L(s));let o=s.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/)||s.match(/sources\s*:\s*\[\s*\{\s*file\s*:\s*["']([^"']+)["']/)||s.match(/["']?file["']?\s*:\s*["']([^"']+)["']/);if(o)return{url:o[1],headers:{Cookie:r}}}catch(e){}return{url:t}})}function ee(t){return d(this,null,function*(){try{let e=yield v(t,{headers:{Referer:"https://uqload.com/"}});if(!e)return{url:t};let s=yield e.text(),r=g(e.headers),o=s.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||s.match(/src\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/)||s.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/)||s.match(/vurl\s*=\s*["']([^"']+)["']/);if(o)return{url:o[1],headers:{Cookie:r}}}catch(e){}return{url:t}})}function V(t){return d(this,null,function*(){try{let e=yield v(t);if(!e)return{url:t};let s=yield e.text(),r=g(e.headers),o=s.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(o)return V(o[1]);let n=s.match(/'hls'\s*:\s*'([^']+)'/)||s.match(/"hls"\s*:\s*"([^"]+)"/)||s.match(/file\s*:\s*['"]([^'"]+\.m3u8[^'"]*)['"]/);if(n){let i=n[1];if(i.includes("base64"))try{let a=i.split(",")[1]||i;i=atob(a)}catch(a){}return{url:i,headers:{Cookie:r}}}let l=s.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(l)return{url:l[0],headers:{Cookie:r}}}catch(e){}return{url:t}})}function te(t){return d(this,null,function*(){try{let e=yield v(t);if(!e)return{url:t};let s=yield e.text(),r=g(e.headers),o=s.match(/document\.getElementById\(['"]robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*(?:['"]([^'"]+)['"]|['"]([^'"]+)['"]\.substring\(\d+\))/);if(o){let i=o[1],a=o[2]||"";if(o[3]){let c=s.match(/substring\((\d+)\)/),h=c?parseInt(c[1]):0;a=o[3].substring(h)}return{url:"https:"+i+a,headers:{Cookie:r}}}let n=s.match(/id=['"]robotlink['"]>([^<]+)/);if(n)return{url:"https:"+n[1],headers:{Cookie:r}};let l=s.match(/get_video\?id=[^&'"]+/);if(l)return{url:"https://streamtape.com/"+l[0],headers:{Cookie:r}}}catch(e){}return{url:t}})}function se(t){return d(this,null,function*(){try{let e=t.match(/https?:\/\/([^\/]+)/);if(!e)return{url:t};let s=e[1],r=yield v(t);if(!r)return{url:t};let o=yield r.text(),n=g(r.headers);o.includes("eval(function(p,a,c,k,e,d)")&&(o=L(o));let l=o.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(l){let i=l[1],a=`https://${s}/pass_md5/${i}`,c=yield fetch(a,{headers:{Referer:t,Cookie:n}});if(c.ok){let h=yield c.text(),x=g({"set-cookie":c.headers.get("set-cookie")}),y=[n,x].filter(Boolean).join("; ");return{url:h+"z762vpz?token="+i+"&expiry="+Date.now(),headers:{Cookie:y}}}}}catch(e){}return{url:t}})}function re(t){return d(this,null,function*(){try{let e=yield v(t);if(!e)return{url:t};let s=yield e.text(),r=g(e.headers),o=s.match(/source\s*src=['"]([^'"]+\.mp4)['"]/)||s.match(/content=['"]([^'"]+\.mp4)['"]/)||s.match(/video_url\s*:\s*['"]([^'"]+)['"]/);if(o)return{url:o[1],headers:{Cookie:r}}}catch(e){}return{url:t}})}function oe(t){return d(this,null,function*(){try{let e=yield v(t);if(!e)return{url:t};let s=yield e.text(),r=g(e.headers),o=s.match(/vurl=["']([^"']+)["']/)||s.match(/file\s*:\s*["']([^"']+)["']/)||s.match(/["']?url["']?\s*:\s*["']([^"']+)["']/);if(o){let n=o[1];return n.startsWith("//")&&(n="https:"+n),{url:n,headers:{Cookie:r}}}}catch(e){}return{url:t}})}function ne(t){return d(this,null,function*(){try{let e=yield v(t);if(!e)return{url:t};let s=yield e.text(),r=g(e.headers),o=s.match(/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/)||s.match(/file\s*:\s*["']([^"']+\.mp4[^"']*)["']/);if(o)return{url:o[1],headers:{Cookie:r}}}catch(e){}return{url:t}})}function q(t){return d(this,null,function*(){let e=t.url,s=e.toLowerCase();if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return m(u({},t),{isDirect:!0});try{let r={url:e,headers:u({},t.headers)};if(s.includes("sibnet.ru"))r=yield Y(e),r.headers=m(u({},r.headers),{Referer:"https://video.sibnet.ru/"});else if(s.includes("vidmoly."))r=yield Z(e),r.headers=m(u({},r.headers),{Referer:"https://vidmoly.to/"});else if(s.includes("uqload.")||s.includes("oneupload."))r=yield ee(e),r.headers=m(u({},r.headers),{Referer:"https://uqload.com/"});else if(s.includes("voe."))r=yield V(e);else if(s.includes("streamtape.com")||s.includes("stape"))r=yield te(e);else if(s.includes("dood")||s.includes("ds2play"))r=yield se(e);else if(s.includes("sendvid.com"))r=yield re(e);else if(s.includes("myvi.")||s.includes("mytv"))r=yield oe(e);else if(s.includes("moonplayer")||s.includes("moon."))r=yield ne(e);else{let o=yield v(e);if(o){let n=yield o.text(),l=g(o.headers),i=n.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||n.match(/https?:\/\/[^"']+\.mp4[^"']*/);i&&(r={url:i[0],headers:{Cookie:l}})}}if(r.url!==e&&r.url.startsWith("http"))return console.log("[Resolver] Successfully resolved: "+e.substring(0,30)+"..."),(yield X(r.url,u(u({},t.headers),r.headers)))?m(u({},t),{url:r.url,isDirect:!0,headers:u(u({},t.headers),r.headers),originalUrl:e}):(console.log("[Resolver] Stream validation failed for: "+r.url.substring(0,30)),m(u({},t),{isDirect:!1,error:"Link expired or invalid"}))}catch(r){console.error("[Resolver] Failed for "+e+":",r.message)}return m(u({},t),{isDirect:!1})})}var ae="https://arm.haglund.dev/api/v2";var ie="https://v3-cinemeta.strem.io";function _(s){return d(this,arguments,function*(t,e={}){try{let r=new AbortController,o=setTimeout(()=>r.abort(),8e3),n=yield fetch(t,m(u({},e),{signal:r.signal}));return clearTimeout(o),n}catch(r){return console.error(`[ArmSync] Fetch failed: ${t}`,r.message),null}})}function I(t,e){return d(this,null,function*(){if(!t)return null;let s=yield _(`${ae}/themoviedb?id=${t}`);if(s){let r=yield s.json(),o=Array.isArray(r)?r[0]:r;if(o&&o.imdb)return o.imdb}return null})}function U(t,e,s){return d(this,null,function*(){var i;if(!t||e===0)return null;let r=yield _(`${ie}/meta/series/${t}.json`);if(!r)return null;let o=yield r.json();if(!((i=o==null?void 0:o.meta)!=null&&i.videos))return null;let l=o.meta.videos.filter(a=>a.season>0).sort((a,c)=>a.season-c.season||a.episode-c.episode).findIndex(a=>a.season==e&&a.episode==s);if(l!==-1){let a=l+1;return console.log(`[ArmSync] Resolved: S${e}E${s} -> Absolute ${a}`),a}return null})}var S="https://vostfree.ws";function ce(t,e){return d(this,null,function*(){try{let s=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,r=yield b(s),o=C.default.load(r),n=o('meta[property="og:title"]').attr("content")||o("h1").first().text()||o("h2").first().text();return n&&n.includes(" (")&&(n=n.split(" (")[0]),n&&n.includes(" - ")&&(n=n.split(" - ")[0]),n=n?n.trim():null,console.log(`[Vostfree] TMDB Title found: ${n}`),n}catch(s){return console.error(`[Vostfree] Failed to get title from TMDB: ${s.message}`),null}})}function le(t){return d(this,null,function*(){try{let e=`do=search&subaction=search&story=${encodeURIComponent(t)}`,s=yield b(`${S}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:S},body:e}),r=C.default.load(s),o=[];r(".title a, .search-result-item a, .movie-title a").each((a,c)=>{let h=r(c).attr("href");h&&(h.includes(".html")||h.includes("/anime/"))&&o.push({title:r(c).text().trim()||r(c).attr("title"),url:h})});let n=a=>a.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),l=n(t);console.log(`[Vostfree] Results found: ${o.length}`);let i=o.find(a=>n(a.title)===l);return i||(i=o.find(a=>n(a.title).includes(l)&&a.title.includes("VOSTFR"))),i||(i=o.find(a=>n(a.title).includes(l))),i||(i=o[0]),i?(console.log(`[Vostfree] Selected: ${i.title} -> ${i.url}`),i.url):null}catch(e){return console.error(`[Vostfree] Search error: ${e.message}`),null}})}function j(t,e,s,r){return d(this,null,function*(){let o=yield ce(t,e);if(!o)return[];let n=[r];try{let i=yield I(t,e);if(i){let a=yield U(i,s,r);a&&n.push(a)}}catch(i){console.warn(`[Vostfree] ArmSync failed: ${i.message}`)}let l=yield le(o);if(!l)return[];try{let i=yield b(l),a=C.default.load(i),c=null;if(a("select.new_player_selector option").each((y,$)=>{let f=a($).text();for(let A of n){let p=A.toString(),w=p.padStart(2,"0");if(f.includes(`Episode ${p}`)||f.includes(`Episode ${w}`))return c=a($).val(),!1}}),!c){console.warn(`[Vostfree] Episode ${r} not found in selector on ${l}`);let y=a('div[id^="buttons_"]').first().attr("id");if(y)console.log(`[Vostfree] Falling back to first available buttons: ${y}`),c=y;else return[]}console.log(`[Vostfree] Using buttons ID: ${c}`);let h=[],x=a(`#${c} div[id^="player_"]`).toArray();for(let y of x){let $=a(y).attr("id").replace("player_",""),f=a(y).text().trim()||"Player",A=`content_player_${$}`,p=a(`#${A}`).text().trim();if(p){let w=p;if(w.startsWith("http")||(f.toLowerCase().includes("sibnet")?w=`https://video.sibnet.ru/shell.php?videoid=${p}`:f.toLowerCase().includes("vidmoly")?w=`https://vidmoly.to/embed-${p}.html`:f.toLowerCase().includes("uqload")||f.toLowerCase().includes("oneupload")?w=`https://uqload.com/embed-${p}.html`:f.toLowerCase().includes("sendvid")?w=`https://sendvid.com/embed/${p}`:f.toLowerCase().includes("voe")?w=`https://voe.sx/e/${p}`:f.toLowerCase().includes("dood")?w=`https://dood.to/e/${p}`:(f.toLowerCase().includes("stape")||f.toLowerCase().includes("streamtape"))&&(w=`https://streamtape.com/e/${p}`)),w.startsWith("http")){let W=yield q({name:`Vostfree (${f})`,title:`${f} Player`,url:w,quality:"HD",headers:{Referer:S}});h.push(W)}}}return h}catch(i){return console.error(`[Vostfree] Extraction error: ${i.message}`),[]}})}function ue(t,e,s,r){return d(this,null,function*(){console.log(`[Vostfree] Request: ${e} ${t} S${s}E${r}`);try{return yield j(t,e,s,r)}catch(o){return console.error("[Vostfree] Error:",o),[]}})}
