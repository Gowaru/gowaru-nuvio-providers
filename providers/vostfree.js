/**
 * vostfree - Built from src/vostfree/
 * Generated: 2026-02-25T16:30:00.240Z
 */
var q=Object.create;var $=Object.defineProperty,F=Object.defineProperties,W=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertyNames,k=Object.getOwnPropertySymbols,H=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var D=(t,e,r)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,f=(t,e)=>{for(var r in e||(e={}))E.call(e,r)&&D(t,r,e[r]);if(k)for(var r of k(e))B.call(e,r)&&D(t,r,e[r]);return t},y=(t,e)=>F(t,P(e));var z=(t,e)=>{for(var r in e)$(t,r,{get:e[r],enumerable:!0})},C=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of N(e))!E.call(t,n)&&n!==r&&$(t,n,{get:()=>e[n],enumerable:!(s=W(e,n))||s.enumerable});return t};var K=(t,e,r)=>(r=t!=null?q(H(t)):{},C(e||!t||!t.__esModule?$(r,"default",{value:t,enumerable:!0}):r,t)),J=t=>C($({},"__esModule",{value:!0}),t);var u=(t,e,r)=>new Promise((s,n)=>{var o=i=>{try{a(r.next(i))}catch(c){n(c)}},l=i=>{try{a(r.throw(i))}catch(c){n(c)}},a=i=>i.done?s(i.value):Promise.resolve(i.value).then(o,l);a((r=r.apply(t,e)).next())});var it={};z(it,{getStreams:()=>ot});module.exports=J(it);var O={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function x(r){return u(this,arguments,function*(t,e={}){console.log(`[Vostfree] Fetching: ${t}`);let s=yield fetch(t,f({headers:f(f({},O),e.headers)},e));if(!s.ok)throw new Error(`HTTP error ${s.status} for ${t}`);return yield s.text()})}var b=K(require("cheerio"));var G={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"},Q=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(e){return t}};function g(r){return u(this,arguments,function*(t,e={}){try{let s=yield fetch(t,y(f({},e),{headers:f(f({},G),e.headers)}));if(!s.ok)return null;let n=yield s.text(),o=s.headers.get("set-cookie")||"";return{text:()=>Promise.resolve(n),ok:!0,url:s.url,headers:{"set-cookie":o}}}catch(s){return null}})}function R(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let e=t.match(/}\s*\((.*)\)\s*$/);if(!e)return t;let r=e[1].match(/(".+"|\d+)/g);if(r.length<4)return t;let[s,n,o,l]=[r[0].replace(/^"|"$/g,""),parseInt(r[1]),parseInt(r[2]),r[3].replace(/^"|"$/g,"").split("|")],a=c=>(c<n?"":a(parseInt(c/n)))+((c=c%n)>35?String.fromCharCode(c+29):c.toString(36)),i={};for(;o--;)i[a(o)]=l[o]||a(o);return s.replace(/\b\w+\b/g,c=>i[c]||c)}catch(e){return t}}function X(t){return u(this,null,function*(){try{let e=yield g(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!e)return{url:t};let r=yield e.text(),s=r.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||r.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(s){let n=s[1];return n.startsWith("//")&&(n="https:"+n),{url:n,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(e){}return{url:t}})}function Y(t){return u(this,null,function*(){try{let e=yield g(t,{headers:{Referer:"https://vidmoly.to/"}});if(!e)return{url:t};let r=yield e.text();r.includes("eval(function(p,a,c,k,e,d)")&&(r=R(r));let s=r.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(s)return{url:s[1],headers:{Referer:"https://vidmoly.to/"}}}catch(e){}return{url:t}})}function T(t){return u(this,null,function*(){try{let e=yield g(t);if(!e)return{url:t};let r=yield e.text(),s=r.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(s)return T(s[1]);let n=r.match(/'hls'\s*:\s*'([^']+)'/)||r.match(/file\s*:\s*['"]([^'"]+\.m3u8[^'"]*)['"]/);if(n){let o=n[1];return o.includes("base64")&&(o=Q(o.split(",")[1]||o)),{url:o}}}catch(e){}return{url:t}})}function Z(t){return u(this,null,function*(){try{let e=yield g(t);if(!e)return{url:t};let r=yield e.text(),s=r.match(/document\.getElementById\(['"]robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*(?:['"]([^'"]+)['"]|['"]([^'"]+)['"]\.substring\(\d+\))/);if(s){let n=s[1],o=s[2]||"";if(s[3]){let l=r.match(/substring\((\d+)\)/);o=s[3].substring(l?parseInt(l[1]):0)}return{url:"https:"+n+o}}}catch(e){}return{url:t}})}function tt(t){return u(this,null,function*(){var e;try{let r=(e=t.match(/https?:\/\/([^\/]+)/))==null?void 0:e[1],s=yield g(t);if(!s||!r)return{url:t};let n=yield s.text();n.includes("eval(function(p,a,c,k,e,d)")&&(n=R(n));let o=n.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(o){let l=o[1],a=yield fetch(`https://${r}/pass_md5/${l}`,{headers:{Referer:t}});if(a.ok)return{url:(yield a.text())+"z762vpz?token="+l+"&expiry="+Date.now()}}}catch(r){}return{url:t}})}function V(t){return u(this,null,function*(){let e=t.url,r=e.toLowerCase();if(r.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return y(f({},t),{isDirect:!0});try{let s={url:e};if(r.includes("sibnet.ru"))s=yield X(e);else if(r.includes("vidmoly."))s=yield Y(e);else if(r.includes("voe."))s=yield T(e);else if(r.includes("streamtape.com")||r.includes("stape"))s=yield Z(e);else if(r.includes("dood")||r.includes("ds2play"))s=yield tt(e);else{let n=yield g(e);if(n){let o=yield n.text(),l=o.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||o.match(/https?:\/\/[^"']+\.mp4[^"']*/);l&&(s={url:l[0]})}}if(s.url!==e&&s.url.startsWith("http"))return y(f({},t),{url:s.url,isDirect:!0,headers:f(f({},t.headers),s.headers||{}),originalUrl:e})}catch(s){}return y(f({},t),{isDirect:!1})})}var et="https://arm.haglund.dev/api/v2";var rt="https://v3-cinemeta.strem.io";function L(r){return u(this,arguments,function*(t,e={}){try{let s=new AbortController,n=setTimeout(()=>s.abort(),8e3),o=yield fetch(t,y(f({},e),{signal:s.signal}));return clearTimeout(n),o}catch(s){return console.error(`[ArmSync] Fetch failed: ${t}`,s.message),null}})}function I(t,e){return u(this,null,function*(){if(!t)return null;let r=yield L(`${et}/themoviedb?id=${t}`);if(r){let s=yield r.json(),n=Array.isArray(s)?s[0]:s;if(n&&n.imdb)return n.imdb}return null})}function M(t,e,r){return u(this,null,function*(){var a;if(!t||e===0)return null;let s=yield L(`${rt}/meta/series/${t}.json`);if(!s)return null;let n=yield s.json();if(!((a=n==null?void 0:n.meta)!=null&&a.videos))return null;let l=n.meta.videos.filter(i=>i.season>0).sort((i,c)=>i.season-c.season||i.episode-c.episode).findIndex(i=>i.season==e&&i.episode==r);if(l!==-1){let i=l+1;return console.log(`[ArmSync] Resolved: S${e}E${r} -> Absolute ${i}`),i}return null})}var S="https://vostfree.ws";function st(t,e){return u(this,null,function*(){try{let r=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,s=yield x(r),n=b.default.load(s),o=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[Vostfree] TMDB Title found: ${o}`),o}catch(r){return console.error(`[Vostfree] Failed to get title from TMDB: ${r.message}`),null}})}function nt(t){return u(this,null,function*(){try{let e=`do=search&subaction=search&story=${encodeURIComponent(t)}`,r=yield x(`${S}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:S},body:e}),s=b.default.load(r),n=[];s(".title a, .search-result-item a, .movie-title a").each((i,c)=>{let h=s(c).attr("href");h&&(h.includes(".html")||h.includes("/anime/"))&&n.push({title:s(c).text().trim()||s(c).attr("title"),url:h})});let o=i=>i.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),l=o(t);console.log(`[Vostfree] Results found: ${n.length}`);let a=n.find(i=>o(i.title)===l);return a||(a=n.find(i=>o(i.title).includes(l)&&i.title.includes("VOSTFR"))),a||(a=n.find(i=>o(i.title).includes(l))),a||(a=n[0]),a?(console.log(`[Vostfree] Selected: ${a.title} -> ${a.url}`),a.url):null}catch(e){return console.error(`[Vostfree] Search error: ${e.message}`),null}})}function _(t,e,r,s){return u(this,null,function*(){let n=yield st(t,e);if(!n)return[];let o=[s];try{let a=yield I(t,e);if(a){let i=yield M(a,r,s);i&&o.push(i)}}catch(a){console.warn(`[Vostfree] ArmSync failed: ${a.message}`)}let l=yield nt(n);if(!l)return[];try{let a=yield x(l),i=b.default.load(a),c=null;if(i("select.new_player_selector option").each((w,v)=>{let d=i(v).text();for(let A of o){let m=A.toString(),p=m.padStart(2,"0");if(d.includes(`Episode ${m}`)||d.includes(`Episode ${p}`))return c=i(v).val(),!1}}),!c){console.warn(`[Vostfree] Episode ${s} not found in selector on ${l}`);let w=i('div[id^="buttons_"]').first().attr("id");if(w)console.log(`[Vostfree] Falling back to first available buttons: ${w}`),c=w;else return[]}console.log(`[Vostfree] Using buttons ID: ${c}`);let h=[],U=i(`#${c} div[id^="player_"]`).toArray();for(let w of U){let v=i(w).attr("id").replace("player_",""),d=i(w).text().trim()||"Player",A=`content_player_${v}`,m=i(`#${A}`).text().trim();if(m){let p=m;if(p.startsWith("http")||(d.toLowerCase().includes("sibnet")?p=`https://video.sibnet.ru/shell.php?videoid=${m}`:d.toLowerCase().includes("vidmoly")?p=`https://vidmoly.to/embed-${m}.html`:d.toLowerCase().includes("uqload")||d.toLowerCase().includes("oneupload")?p=`https://uqload.com/embed-${m}.html`:d.toLowerCase().includes("sendvid")?p=`https://sendvid.com/embed/${m}`:d.toLowerCase().includes("voe")?p=`https://voe.sx/e/${m}`:d.toLowerCase().includes("dood")?p=`https://dood.to/e/${m}`:(d.toLowerCase().includes("stape")||d.toLowerCase().includes("streamtape"))&&(p=`https://streamtape.com/e/${m}`)),p.startsWith("http")){let j=yield V({name:`Vostfree (${d})`,title:`${d} Player`,url:p,quality:"HD",headers:{Referer:S}});h.push(j)}}}return h}catch(a){return console.error(`[Vostfree] Extraction error: ${a.message}`),[]}})}function ot(t,e,r,s){return u(this,null,function*(){console.log(`[Vostfree] Request: ${e} ${t} S${r}E${s}`);try{return yield _(t,e,r,s)}catch(n){return console.error("[Vostfree] Error:",n),[]}})}
