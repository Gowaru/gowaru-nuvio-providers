/**
 * vostfree - Built from src/vostfree/
 * Generated: 2026-02-25T11:06:33.002Z
 */
var N=Object.create;var x=Object.defineProperty,K=Object.defineProperties,z=Object.getOwnPropertyDescriptor,B=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertyNames,M=Object.getOwnPropertySymbols,O=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var U=(t,e,s)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,d=(t,e)=>{for(var s in e||(e={}))k.call(e,s)&&U(t,s,e[s]);if(M)for(var s of M(e))G.call(e,s)&&U(t,s,e[s]);return t},g=(t,e)=>K(t,B(e));var Q=(t,e)=>{for(var s in e)x(t,s,{get:e[s],enumerable:!0})},C=(t,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of J(e))!k.call(t,r)&&r!==s&&x(t,r,{get:()=>e[r],enumerable:!(n=z(e,r))||n.enumerable});return t};var X=(t,e,s)=>(s=t!=null?N(O(t)):{},C(e||!t||!t.__esModule?x(s,"default",{value:t,enumerable:!0}):s,t)),Y=t=>C(x({},"__esModule",{value:!0}),t);var c=(t,e,s)=>new Promise((n,r)=>{var o=i=>{try{a(s.next(i))}catch(l){r(l)}},f=i=>{try{a(s.throw(i))}catch(l){r(l)}},a=i=>i.done?n(i.value):Promise.resolve(i.value).then(o,f);a((s=s.apply(t,e)).next())});var ht={};Q(ht,{getStreams:()=>dt});module.exports=Y(ht);var Z={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function D(s){return c(this,arguments,function*(t,e={}){console.log(`[Vostfree] Fetching: ${t}`);let n=yield fetch(t,d({headers:d(d({},Z),e.headers)},e));if(!n.ok)throw new Error(`HTTP error ${n.status} for ${t}`);return yield n.text()})}var R=X(require("cheerio"));var tt={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"};function y(s){return c(this,arguments,function*(t,e={}){try{let n=new AbortController,r=setTimeout(()=>n.abort(),12e3),o=yield fetch(t,g(d({},e),{headers:d(d({},tt),e.headers),signal:n.signal}));return clearTimeout(r),o}catch(n){return console.error(`[Resolver] Fetch failed for ${t}: ${n.message}`),null}})}function et(t){return c(this,null,function*(){let e=yield y(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!e)return t;let s=yield e.text(),n=s.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||s.match(/src\s*:\s*"([^"]+\.mp4)"/)||s.match(/player\.setVideo\(\s*\{\s*"url"\s*:\s*"([^"]+)"/);if(n){let r=n[1];return r.startsWith("//")?r=`https:${r}`:r.startsWith("/")&&(r=`https://video.sibnet.ru${r}`),r}return t})}function T(t){return c(this,null,function*(){let e=yield y(t,{headers:{Referer:"https://vidmoly.to/"}});if(!e)return t;let s=yield e.text(),n=s.match(/file\s*:\s*"([^"]+\.m3u8)"/)||s.match(/file\s*:\s*"([^"]+\.mp4)"/)||s.match(/sources\s*:\s*\[\s*\{\s*file\s*:\s*"([^"]+)"/);return n?n[1]:t})}function st(t){return c(this,null,function*(){let e=yield y(t,{headers:{Referer:"https://uqload.com/"}});if(!e)return t;let s=yield e.text(),n=s.match(/sources\s*:\s*\["([^"]+\.(?:mp4|m3u8))"\]/)||s.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/)||s.match(/file\s*:\s*"([^"]+\.(?:mp4|m3u8))"/);return n?n[1]:t})}function nt(t){return c(this,null,function*(){let e=yield y(t);if(!e)return t;let s=yield e.text(),n=s.match(/'hls'\s*:\s*'([^']+)'/)||s.match(/"hls"\s*:\s*"([^"]+)"/)||s.match(/window\.location\.href\s*=\s*'([^']+)'/);if(n){let r=n[1];if(r.includes("base64"))try{let o=r.split(",")[1]||r;typeof atob=="function"&&(r=atob(o))}catch(o){}return r}return t})}function rt(t){return c(this,null,function*(){let e=yield y(t);if(!e)return t;let s=yield e.text(),n=s.match(/sources\s*:\s*\[\s*\{\s*"file"\s*:\s*"([^"]+)"/i)||s.match(/file\s*:\s*"([^"]+)"/i)||s.match(/src\s*:\s*"([^"]+\.m3u8)"/i);return n?n[1]:t})}function ot(t){return c(this,null,function*(){let e=yield y(t);if(!e)return t;let s=yield e.text(),n=s.match(/file\s*:\s*"([^"]+)"/i)||s.match(/source\s*:\s*"([^"]+)"/i)||s.match(/video\s+src="([^"]+)"/i);return n?n[1]:t})}function it(t){return c(this,null,function*(){let e=yield y(t);if(!e)return t;let s=yield e.text(),n=s.match(/file\s*:\s*"([^"]+)"/i)||s.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8|mkv))"/i);return n?n[1]:t})}function at(t){return c(this,null,function*(){let e=yield y(t);if(!e)return t;let s=yield e.text(),n=s.match(/robotlink\.innerHTML\s*=\s*'([^']+)'\s*\+\s*'([^']+)'/);if(n)return`https:${n[1]}${n[2].substring(3)}`;let r=s.match(/id="robotlink">([^<]+)/);return r?`https:${r[1]}`:t})}function ct(t){return c(this,null,function*(){let e=yield y(t);if(!e)return t;let s=yield e.text(),n=s.match(/source\s+src="([^"]+\.mp4)"/i)||s.match(/video_source\s*:\s*"([^"]+)"/);return n?n[1]:t})}function lt(t){return c(this,null,function*(){let e="https://dood.to",s=yield y(t,{headers:{Referer:e}});if(!s)return t;let n=yield s.text(),r=n.match(/\$.get\('\/pass_md5\/([^']+)'/);if(r){let f=`${e}/pass_md5/${r[1]}`,a=yield y(f,{headers:{Referer:t}});if(a)return`${yield a.text()}z72899?token=${r[1]}&expiry=${Date.now()}`}let o=n.match(/window\.open\('([^']+)'\)/);return o?o[1]:t})}function _(t){return c(this,null,function*(){let e=t.url,s=e.toLowerCase();if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return g(d({},t),{isDirect:!0});try{let n=e,r=d({},t.headers);if(s.includes("sibnet.ru")?(n=yield et(e),r.Referer="https://video.sibnet.ru/"):s.includes("vidmoly.")?(n=yield T(e),r.Referer="https://vidmoly.to/"):s.includes("uqload.")?(n=yield st(e),r.Referer="https://uqload.com/"):s.includes("voe.sx")||s.includes("christopheruntilpoint")?n=yield nt(e):s.includes("moonplayer")||s.includes("moonembed")?n=yield rt(e):s.includes("mytv")||s.includes("mycloud")||s.includes("mclls.net")?(n=yield ot(e),r.Referer="https://mycloud.cc/"):s.includes("fhd")||s.includes("fhd1")?n=yield it(e):s.includes("upstream.")?n=yield T(e):s.includes("vido.")||s.includes("vidlo.")?n=yield T(e):s.includes("streamtape.com")?n=yield at(e):s.includes("sendvid.com")?n=yield ct(e):(s.includes("dood")||s.includes("ds2play")||s.includes("viddood"))&&(n=yield lt(e)),n!==e&&n.startsWith("http"))return console.log(`[Resolver] Success: ${e.substring(0,30)}... -> ${n.substring(0,30)}...`),g(d({},t),{url:n,isDirect:!0,headers:r,originalUrl:e})}catch(n){console.error(`[Resolver] Failed for ${e}:`,n)}return g(d({},t),{isDirect:!1})})}var L="https://arm.haglund.dev/api/v2",F="https://api.jikan.moe/v4",ft="https://v3-cinemeta.strem.io";function b(s){return c(this,arguments,function*(t,e={}){try{let n=new AbortController,r=setTimeout(()=>n.abort(),8e3),o=yield fetch(t,g(d({},e),{signal:n.signal}));return clearTimeout(r),o}catch(n){return console.error(`[ArmSync] Fetch failed: ${t}`,n.message),null}})}function I(t,e){return c(this,null,function*(){if(!t)return null;let s=yield b(`${L}/themoviedb?id=${t}`);if(s){let n=yield s.json(),r=Array.isArray(n)?n[0]:n;if(r&&r.imdb)return r.imdb}return null})}function W(t,e,s){return c(this,null,function*(){var a,i,l;if(!t)return null;let n=e===0||e===void 0?"movie":"series",r=yield b(`${ft}/meta/${n}/${t}.json`);if(!r)return null;let o=yield r.json();if(n==="movie")return((i=(a=o==null?void 0:o.meta)==null?void 0:a.released)==null?void 0:i.split("T")[0])||null;if(!((l=o==null?void 0:o.meta)!=null&&l.videos))return null;let f=o.meta.videos.find(m=>m.season==e&&m.episode==s);return f&&f.released?f.released.split("T")[0]:null})}function P(t,e){return c(this,null,function*(){var o,f,a,i;if(!t||!e)return null;let s=yield b(`${L}/imdb?id=${t}`);if(!s)return null;let n=yield s.json();if(!Array.isArray(n))return null;let r=new Date(e);for(let l of n){let m=l.myanimelist;if(!m)continue;let A=yield b(`${F}/anime/${m}`);if(!A)continue;let u=(o=yield A.json())==null?void 0:o.data;if(!u)continue;let v=(f=u.aired)!=null&&f.from?new Date(u.aired.from):null,p=(a=u.aired)!=null&&a.to?new Date(u.aired.to):null;if(v){let $=new Date(v);$.setDate($.getDate()-2);let h=p?new Date(p):new Date;if(h.setDate(h.getDate()+2),r>=$&&r<=h){if(u.type==="Movie"||u.episodes===1)return{malId:m,absoluteEpisode:1,type:u.type};let w=yield b(`${F}/anime/${m}/episodes`);if(w){let S=(i=yield w.json())==null?void 0:i.data;if(Array.isArray(S)){let V=S.find(q=>{if(!q.aired)return!1;let H=new Date(q.aired);return Math.abs(r-H)/(1e3*60*60*24)<=2});if(V)return{malId:m,absoluteEpisode:V.mal_id,title:u.title,animeType:u.type}}}return{malId:m,absoluteEpisode:null,potentialMatch:!0}}}}return null})}var E="https://vostfree.ws";function ut(t,e){return c(this,null,function*(){try{let s=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,n=yield D(s),r=R.default.load(n),o=r('meta[property="og:title"]').attr("content")||r("h1").first().text()||r("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[Vostfree] TMDB Title found: ${o}`),o}catch(s){return console.error(`[Vostfree] Failed to get title from TMDB: ${s.message}`),null}})}function mt(t){return c(this,null,function*(){try{let e=`do=search&subaction=search&story=${encodeURIComponent(t)}`,s=yield D(`${E}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:E},body:e}),n=R.default.load(s),r=[];n(".title a, .search-result-item a, .movie-title a").each((i,l)=>{let m=n(l).attr("href");m&&(m.includes(".html")||m.includes("/anime/"))&&r.push({title:n(l).text().trim()||n(l).attr("title"),url:m})});let o=i=>i.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),f=o(t);console.log(`[Vostfree] Results found: ${r.length}`);let a=r.find(i=>o(i.title)===f);return a||(a=r.find(i=>o(i.title).includes(f)&&i.title.includes("VOSTFR"))),a||(a=r.find(i=>o(i.title).includes(f))),a||(a=r[0]),a?(console.log(`[Vostfree] Selected: ${a.title} -> ${a.url}`),a.url):null}catch(e){return console.error(`[Vostfree] Search error: ${e.message}`),null}})}function j(t,e,s,n){return c(this,null,function*(){let r=yield ut(t,e);if(!r)return[];let o=[n];try{let a=yield I(t,e);if(a){let i=yield W(a,s,n);if(i){let l=yield P(a,i);l&&l.absoluteEpisode&&(console.log(`[Vostfree] ArmSync: S${s}E${n} -> Absolute ${l.absoluteEpisode}`),o.push(l.absoluteEpisode))}}}catch(a){console.warn(`[Vostfree] ArmSync failed: ${a.message}`)}let f=yield mt(r);if(!f)return[];try{let a=yield D(f),i=R.default.load(a),l=null;if(i("select.new_player_selector option").each((u,v)=>{let p=i(v).text();for(let $ of o){let h=$.toString(),w=h.padStart(2,"0");if(p.includes(`Episode ${h}`)||p.includes(`Episode ${w}`))return l=i(v).val(),!1}}),!l){console.warn(`[Vostfree] Episode ${n} not found in selector on ${f}`);let u=i('div[id^="buttons_"]').first().attr("id");if(u)console.log(`[Vostfree] Falling back to first available buttons: ${u}`),l=u;else return[]}console.log(`[Vostfree] Using buttons ID: ${l}`);let m=[],A=i(`#${l} div[id^="player_"]`).toArray();for(let u of A){let v=i(u).attr("id").replace("player_",""),p=i(u).text().trim()||"Player",$=`content_player_${v}`,h=i(`#${$}`).text().trim();if(h){let w=h;if(w.startsWith("http")||(p.toLowerCase().includes("sibnet")?w=`https://video.sibnet.ru/shell.php?videoid=${h}`:p.toLowerCase().includes("vidmoly")?w=`https://vidmoly.to/embed-${h}.html`:p.toLowerCase().includes("uqload")&&(w=`https://uqload.com/embed-${h}.html`)),w.startsWith("http")){let S=yield _({name:`Vostfree (${p})`,title:`${p} Player`,url:w,quality:"HD",headers:{Referer:E}});m.push(S)}}}return m}catch(a){return console.error(`[Vostfree] Extraction error: ${a.message}`),[]}})}function dt(t,e,s,n){return c(this,null,function*(){console.log(`[Vostfree] Request: ${e} ${t} S${s}E${n}`);try{return yield j(t,e,s,n)}catch(r){return console.error("[Vostfree] Error:",r),[]}})}
