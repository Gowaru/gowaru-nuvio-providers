/**
 * vostfree - Built from src/vostfree/
 * Generated: 2026-02-25T17:10:18.160Z
 */
var I=Object.create;var v=Object.defineProperty,j=Object.defineProperties,F=Object.getOwnPropertyDescriptor,W=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertyNames,E=Object.getOwnPropertySymbols,N=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var k=(t,e,s)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,d=(t,e)=>{for(var s in e||(e={}))C.call(e,s)&&k(t,s,e[s]);if(E)for(var s of E(e))H.call(e,s)&&k(t,s,e[s]);return t},g=(t,e)=>j(t,W(e));var B=(t,e)=>{for(var s in e)v(t,s,{get:e[s],enumerable:!0})},T=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of P(e))!C.call(t,n)&&n!==s&&v(t,n,{get:()=>e[n],enumerable:!(r=F(e,n))||r.enumerable});return t};var K=(t,e,s)=>(s=t!=null?I(N(t)):{},T(e||!t||!t.__esModule?v(s,"default",{value:t,enumerable:!0}):s,t)),J=t=>T(v({},"__esModule",{value:!0}),t);var f=(t,e,s)=>new Promise((r,n)=>{var o=a=>{try{i(s.next(a))}catch(c){n(c)}},l=a=>{try{i(s.throw(a))}catch(c){n(c)}},i=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,l);i((s=s.apply(t,e)).next())});var ct={};B(ct,{getStreams:()=>it});module.exports=J(ct);var O={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function b(s){return f(this,arguments,function*(t,e={}){console.log(`[Vostfree] Fetching: ${t}`);let r=yield fetch(t,d({headers:d(d({},O),e.headers)},e));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var S=K(require("cheerio"));var z={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"},G=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(e){return t}};function w(s){return f(this,arguments,function*(t,e={}){try{let r=yield fetch(t,g(d({},e),{headers:d(d({},z),e.headers),redirect:"follow"}));if(!r.ok)return null;let n=yield r.text();return{text:()=>Promise.resolve(n),ok:!0,url:r.url,headers:r.headers}}catch(r){return null}})}function M(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let e=t.match(/}\s*\((.*)\)\s*$/);if(!e)return t;let s=e[1].match(/(".+"|\d+)/g);if(s.length<4)return t;let[r,n,o,l]=[s[0].replace(/^"|"$/g,""),parseInt(s[1]),parseInt(s[2]),s[3].replace(/^"|"$/g,"").split("|")],i=c=>(c<n?"":i(parseInt(c/n)))+((c=c%n)>35?String.fromCharCode(c+29):c.toString(36)),a={};for(;o--;)a[i(o)]=l[o]||i(o);return r.replace(/\b\w+\b/g,c=>a[c]||c)}catch(e){return t}}function Q(t){return f(this,null,function*(){try{let e=yield w(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!e)return{url:t};let s=yield e.text(),r=s.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||s.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let n=r[1];return n.startsWith("//")&&(n="https:"+n),{url:n,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(e){}return{url:t}})}function X(t){return f(this,null,function*(){try{let e=yield w(t,{headers:{Referer:"https://vidmoly.to/"}});if(!e)return{url:t};let s=yield e.text();s.includes("eval(function(p,a,c,k,e,d)")&&(s=M(s));let r=s.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(e){}return{url:t}})}function Y(t){return f(this,null,function*(){try{let e=yield w(t,{headers:{Referer:"https://uqload.com/"}});if(!e)return{url:t};let s=yield e.text(),r=s.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||s.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(r)return{url:r[1],headers:{Referer:"https://uqload.com/"}}}catch(e){}return{url:t}})}function Z(t){return f(this,null,function*(){try{let e=yield w(t);if(!e)return{url:t};let s=yield e.text(),r=s.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r){let o=yield w(r[1]);o&&(s=yield o.text())}let n=s.match(/'hls'\s*:\s*'([^']+)'/)||s.match(/"hls"\s*:\s*"([^"]+)"/)||s.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(n){let o=n[1]||n[0];return o.includes("base64")&&(o=G(o.split(",")[1]||o)),{url:o}}}catch(e){}return{url:t}})}function tt(t){return f(this,null,function*(){try{let e=yield w(t);if(!e)return{url:t};let r=(yield e.text()).match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(r){let n="https:"+r[1],o=r[2].split("+");for(let l of o){let i=l.match(/['"]([^'"]+)['"]/);if(i){let a=i[1],c=l.match(/substring\((\d+)\)/);c&&(a=a.substring(parseInt(c[1]))),n+=a}}return{url:n}}}catch(e){}return{url:t}})}function et(t){return f(this,null,function*(){var e;try{let s=((e=t.match(/https?:\/\/([^\/]+)/))==null?void 0:e[1])||"dood.to",r=yield w(t);if(!r)return{url:t};let n=yield r.text();n.includes("eval(function(p,a,c,k,e,d)")&&(n=M(n));let o=n.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(o){let l=o[1],i=`https://${s}/pass_md5/${l}`,a=yield fetch(i,{headers:{Referer:t}});if(a.ok){let c=yield a.text(),u=Math.random().toString(36).substring(2,12);return{url:c+u+"?token="+l+"&expiry="+Date.now()}}}}catch(s){}return{url:t}})}function st(t){return f(this,null,function*(){try{let e=yield w(t);if(!e)return{url:t};let r=(yield e.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(r)return{url:r[1]}}catch(e){}return{url:t}})}function V(t){return f(this,null,function*(){let e=t.url,s=e.toLowerCase();if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return g(d({},t),{isDirect:!0});try{let r=null;if(s.includes("sibnet.ru"))r=yield Q(e);else if(s.includes("vidmoly."))r=yield X(e);else if(s.includes("uqload.")||s.includes("oneupload."))r=yield Y(e);else if(s.includes("voe."))r=yield Z(e);else if(s.includes("streamtape.com")||s.includes("stape"))r=yield tt(e);else if(s.includes("dood")||s.includes("ds2play"))r=yield et(e);else if(s.includes("moonplayer")||s.includes("moon."))r=yield st(e);else{let n=yield w(e);if(n){let o=yield n.text(),l=o.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||o.match(/https?:\/\/[^"']+\.mp4[^"']*/);l&&(r={url:l[0]})}}if(r&&r.url!==e&&r.url.startsWith("http"))return g(d({},t),{url:r.url,isDirect:!0,headers:d(d({},t.headers),r.headers||{}),originalUrl:e})}catch(r){}return g(d({},t),{isDirect:!1})})}var rt="https://arm.haglund.dev/api/v2";var nt="https://v3-cinemeta.strem.io";function R(s){return f(this,arguments,function*(t,e={}){try{let r=new AbortController,n=setTimeout(()=>r.abort(),8e3),o=yield fetch(t,g(d({},e),{signal:r.signal}));return clearTimeout(n),o}catch(r){return console.error(`[ArmSync] Fetch failed: ${t}`,r.message),null}})}function L(t,e){return f(this,null,function*(){if(!t)return null;let s=yield R(`${rt}/themoviedb?id=${t}`);if(s)try{let o=yield s.json(),l=Array.isArray(o)?o[0]:o;if(l&&l.imdb)return l.imdb}catch(o){}let r=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}`,n=yield R(r);if(n){let l=(yield n.text()).match(/imdb\.com\/title\/(tt\d+)/);if(l)return l[1]}return null})}function U(t,e,s){return f(this,null,function*(){var c;if(!t||e===0)return null;let r=yield R(`${nt}/meta/series/${t}.json`);if(!r)return null;let n=yield r.json();if(!((c=n==null?void 0:n.meta)!=null&&c.videos))return null;let o=n.meta.videos.filter(u=>u.season>0&&u.episode>0).sort((u,y)=>u.season-y.season||u.episode-y.episode),l=[],i=new Set;for(let u of o){let y=`${u.season}-${u.episode}`;i.has(y)||(i.add(y),l.push(u))}let a=l.findIndex(u=>u.season==e&&u.episode==s);if(a!==-1){let u=a+1;return console.log(`[ArmSync] Resolved: S${e}E${s} -> Absolute ${u}`),u}return null})}var D="https://vostfree.ws";function ot(t,e){return f(this,null,function*(){try{let s=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,r=yield b(s),n=S.default.load(r),o=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[Vostfree] TMDB Title found: ${o}`),o}catch(s){return console.error(`[Vostfree] Failed to get title from TMDB: ${s.message}`),null}})}function at(t){return f(this,null,function*(){try{let e=`do=search&subaction=search&story=${encodeURIComponent(t)}`,s=yield b(`${D}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:D},body:e}),r=S.default.load(s),n=[];r(".title a, .search-result-item a, .movie-title a").each((a,c)=>{let u=r(c).attr("href");u&&(u.includes(".html")||u.includes("/anime/"))&&n.push({title:r(c).text().trim()||r(c).attr("title"),url:u})});let o=a=>a.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),l=o(t);console.log(`[Vostfree] Results found: ${n.length}`);let i=n.find(a=>o(a.title)===l);return i||(i=n.find(a=>o(a.title).includes(l)&&a.title.includes("VOSTFR"))),i||(i=n.find(a=>o(a.title).includes(l))),i||(i=n[0]),i?(console.log(`[Vostfree] Selected: ${i.title} -> ${i.url}`),i.url):null}catch(e){return console.error(`[Vostfree] Search error: ${e.message}`),null}})}function q(t,e,s,r){return f(this,null,function*(){let n=yield ot(t,e);if(!n)return[];let o=[r];try{let i=yield L(t,e);if(i){let a=yield U(i,s,r);a&&o.push(a)}}catch(i){console.warn(`[Vostfree] ArmSync failed: ${i.message}`)}let l=yield at(n);if(!l)return[];try{let i=yield b(l),a=S.default.load(i),c=null;if(a("select.new_player_selector option").each(($,x)=>{let m=a(x).text();for(let A of o){let h=A.toString(),p=h.padStart(2,"0");if(m.includes(`Episode ${h}`)||m.includes(`Episode ${p}`))return c=a(x).val(),!1}}),!c){console.warn(`[Vostfree] Episode ${r} not found in selector on ${l}`);let $=a('div[id^="buttons_"]').first().attr("id");if($)console.log(`[Vostfree] Falling back to first available buttons: ${$}`),c=$;else return[]}console.log(`[Vostfree] Using buttons ID: ${c}`);let u=[],y=a(`#${c} div[id^="player_"]`).toArray();for(let $ of y){let x=a($).attr("id").replace("player_",""),m=a($).text().trim()||"Player",A=`content_player_${x}`,h=a(`#${A}`).text().trim();if(h){let p=h;if(p.startsWith("http")||(m.toLowerCase().includes("sibnet")?p=`https://video.sibnet.ru/shell.php?videoid=${h}`:m.toLowerCase().includes("vidmoly")?p=`https://vidmoly.to/embed-${h}.html`:m.toLowerCase().includes("uqload")||m.toLowerCase().includes("oneupload")?p=`https://uqload.com/embed-${h}.html`:m.toLowerCase().includes("sendvid")?p=`https://sendvid.com/embed/${h}`:m.toLowerCase().includes("voe")?p=`https://voe.sx/e/${h}`:m.toLowerCase().includes("dood")?p=`https://dood.to/e/${h}`:(m.toLowerCase().includes("stape")||m.toLowerCase().includes("streamtape"))&&(p=`https://streamtape.com/e/${h}`)),p.startsWith("http")){let _=yield V({name:`Vostfree (${m})`,title:`${m} Player`,url:p,quality:"HD",headers:{Referer:D}});u.push(_)}}}return u}catch(i){return console.error(`[Vostfree] Extraction error: ${i.message}`),[]}})}function it(t,e,s,r){return f(this,null,function*(){console.log(`[Vostfree] Request: ${e} ${t} S${s}E${r}`);try{return yield q(t,e,s,r)}catch(n){return console.error("[Vostfree] Error:",n),[]}})}
