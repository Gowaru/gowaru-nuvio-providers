/**
 * vostfree - Built from src/vostfree/
 * Generated: 2026-02-25T15:40:09.566Z
 */
var W=Object.create;var x=Object.defineProperty,I=Object.defineProperties,j=Object.getOwnPropertyDescriptor,F=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,H=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var D=(t,e,s)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,u=(t,e)=>{for(var s in e||(e={}))E.call(e,s)&&D(t,s,e[s]);if(R)for(var s of R(e))N.call(e,s)&&D(t,s,e[s]);return t},h=(t,e)=>I(t,F(e));var z=(t,e)=>{for(var s in e)x(t,s,{get:e[s],enumerable:!0})},T=(t,e,s,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of P(e))!E.call(t,n)&&n!==s&&x(t,n,{get:()=>e[n],enumerable:!(o=j(e,n))||o.enumerable});return t};var B=(t,e,s)=>(s=t!=null?W(H(t)):{},T(e||!t||!t.__esModule?x(s,"default",{value:t,enumerable:!0}):s,t)),K=t=>T(x({},"__esModule",{value:!0}),t);var l=(t,e,s)=>new Promise((o,n)=>{var i=r=>{try{a(s.next(r))}catch(m){n(m)}},c=r=>{try{a(s.throw(r))}catch(m){n(m)}},a=r=>r.done?o(r.value):Promise.resolve(r.value).then(i,c);a((s=s.apply(t,e)).next())});var ct={};z(ct,{getStreams:()=>at});module.exports=K(ct);var J={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function g(s){return l(this,arguments,function*(t,e={}){console.log(`[Vostfree] Fetching: ${t}`);let o=yield fetch(t,u({headers:u(u({},J),e.headers)},e));if(!o.ok)throw new Error(`HTTP error ${o.status} for ${t}`);return yield o.text()})}var b=B(require("cheerio"));var C={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"};function w(s){return l(this,arguments,function*(t,e={}){try{let o=yield fetch(t,h(u({},e),{headers:u(u({},C),e.headers),redirect:"follow"}));if(!o.ok)return null;let n=yield o.text(),i=n.match(/window\.location\.(?:replace|href)\s*\(['"]([^'"]+)['"]\)/i);if(i){let c=i[1];c.startsWith("/")&&(c=t.match(/https?:\/\/[^\/]+/)[0]+c);let a=yield fetch(c,h(u({},e),{headers:u(h(u({},C),{Referer:t}),e.headers)}));if(a.ok){let r=yield a.text();return{text:()=>Promise.resolve(r),ok:!0,url:a.url}}}return{text:()=>Promise.resolve(n),ok:!0,url:o.url}}catch(o){return null}})}function O(t){return l(this,null,function*(){let e=yield w(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!e)return t;let s=yield e.text(),o=s.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||s.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||s.match(/video_url\s*:\s*'([^']+)'/);if(o){let n=o[1];return n.startsWith("//")?n="https:"+n:n.startsWith("/")&&(n="https://video.sibnet.ru"+n),n}return t})}function G(t){return l(this,null,function*(){let e=yield w(t,{headers:{Referer:"https://vidmoly.to/"}});if(!e)return t;let s=yield e.text(),o=s.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/)||s.match(/sources\s*:\s*\[\s*\{\s*file\s*:\s*["']([^"']+)["']/)||s.match(/["']?file["']?\s*:\s*["']([^"']+)["']/);return o?o[1]:t})}function Q(t){return l(this,null,function*(){let e=yield w(t,{headers:{Referer:"https://uqload.com/"}});if(!e)return t;let s=yield e.text(),o=s.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||s.match(/src\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/)||s.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);return o?o[1]:t})}function X(t){return l(this,null,function*(){let e=yield w(t);if(!e)return t;let s=yield e.text(),o=s.match(/'hls'\s*:\s*'([^']+)'/)||s.match(/"hls"\s*:\s*"([^"]+)"/);if(o){let i=o[1];if(i.includes("base64"))try{let c=i.split(",")[1]||i;i=atob(c)}catch(c){}return i}let n=s.match(/https?:\/\/[^"']+\.m3u8[^"']*/);return n?n[0]:t})}function Y(t){return l(this,null,function*(){let e=yield w(t);if(!e)return t;let s=yield e.text(),o=s.match(/document\.getElementById\(['"]robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*(?:['"]([^'"]+)['"]|(\w+))/);if(o){let i=o[1],c=o[2]||"";return"https:"+i+c}let n=s.match(/id=['"]robotlink['"]>([^<]+)/);return n?"https:"+n[1]:t})}function Z(t){return l(this,null,function*(){try{let e=t.match(/https?:\/\/([^\/]+)/)[1],s=yield w(t);if(!s)return t;let n=(yield s.text()).match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(n){let i=`https://${e}/pass_md5/${n[1]}`,c=yield fetch(i,{headers:{Referer:t}});if(c.ok)return(yield c.text())+"z762vpz?token="+n[1]+"&expiry="+Date.now()}}catch(e){}return t})}function tt(t){return l(this,null,function*(){let e=yield w(t);if(!e)return t;let s=yield e.text(),o=s.match(/source\s*src=['"]([^'"]+\.mp4)['"]/)||s.match(/content=['"]([^'"]+\.mp4)['"]/);return o?o[1]:t})}function et(t){return l(this,null,function*(){let e=yield w(t);if(!e)return t;let s=yield e.text(),o=s.match(/vurl=["']([^"']+)["']/)||s.match(/file\s*:\s*["']([^"']+)["']/);if(o){let n=o[1];return n.startsWith("//")&&(n="https:"+n),n}return t})}function st(t){return l(this,null,function*(){let e=yield w(t);if(!e)return t;let o=(yield e.text()).match(/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/);return o?o[1]:t})}function k(t){return l(this,null,function*(){let e=t.url,s=e.toLowerCase();if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return h(u({},t),{isDirect:!0});try{let o=e,n=u({},t.headers);if(s.includes("sibnet.ru")?(o=yield O(e),n.Referer="https://video.sibnet.ru/"):s.includes("vidmoly.")?(o=yield G(e),n.Referer="https://vidmoly.to/"):s.includes("uqload.")||s.includes("oneupload.")?(o=yield Q(e),n.Referer="https://uqload.com/"):s.includes("voe.")?o=yield X(e):s.includes("streamtape.com")||s.includes("stape")?o=yield Y(e):s.includes("dood")||s.includes("ds2play")?o=yield Z(e):s.includes("sendvid.com")?o=yield tt(e):s.includes("myvi.")||s.includes("mytv")?o=yield et(e):(s.includes("moonplayer")||s.includes("moon."))&&(o=yield st(e)),o!==e&&o.startsWith("http"))return h(u({},t),{url:o,isDirect:!0,headers:n})}catch(o){}return h(u({},t),{isDirect:!1})})}var ot="https://arm.haglund.dev/api/v2";var nt="https://v3-cinemeta.strem.io";function M(s){return l(this,arguments,function*(t,e={}){try{let o=new AbortController,n=setTimeout(()=>o.abort(),8e3),i=yield fetch(t,h(u({},e),{signal:o.signal}));return clearTimeout(n),i}catch(o){return console.error(`[ArmSync] Fetch failed: ${t}`,o.message),null}})}function V(t,e){return l(this,null,function*(){if(!t)return null;let s=yield M(`${ot}/themoviedb?id=${t}`);if(s){let o=yield s.json(),n=Array.isArray(o)?o[0]:o;if(n&&n.imdb)return n.imdb}return null})}function q(t,e,s){return l(this,null,function*(){var a;if(!t||e===0)return null;let o=yield M(`${nt}/meta/series/${t}.json`);if(!o)return null;let n=yield o.json();if(!((a=n==null?void 0:n.meta)!=null&&a.videos))return null;let c=n.meta.videos.filter(r=>r.season>0).sort((r,m)=>r.season-m.season||r.episode-m.episode).findIndex(r=>r.season==e&&r.episode==s);if(c!==-1){let r=c+1;return console.log(`[ArmSync] Resolved: S${e}E${s} -> Absolute ${r}`),r}return null})}var S="https://vostfree.ws";function rt(t,e){return l(this,null,function*(){try{let s=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,o=yield g(s),n=b.default.load(o),i=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();return i&&i.includes(" (")&&(i=i.split(" (")[0]),i&&i.includes(" - ")&&(i=i.split(" - ")[0]),i=i?i.trim():null,console.log(`[Vostfree] TMDB Title found: ${i}`),i}catch(s){return console.error(`[Vostfree] Failed to get title from TMDB: ${s.message}`),null}})}function it(t){return l(this,null,function*(){try{let e=`do=search&subaction=search&story=${encodeURIComponent(t)}`,s=yield g(`${S}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:S},body:e}),o=b.default.load(s),n=[];o(".title a, .search-result-item a, .movie-title a").each((r,m)=>{let y=o(m).attr("href");y&&(y.includes(".html")||y.includes("/anime/"))&&n.push({title:o(m).text().trim()||o(m).attr("title"),url:y})});let i=r=>r.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),c=i(t);console.log(`[Vostfree] Results found: ${n.length}`);let a=n.find(r=>i(r.title)===c);return a||(a=n.find(r=>i(r.title).includes(c)&&r.title.includes("VOSTFR"))),a||(a=n.find(r=>i(r.title).includes(c))),a||(a=n[0]),a?(console.log(`[Vostfree] Selected: ${a.title} -> ${a.url}`),a.url):null}catch(e){return console.error(`[Vostfree] Search error: ${e.message}`),null}})}function L(t,e,s,o){return l(this,null,function*(){let n=yield rt(t,e);if(!n)return[];let i=[o];try{let a=yield V(t,e);if(a){let r=yield q(a,s,o);r&&i.push(r)}}catch(a){console.warn(`[Vostfree] ArmSync failed: ${a.message}`)}let c=yield it(n);if(!c)return[];try{let a=yield g(c),r=b.default.load(a),m=null;if(r("select.new_player_selector option").each((v,$)=>{let f=r($).text();for(let A of i){let d=A.toString(),p=d.padStart(2,"0");if(f.includes(`Episode ${d}`)||f.includes(`Episode ${p}`))return m=r($).val(),!1}}),!m){console.warn(`[Vostfree] Episode ${o} not found in selector on ${c}`);let v=r('div[id^="buttons_"]').first().attr("id");if(v)console.log(`[Vostfree] Falling back to first available buttons: ${v}`),m=v;else return[]}console.log(`[Vostfree] Using buttons ID: ${m}`);let y=[],U=r(`#${m} div[id^="player_"]`).toArray();for(let v of U){let $=r(v).attr("id").replace("player_",""),f=r(v).text().trim()||"Player",A=`content_player_${$}`,d=r(`#${A}`).text().trim();if(d){let p=d;if(p.startsWith("http")||(f.toLowerCase().includes("sibnet")?p=`https://video.sibnet.ru/shell.php?videoid=${d}`:f.toLowerCase().includes("vidmoly")?p=`https://vidmoly.to/embed-${d}.html`:f.toLowerCase().includes("uqload")||f.toLowerCase().includes("oneupload")?p=`https://uqload.com/embed-${d}.html`:f.toLowerCase().includes("sendvid")?p=`https://sendvid.com/embed/${d}`:f.toLowerCase().includes("voe")?p=`https://voe.sx/e/${d}`:f.toLowerCase().includes("dood")?p=`https://dood.to/e/${d}`:(f.toLowerCase().includes("stape")||f.toLowerCase().includes("streamtape"))&&(p=`https://streamtape.com/e/${d}`)),p.startsWith("http")){let _=yield k({name:`Vostfree (${f})`,title:`${f} Player`,url:p,quality:"HD",headers:{Referer:S}});y.push(_)}}}return y}catch(a){return console.error(`[Vostfree] Extraction error: ${a.message}`),[]}})}function at(t,e,s,o){return l(this,null,function*(){console.log(`[Vostfree] Request: ${e} ${t} S${s}E${o}`);try{return yield L(t,e,s,o)}catch(n){return console.error("[Vostfree] Error:",n),[]}})}
