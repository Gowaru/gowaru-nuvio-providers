/**
 * vostfree - Built from src/vostfree/
 * Generated: 2026-02-25T18:32:18.251Z
 */
var P=Object.create;var v=Object.defineProperty,H=Object.defineProperties,B=Object.getOwnPropertyDescriptor,K=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertyNames,L=Object.getOwnPropertySymbols,J=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var V=(t,s,e)=>s in t?v(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,d=(t,s)=>{for(var e in s||(s={}))_.call(s,e)&&V(t,e,s[e]);if(L)for(var e of L(s))z.call(s,e)&&V(t,e,s[e]);return t},g=(t,s)=>H(t,K(s));var G=(t,s)=>{for(var e in s)v(t,e,{get:s[e],enumerable:!0})},q=(t,s,e,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of O(s))!_.call(t,o)&&o!==e&&v(t,o,{get:()=>s[o],enumerable:!(r=B(s,o))||r.enumerable});return t};var Q=(t,s,e)=>(e=t!=null?P(J(t)):{},q(s||!t||!t.__esModule?v(e,"default",{value:t,enumerable:!0}):e,t)),X=t=>q(v({},"__esModule",{value:!0}),t);var f=(t,s,e)=>new Promise((r,o)=>{var n=c=>{try{u(e.next(c))}catch(a){o(a)}},l=c=>{try{u(e.throw(c))}catch(a){o(a)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(n,l);u((e=e.apply(t,s)).next())});var wt={};G(wt,{getStreams:()=>pt});module.exports=X(wt);var Y={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function A(e){return f(this,arguments,function*(t,s={}){console.log(`[Vostfree] Fetching: ${t}`);let r=yield fetch(t,d({headers:d(d({},Y),s.headers)},s));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var k=Q(require("cheerio"));var Z={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"},I=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(s){return t}};function y(e){return f(this,arguments,function*(t,s={}){try{let r=yield fetch(t,g(d({},s),{headers:d(d({},Z),s.headers),redirect:"follow"}));if(!r.ok)return null;let o=yield r.text();return{text:()=>Promise.resolve(o),ok:!0,url:r.url,headers:r.headers}}catch(r){return null}})}function x(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let s=t.match(/}\s*\((.*)\)\s*$/);if(!s)return t;let e=s[1].match(/(".+"|\d+)/g);if(e.length<4)return t;let[r,o,n,l]=[e[0].replace(/^"|"$/g,""),parseInt(e[1]),parseInt(e[2]),e[3].replace(/^"|"$/g,"").split("|")],u=a=>(a<o?"":u(parseInt(a/o)))+((a=a%o)>35?String.fromCharCode(a+29):a.toString(36)),c={};for(;n--;)c[u(n)]=l[n]||u(n);return r.replace(/\b\w+\b/g,a=>c[a]||a)}catch(s){return t}}function tt(t){return f(this,null,function*(){try{let s=yield y(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!s)return{url:t};let e=yield s.text(),r=e.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||e.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let o=r[1];return o.startsWith("//")&&(o="https:"+o),{url:o,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(s){}return{url:t}})}function et(t){return f(this,null,function*(){try{let s=yield y(t,{headers:{Referer:"https://vidmoly.to/"}});if(!s)return{url:t};let e=yield s.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=x(e));let r=e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(s){}return{url:t}})}function st(t){return f(this,null,function*(){try{let s=yield y(t,{headers:{Referer:"https://uqload.com/"}});if(!s)return{url:t};let e=yield s.text(),r=e.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(r)return{url:r[1],headers:{Referer:"https://uqload.com/"}}}catch(s){}return{url:t}})}function rt(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let e=yield s.text(),r=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r){let n=yield y(r[1]);n&&(e=yield n.text())}let o=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(o){let n=o[1]||o[0];return n.includes("base64")&&(n=I(n.split(",")[1]||n)),{url:n}}}catch(s){}return{url:t}})}function nt(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=x(e));let r=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(r){let o="https:"+r[1],n=r[2].split("+");for(let l of n){let u=l.match(/['"]([^'"]+)['"]/);if(u){let c=u[1],a=l.match(/substring\((\d+)\)/);a&&(c=c.substring(parseInt(a[1]))),o+=c}}return{url:o,headers:{Referer:"https://streamtape.com/"}}}}catch(s){}return{url:t}})}function ot(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let e=yield s.text(),r=e.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.mp4[^"']*)["']/);if(r)return{url:r[1]}}catch(s){}return{url:t}})}function at(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=x(e));let r=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r){let o=r[1];return o.includes("base64")&&(o=I(o.split(",")[1]||o)),{url:o}}}catch(s){}return{url:t}})}function it(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let r=(yield s.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(r)return{url:r[1]}}catch(s){}return{url:t}})}function ct(t){return f(this,null,function*(){var s;try{let e=((s=t.match(/https?:\/\/([^\/]+)/))==null?void 0:s[1])||"dood.to",r=yield y(t);if(!r)return{url:t};let o=yield r.text();o.includes("eval(function(p,a,c,k,e,d)")&&(o=x(o));let n=o.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(n){let l=n[1],u=`https://${e}/pass_md5/${l}`,c=yield fetch(u,{headers:{Referer:t}});if(c.ok){let a=yield c.text(),i=Math.random().toString(36).substring(2,12);return{url:a+i+"?token="+l+"&expiry="+Date.now()}}}}catch(e){}return{url:t}})}function lt(t){return f(this,null,function*(){try{let s=yield y(t);if(!s)return{url:t};let r=(yield s.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(r)return{url:r[1]}}catch(s){}return{url:t}})}function R(t,s=0){return f(this,null,function*(){var o;if(s>3)return g(d({},t),{isDirect:!1});let e=t.url,r=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(r.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!r.includes("html"))return g(d({},t),{isDirect:!0});try{let n=null;if(r.includes("sibnet.ru")?n=yield tt(e):r.includes("vidmoly.")?n=yield et(e):r.includes("uqload.")||r.includes("oneupload.")?n=yield st(e):r.includes("voe.")?n=yield rt(e):r.includes("streamtape.com")||r.includes("stape")?n=yield nt(e):r.includes("dood")||r.includes("ds2play")?n=yield ct(e):r.includes("moonplayer")||r.includes("moon.")?n=yield lt(e):r.includes("sendvid.")?n=yield ot(e):r.includes("luluvid.")||r.includes("lulu.")?n=yield at(e):(r.includes("hgcloud.")||r.includes("savefiles."))&&(n=yield it(e)),!n||n.url===e){let l=yield y(e,{headers:t.headers});if(l){let u=yield l.text();u.includes("p,a,c,k,e,d")&&(u=x(u));let c=u.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||u.match(/https?:\/\/[^"']+\.mp4[^"']*/)||u.match(/file\s*:\s*["']([^"']+)["']/);if(c){let a=c[1]||c[0];a.startsWith("//")&&(a="https:"+a),a.startsWith("http")&&!a.includes(ut)&&(n={url:a})}if(!n){let a=u.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(a){let i=a[1];if(i.startsWith("//")&&(i="https:"+i),i.startsWith("/")){let m=(o=e.match(/^https?:\/\/[^\/]+/))==null?void 0:o[0];m&&(i=m+i)}if(i.startsWith("http")&&i!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${i}`),yield R(g(d({},t),{url:i}),s+1)}}}}if(n&&n.url!==e&&n.url.startsWith("http")){let l=yield R(g(d({},t),{url:n.url,headers:d(d({},t.headers),n.headers||{})}),s+1);return g(d({},l),{isDirect:!0,originalUrl:e})}}catch(n){}return g(d({},t),{isDirect:!1})})}var ut="googletagmanager";var ft="https://arm.haglund.dev/api/v2";var dt="https://v3-cinemeta.strem.io";function T(e){return f(this,arguments,function*(t,s={}){try{let r=new AbortController,o=setTimeout(()=>r.abort(),8e3),n=yield fetch(t,g(d({},s),{signal:r.signal}));return clearTimeout(o),n}catch(r){return console.error(`[ArmSync] Fetch failed: ${t}`,r.message),null}})}function W(t,s){return f(this,null,function*(){if(!t)return null;let e=yield T(`${ft}/themoviedb?id=${t}`);if(e)try{let n=yield e.json(),l=Array.isArray(n)?n[0]:n;if(l&&l.imdb)return l.imdb}catch(n){}let r=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}`,o=yield T(r);if(o){let l=(yield o.text()).match(/imdb\.com\/title\/(tt\d+)/);if(l)return l[1]}return null})}function F(t,s,e){return f(this,null,function*(){var a;if(!t||s===0)return null;let r=yield T(`${dt}/meta/series/${t}.json`);if(!r)return null;let o=yield r.json();if(!((a=o==null?void 0:o.meta)!=null&&a.videos))return null;let n=o.meta.videos.filter(i=>i.season>0&&i.episode>0).sort((i,m)=>i.season-m.season||i.episode-m.episode),l=[],u=new Set;for(let i of n){let m=`${i.season}-${i.episode}`;u.has(m)||(u.add(m),l.push(i))}let c=l.findIndex(i=>i.season==s&&i.episode==e);if(c!==-1){let i=c+1;return console.log(`[ArmSync] Resolved: S${s}E${e} -> Absolute ${i}`),i}return null})}var U="https://vostfree.ws";function ht(t,s){return f(this,null,function*(){try{let e=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}?language=en-US`,r=yield A(e),o=k.default.load(r),n=o('meta[property="og:title"]').attr("content")||o("h1").first().text()||o("h2").first().text();return n&&n.includes(" (")&&(n=n.split(" (")[0]),n&&n.includes(" - ")&&(n=n.split(" - ")[0]),n=n?n.trim():null,console.log(`[Vostfree] TMDB Title found: ${n}`),n}catch(e){return console.error(`[Vostfree] Failed to get title from TMDB: ${e.message}`),null}})}function mt(t){return f(this,null,function*(){try{let s=`do=search&subaction=search&story=${encodeURIComponent(t)}`,e=yield A(`${U}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:U},body:s}),r=k.default.load(e),o=[];r(".title a, .search-result-item a, .movie-title a").each((c,a)=>{let i=r(a).attr("href");i&&(i.includes(".html")||i.includes("/anime/"))&&o.push({title:r(a).text().trim()||r(a).attr("title"),url:i})});let n=c=>c.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),l=n(t);console.log(`[Vostfree] Results found: ${o.length}`);let u=o.filter(c=>n(c.title).includes(l));return u.length>0&&console.log(`[Vostfree] Found ${u.length} matches for ${t}`),u}catch(s){return console.error(`[Vostfree] Search error: ${s.message}`),[]}})}function j(t,s,e,r){return f(this,null,function*(){let o=yield ht(t,s);if(!o)return[];let n=[r];try{let a=yield W(t,s);if(a){let i=yield F(a,e,r);i&&n.push(i)}}catch(a){console.warn(`[Vostfree] ArmSync failed: ${a.message}`)}let l=yield mt(o);if(!l||l.length===0)return[];let u=[],c=new Set;for(let a of l){if(c.has(a.url))continue;c.add(a.url);let i=a.url,m=a.title.toUpperCase().includes(" VF")||a.url.includes("/vf/")?"VF":"VOSTFR";try{let D=yield A(i),$=k.default.load(D),b=null;if($("select.new_player_selector option").each((E,S)=>{let h=$(S).text();for(let C of n){let p=C.toString(),w=p.padStart(2,"0");if(h.includes(`Episode ${p}`)||h.includes(`Episode ${w}`))return b=$(S).val(),!1}}),!b){console.warn(`[Vostfree] Episode ${r} not found in selector on ${i}`);continue}console.log(`[Vostfree] Using buttons ID: ${b} for ${m}`);let N=$(`#${b} div[id^="player_"]`).toArray();for(let E of N){let S=$(E).attr("id").replace("player_",""),h=$(E).text().trim()||"Player",C=`content_player_${S}`,p=$(`#${C}`).text().trim();if(p){let w=p;if(w.startsWith("http")||(h.toLowerCase().includes("sibnet")?w=`https://video.sibnet.ru/shell.php?videoid=${p}`:h.toLowerCase().includes("vidmoly")?w=`https://vidmoly.to/embed-${p}.html`:h.toLowerCase().includes("uqload")||h.toLowerCase().includes("oneupload")?w=`https://uqload.com/embed-${p}.html`:h.toLowerCase().includes("sendvid")?w=`https://sendvid.com/embed/${p}`:h.toLowerCase().includes("voe")?w=`https://voe.sx/e/${p}`:h.toLowerCase().includes("dood")?w=`https://dood.to/e/${p}`:(h.toLowerCase().includes("stape")||h.toLowerCase().includes("streamtape"))&&(w=`https://streamtape.com/e/${p}`)),w.startsWith("http")){let M=yield R({name:`Vostfree (${m})`,title:`${h} - ${m}`,url:w,quality:"HD",headers:{Referer:U}});M&&u.push(M)}}}}catch(D){console.error(`[Vostfree] Match handle error: ${D.message}`)}}return u})}function pt(t,s,e,r){return f(this,null,function*(){console.log(`[Vostfree] Request: ${s} ${t} S${e}E${r}`);try{return yield j(t,s,e,r)}catch(o){return console.error("[Vostfree] Error:",o),[]}})}
