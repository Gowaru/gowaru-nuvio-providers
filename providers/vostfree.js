/**
 * vostfree - Built from src/vostfree/
 * Generated: 2026-02-25T23:09:39.634Z
 */
var G=Object.create;var R=Object.defineProperty,Y=Object.defineProperties,Q=Object.getOwnPropertyDescriptor,X=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols,tt=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var I=(t,s,e)=>s in t?R(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,d=(t,s)=>{for(var e in s||(s={}))W.call(s,e)&&I(t,e,s[e]);if(F)for(var e of F(s))et.call(s,e)&&I(t,e,s[e]);return t},b=(t,s)=>Y(t,X(s));var st=(t,s)=>{for(var e in s)R(t,e,{get:s[e],enumerable:!0})},q=(t,s,e,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of Z(s))!W.call(t,o)&&o!==e&&R(t,o,{get:()=>s[o],enumerable:!(r=Q(s,o))||r.enumerable});return t};var rt=(t,s,e)=>(e=t!=null?G(tt(t)):{},q(s||!t||!t.__esModule?R(e,"default",{value:t,enumerable:!0}):e,t)),nt=t=>q(R({},"__esModule",{value:!0}),t);var f=(t,s,e)=>new Promise((r,o)=>{var n=i=>{try{l(e.next(i))}catch(u){o(u)}},c=i=>{try{l(e.throw(i))}catch(u){o(u)}},l=i=>i.done?r(i.value):Promise.resolve(i.value).then(n,c);l((e=e.apply(t,s)).next())});var bt={};st(bt,{getStreams:()=>xt});module.exports=nt(bt);var ot={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function T(e){return f(this,arguments,function*(t,s={}){console.log(`[Vostfree] Fetching: ${t}`);let r=yield fetch(t,d({headers:d(d({},ot),s.headers)},s));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var V=rt(require("cheerio-without-node-native"));var at={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36"},j=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(s){return t}};function v(e){return f(this,arguments,function*(t,s={}){try{let r=yield fetch(t,b(d({},s),{headers:d(d({},at),s.headers),redirect:"follow"}));if(!r.ok)return null;let o=yield r.text();return{text:()=>Promise.resolve(o),ok:!0,url:r.url,headers:r.headers}}catch(r){return null}})}function k(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let s=new RegExp("eval\\s*\\(\\s*function\\s*\\(\\s*p\\s*,\\s*a\\s*,\\s*c\\s*,\\s*k\\s*,\\s*e\\s*,\\s*d\\s*\\).*?\\}\\s*\\((.*?)\\)\\s*\\)","gs"),e=t,r;for(;(r=s.exec(t))!==null;)try{let n=r[1].match(new RegExp("^'(.*?)',\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*'(.*?)'\\.split\\('\\|'\\)","s"));if(!n)continue;let c=n[1].replace(/\\'/g,"'"),l=parseInt(n[2]),i=parseInt(n[3]),u=n[4].split("|"),a=p=>(p<l?"":a(parseInt(p/l)))+((p=p%l)>35?String.fromCharCode(p+29):p.toString(36)),h={};for(;i--;)h[a(i)]=u[i]||a(i);let A=c.replace(/\b\w+\b/g,p=>h[p]||p);e=e.replace(r[0],A)}catch(o){}return e}catch(s){return t}}function it(t){return f(this,null,function*(){try{let s=yield v(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!s)return{url:t};let e=yield s.text(),r=e.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||e.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let o=r[1];return o.startsWith("//")?o="https:"+o:o.startsWith("/")&&(o="https://video.sibnet.ru"+o),{url:o,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(s){}return{url:t}})}function ct(t){return f(this,null,function*(){try{let s=yield v(t,{headers:{Referer:"https://vidmoly.to/"}});if(!s)return{url:t};let e=yield s.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=k(e));let r=e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(s){}return{url:t}})}function lt(t){return f(this,null,function*(){try{let s=yield v(t,{headers:{Referer:"https://uqload.com/"}});if(!s)return{url:t};let e=yield s.text(),r=e.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(r)return{url:r[1],headers:{Referer:"https://uqload.com/"}}}catch(s){}return{url:t}})}function ut(t){return f(this,null,function*(){try{let s=yield v(t);if(!s)return{url:t};let e=yield s.text(),r=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r){let n=yield v(r[1]);n&&(e=yield n.text())}let o=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(o){let n=o[1]||o[0];return n.includes("base64")&&(n=j(n.split(",")[1]||n)),{url:n,headers:{Referer:t}}}}catch(s){}return{url:t}})}function ft(t){return f(this,null,function*(){try{let s=yield v(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=k(e));let r=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(r){let o="https:"+r[1],n=r[2].split("+");for(let c of n){let l=c.match(/['"]([^'"]+)['"]/);if(l){let i=l[1],u=c.match(/substring\((\d+)\)/);u&&(i=i.substring(parseInt(u[1]))),o+=i}}return{url:o,headers:{Referer:"https://streamtape.com/"}}}}catch(s){}return{url:t}})}function ht(t){return f(this,null,function*(){try{let s=yield v(t);if(!s)return{url:t};let e=yield s.text(),r=e.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.mp4[^"']*)["']/);if(r)return{url:r[1]}}catch(s){}return{url:t}})}function dt(t){return f(this,null,function*(){try{let s=yield v(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=k(e));let r=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r){let o=r[1];return o.includes("base64")&&(o=j(o.split(",")[1]||o)),{url:o,headers:{Referer:t}}}}catch(s){}return{url:t}})}function mt(t){return f(this,null,function*(){try{let s=yield v(t);if(!s)return{url:t};let r=(yield s.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:t}}}catch(s){}return{url:t}})}function pt(t){return f(this,null,function*(){var s;try{let e=((s=t.match(/https?:\/\/([^\/]+)/))==null?void 0:s[1])||"dood.to",r=yield v(t);if(!r)return{url:t};let o=yield r.text();o.includes("eval(function(p,a,c,k,e,d)")&&(o=k(o));let n=o.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(n){let c=n[1],l=`https://${e}/pass_md5/${c}`,i=yield fetch(l,{headers:{Referer:t}});if(i.ok){let u=yield i.text(),a=Math.random().toString(36).substring(2,12);return{url:u+a+"?token="+c+"&expiry="+Date.now(),headers:{Referer:`https://${e}/`}}}}}catch(e){}return{url:t}})}function wt(t){return f(this,null,function*(){try{let s=yield v(t);if(!s)return{url:t};let r=(yield s.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:t}}}catch(s){}return{url:t}})}function _(t,s=0){return f(this,null,function*(){var o;if(s>3)return b(d({},t),{isDirect:!1});let e=t.url,r=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(r.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!r.includes("html"))return b(d({},t),{isDirect:!0});try{let n=null;if(r.includes("sibnet.ru")?n=yield it(e):r.includes("vidmoly.")?n=yield ct(e):r.includes("uqload.")||r.includes("oneupload.")?n=yield lt(e):r.includes("voe.")?n=yield ut(e):r.includes("streamtape.com")||r.includes("stape")?n=yield ft(e):r.includes("dood")||r.includes("ds2play")?n=yield pt(e):r.includes("moonplayer")||r.includes("moon.")?n=yield wt(e):r.includes("sendvid.")?n=yield ht(e):r.includes("luluvid.")||r.includes("lulu.")?n=yield dt(e):(r.includes("hgcloud.")||r.includes("savefiles."))&&(n=yield mt(e)),n&&n.url!==e)return b(d({},t),{url:n.url,headers:d(d({},t.headers),n.headers||{}),isDirect:!0,originalUrl:e});if(!n||n.url===e){let c=yield v(e,{headers:t.headers});if(c){let l=yield c.text();l.includes("p,a,c,k,e,d")&&(l=k(l));let i=l.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||l.match(/https?:\/\/[^"']+\.mp4[^"']*/)||l.match(/file\s*:\s*["']([^"']+)["']/);if(i){let u=i[1]||i[0];u.startsWith("//")&&(u="https:"+u),u.startsWith("http")&&!u.includes(gt)&&(n={url:u})}if(!n){let u=l.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(u){let a=u[1];if(a.startsWith("//")&&(a="https:"+a),a.startsWith("/")){let h=(o=e.match(/^https?:\/\/[^\/]+/))==null?void 0:o[0];h&&(a=h+a)}if(a.startsWith("http")&&a!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${a}`),yield _(b(d({},t),{url:a}),s+1)}}}}if(n&&n.url!==e&&n.url.startsWith("http"))return b(d({},t),{url:n.url,headers:d(d({},t.headers),n.headers||{}),isDirect:!0,originalUrl:e})}catch(n){}return b(d({},t),{isDirect:!1})})}var gt="googletagmanager";var yt="https://arm.haglund.dev/api/v2";var $t="https://v3-cinemeta.strem.io";function U(e){return f(this,arguments,function*(t,s={}){try{let r=new AbortController,o=setTimeout(()=>r.abort(),8e3),n=yield fetch(t,b(d({},s),{signal:r.signal}));return clearTimeout(o),n}catch(r){return console.error(`[ArmSync] Fetch failed: ${t}`,r.message),null}})}function P(t,s){return f(this,null,function*(){if(!t)return null;let e=yield U(`${yt}/themoviedb?id=${t}`);if(e)try{let n=yield e.json(),c=Array.isArray(n)?n[0]:n;if(c&&c.imdb)return c.imdb}catch(n){}let r=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}`,o=yield U(r);if(o){let c=(yield o.text()).match(/imdb\.com\/title\/(tt\d+)/);if(c)return c[1]}return null})}function N(t,s,e){return f(this,null,function*(){var u;if(!t||s===0)return null;let r=yield U(`${$t}/meta/series/${t}.json`);if(!r)return null;let o=yield r.json();if(!((u=o==null?void 0:o.meta)!=null&&u.videos))return null;let n=o.meta.videos.filter(a=>a.season>0&&a.episode>0).sort((a,h)=>a.season-h.season||a.episode-h.episode),c=[],l=new Set;for(let a of n){let h=`${a.season}-${a.episode}`;l.has(h)||(l.add(h),c.push(a))}let i=c.findIndex(a=>a.season==s&&a.episode==e);if(i!==-1){let a=i+1;return console.log(`[ArmSync] Resolved: S${s}E${e} -> Absolute ${a}`),a}return null})}var B="8265bd1679663a7ea12ac168da84d2e8",H="https://api.themoviedb.org/3";function K(t){return f(this,null,function*(){try{let s=new AbortController,e=setTimeout(()=>s.abort(),8e3),r=yield fetch(t,{headers:{"User-Agent":"Mozilla/5.0",Accept:"application/json"},signal:s.signal});return clearTimeout(e),r.ok?r:null}catch(s){return null}})}function O(t,s){return f(this,null,function*(){var o,n,c,l,i,u;let e=s==="movie"?"movie":"tv",r=[];try{let a=`${H}/${e}/${t}?api_key=${B}&language=en-US`,h=yield K(a);if(h){let x=yield h.json(),w=(o=e==="movie"?x.title:x.name)==null?void 0:o.trim(),m=(n=e==="movie"?x.original_title:x.original_name)==null?void 0:n.trim();w&&r.push(w),m&&m!==w&&/^[\x00-\x7F\u00C0-\u024F\s]+$/.test(m)&&r.push(m)}let A=`${H}/${e}/${t}/translations?api_key=${B}`,p=yield K(A);if(p){let w=((yield p.json()).translations||[]).find(S=>S.iso_639_1==="fr"),m=((l=(c=w==null?void 0:w.data)==null?void 0:c.name)==null?void 0:l.trim())||((u=(i=w==null?void 0:w.data)==null?void 0:i.title)==null?void 0:u.trim());m&&!r.includes(m)&&r.push(m)}}catch(a){console.error(`[Metadata] TMDB API error: ${a.message}`)}return console.log(`[Metadata] Titles for ${t}: ${r.join(" | ")}`),r})}var L="https://vostfree.ws";function vt(t){return f(this,null,function*(){try{let s=`do=search&subaction=search&story=${encodeURIComponent(t)}`,e=yield T(`${L}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:L},body:s}),r=V.load(e),o=[];r(".title a, .search-result-item a, .movie-title a").each((i,u)=>{let a=r(u).attr("href");a&&(a.includes(".html")||a.includes("/anime/"))&&o.push({title:r(u).text().trim()||r(u).attr("title"),url:a})});let n=i=>i.toLowerCase().replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),c=n(t);console.log(`[Vostfree] Results found: ${o.length}`);let l=o.filter(i=>n(i.title).includes(c));return l.length>0&&console.log(`[Vostfree] Found ${l.length} matches for ${t}`),l}catch(s){return console.error(`[Vostfree] Search error: ${s.message}`),[]}})}function z(t,s,e,r){return f(this,null,function*(){let o=yield O(t,s);if(o.length===0)return[];let n=[r];try{let a=yield P(t,s);if(a){let h=yield N(a,e,r);h&&h!==r&&n.push(h)}}catch(a){console.warn(`[Vostfree] ArmSync failed: ${a.message}`)}let c=[];for(let a of o)if(c=yield vt(a),c&&c.length>0)break;if(!c||c.length===0)return[];c=c.sort((a,h)=>{let A=a.title.toLowerCase(),p=h.title.toLowerCase(),x=`saison ${e}`,w=A.includes(x),m=p.includes(x);return w&&!m?-1:!w&&m?1:0});let l=[],i=new Set;for(let a of c){if(i.has(a.url))continue;i.add(a.url);let h=a.title.toLowerCase(),A=a.url,p=a.title.toUpperCase().includes(" VF")||a.url.includes("/vf/")?"VF":"VOSTFR",x=h.match(/saison\s*(\d+)/);if(!(x&&parseInt(x[1])!==e&&n.length===1))try{let w=yield T(A),m=V.load(w),S=null;if(m("select.new_player_selector option").each((C,D)=>{let g=m(D).text();for(let E of n){let y=E.toString(),$=y.padStart(2,"0");if(new RegExp(`(?:^|[^0-9])(?:Episode\\s*)?(?:${y}|${$})(?:$|[^0-9])`,"i").test(g))return S=m(D).val(),!1}}),!S){console.warn(`[Vostfree] Episode ${r} not found in selector on ${A}`);continue}console.log(`[Vostfree] Using buttons ID: ${S} for ${p}`);let J=m(`#${S} div[id^="player_"]`).toArray();for(let C of J){let D=m(C).attr("id").replace("player_",""),g=m(C).text().trim()||"Player",E=`content_player_${D}`,y=m(`#${E}`).text().trim();if(y){let $=y;if($.startsWith("http")||(g.toLowerCase().includes("sibnet")?$=`https://video.sibnet.ru/shell.php?videoid=${y}`:g.toLowerCase().includes("vidmoly")?$=`https://vidmoly.to/embed-${y}.html`:g.toLowerCase().includes("uqload")||g.toLowerCase().includes("oneupload")?$=`https://uqload.com/embed-${y}.html`:g.toLowerCase().includes("sendvid")?$=`https://sendvid.com/embed/${y}`:g.toLowerCase().includes("voe")?$=`https://voe.sx/e/${y}`:g.toLowerCase().includes("dood")?$=`https://dood.to/e/${y}`:(g.toLowerCase().includes("stape")||g.toLowerCase().includes("streamtape"))&&($=`https://streamtape.com/e/${y}`)),$.startsWith("http")){let M=yield _({name:`Vostfree (${p})`,title:`${g} - ${p}`,url:$,quality:"HD",headers:{Referer:L}});M&&l.push(M)}}}}catch(w){console.error(`[Vostfree] Match handle error: ${w.message}`)}}let u=l.filter(a=>a&&a.isDirect);return console.log(`[Vostfree] Total streams found: ${u.length}`),u})}function xt(t,s,e,r){return f(this,null,function*(){console.log(`[Vostfree] Request: ${s} ${t} S${e}E${r}`);try{return yield z(t,s,e,r)}catch(o){return console.error("[Vostfree] Error:",o),[]}})}
