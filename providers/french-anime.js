/**
 * french-anime - Built from src/french-anime/
 * Generated: 2026-02-25T16:30:00.227Z
 */
var P=Object.create;var x=Object.defineProperty,j=Object.defineProperties,q=Object.getOwnPropertyDescriptor,H=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertyNames,k=Object.getOwnPropertySymbols,z=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var D=(e,t,n)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t)=>{for(var n in t||(t={}))F.call(t,n)&&D(e,n,t[n]);if(k)for(var n of k(t))_.call(t,n)&&D(e,n,t[n]);return e},p=(e,t)=>j(e,H(t));var V=(e,t)=>{for(var n in t)x(e,n,{get:t[n],enumerable:!0})},T=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of W(t))!F.call(e,s)&&s!==n&&x(e,s,{get:()=>t[s],enumerable:!(r=q(t,s))||r.enumerable});return e};var K=(e,t,n)=>(n=e!=null?P(z(e)):{},T(t||!e||!e.__esModule?x(n,"default",{value:e,enumerable:!0}):n,e)),B=e=>T(x({},"__esModule",{value:!0}),e);var u=(e,t,n)=>new Promise((r,s)=>{var i=o=>{try{a(n.next(o))}catch(l){s(l)}},c=o=>{try{a(n.throw(o))}catch(l){s(l)}},a=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,c);a((n=n.apply(e,t)).next())});var ae={};V(ae,{getStreams:()=>oe});module.exports=B(ae);var O={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function b(n){return u(this,arguments,function*(e,t={}){console.log(`[French-Anime] Fetching: ${e}`);let r=yield fetch(e,m({headers:m(m({},O),t.headers)},t));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${e}`);return yield r.text()})}var S=K(require("cheerio"));var G={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"},J=e=>{try{return typeof atob=="function"?atob(e):Buffer.from(e,"base64").toString("binary")}catch(t){return e}};function $(n){return u(this,arguments,function*(e,t={}){try{let r=yield fetch(e,p(m({},t),{headers:m(m({},G),t.headers)}));if(!r.ok)return null;let s=yield r.text(),i=r.headers.get("set-cookie")||"";return{text:()=>Promise.resolve(s),ok:!0,url:r.url,headers:{"set-cookie":i}}}catch(r){return null}})}function R(e){try{if(!e.includes("p,a,c,k,e,d"))return e;let t=e.match(/}\s*\((.*)\)\s*$/);if(!t)return e;let n=t[1].match(/(".+"|\d+)/g);if(n.length<4)return e;let[r,s,i,c]=[n[0].replace(/^"|"$/g,""),parseInt(n[1]),parseInt(n[2]),n[3].replace(/^"|"$/g,"").split("|")],a=l=>(l<s?"":a(parseInt(l/s)))+((l=l%s)>35?String.fromCharCode(l+29):l.toString(36)),o={};for(;i--;)o[a(i)]=c[i]||a(i);return r.replace(/\b\w+\b/g,l=>o[l]||l)}catch(t){return e}}function Q(e){return u(this,null,function*(){try{let t=yield $(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!t)return{url:e};let n=yield t.text(),r=n.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||n.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let s=r[1];return s.startsWith("//")&&(s="https:"+s),{url:s,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(t){}return{url:e}})}function X(e){return u(this,null,function*(){try{let t=yield $(e,{headers:{Referer:"https://vidmoly.to/"}});if(!t)return{url:e};let n=yield t.text();n.includes("eval(function(p,a,c,k,e,d)")&&(n=R(n));let r=n.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(t){}return{url:e}})}function C(e){return u(this,null,function*(){try{let t=yield $(e);if(!t)return{url:e};let n=yield t.text(),r=n.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r)return C(r[1]);let s=n.match(/'hls'\s*:\s*'([^']+)'/)||n.match(/file\s*:\s*['"]([^'"]+\.m3u8[^'"]*)['"]/);if(s){let i=s[1];return i.includes("base64")&&(i=J(i.split(",")[1]||i)),{url:i}}}catch(t){}return{url:e}})}function Y(e){return u(this,null,function*(){try{let t=yield $(e);if(!t)return{url:e};let n=yield t.text(),r=n.match(/document\.getElementById\(['"]robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*(?:['"]([^'"]+)['"]|['"]([^'"]+)['"]\.substring\(\d+\))/);if(r){let s=r[1],i=r[2]||"";if(r[3]){let c=n.match(/substring\((\d+)\)/);i=r[3].substring(c?parseInt(c[1]):0)}return{url:"https:"+s+i}}}catch(t){}return{url:e}})}function Z(e){return u(this,null,function*(){var t;try{let n=(t=e.match(/https?:\/\/([^\/]+)/))==null?void 0:t[1],r=yield $(e);if(!r||!n)return{url:e};let s=yield r.text();s.includes("eval(function(p,a,c,k,e,d)")&&(s=R(s));let i=s.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(i){let c=i[1],a=yield fetch(`https://${n}/pass_md5/${c}`,{headers:{Referer:e}});if(a.ok)return{url:(yield a.text())+"z762vpz?token="+c+"&expiry="+Date.now()}}}catch(n){}return{url:e}})}function E(e){return u(this,null,function*(){let t=e.url,n=t.toLowerCase();if(n.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return p(m({},e),{isDirect:!0});try{let r={url:t};if(n.includes("sibnet.ru"))r=yield Q(t);else if(n.includes("vidmoly."))r=yield X(t);else if(n.includes("voe."))r=yield C(t);else if(n.includes("streamtape.com")||n.includes("stape"))r=yield Y(t);else if(n.includes("dood")||n.includes("ds2play"))r=yield Z(t);else{let s=yield $(t);if(s){let i=yield s.text(),c=i.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||i.match(/https?:\/\/[^"']+\.mp4[^"']*/);c&&(r={url:c[0]})}}if(r.url!==t&&r.url.startsWith("http"))return p(m({},e),{url:r.url,isDirect:!0,headers:m(m({},e.headers),r.headers||{}),originalUrl:t})}catch(r){}return p(m({},e),{isDirect:!1})})}var ee="https://arm.haglund.dev/api/v2";var te="https://v3-cinemeta.strem.io";function M(n){return u(this,arguments,function*(e,t={}){try{let r=new AbortController,s=setTimeout(()=>r.abort(),8e3),i=yield fetch(e,p(m({},t),{signal:r.signal}));return clearTimeout(s),i}catch(r){return console.error(`[ArmSync] Fetch failed: ${e}`,r.message),null}})}function U(e,t){return u(this,null,function*(){if(!e)return null;let n=yield M(`${ee}/themoviedb?id=${e}`);if(n){let r=yield n.json(),s=Array.isArray(r)?r[0]:r;if(s&&s.imdb)return s.imdb}return null})}function I(e,t,n){return u(this,null,function*(){var a;if(!e||t===0)return null;let r=yield M(`${te}/meta/series/${e}.json`);if(!r)return null;let s=yield r.json();if(!((a=s==null?void 0:s.meta)!=null&&a.videos))return null;let c=s.meta.videos.filter(o=>o.season>0).sort((o,l)=>o.season-l.season||o.episode-l.episode).findIndex(o=>o.season==t&&o.episode==n);if(c!==-1){let o=c+1;return console.log(`[ArmSync] Resolved: S${t}E${n} -> Absolute ${o}`),o}return null})}var A="https://french-anime.com";function ne(e,t){return u(this,null,function*(){try{let n=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,r=yield b(n),s=S.default.load(r),i=s('meta[property="og:title"]').attr("content")||s("h1").first().text()||s("h2").first().text();return i&&i.includes(" (")&&(i=i.split(" (")[0]),i&&i.includes(" - ")&&(i=i.split(" - ")[0]),i=i?i.trim():null,console.log(`[French-Anime] TMDB Title found: ${i}`),i}catch(n){return console.error(`[French-Anime] Failed to get title from TMDB: ${n.message}`),null}})}function re(e){return u(this,null,function*(){try{let t=`do=search&subaction=search&story=${encodeURIComponent(e)}`,n=yield b(`${A}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:A},body:t}),r=S.default.load(n),s=[];r("a.mov-t").each((o,l)=>{let f=r(l).attr("href"),h=r(l).text().trim();f&&f.includes(".html")&&s.push({title:h,url:f})});let i=o=>o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),c=i(e);console.log(`[French-Anime] Search results: ${s.length}`);let a=s.find(o=>i(o.title).includes(c)&&o.url.includes("animes-vostfr"));return a||(a=s.find(o=>i(o.title).includes(c))),a||(a=s[0]),a?(console.log(`[French-Anime] Selected: ${a.title} -> ${a.url}`),a):null}catch(t){return console.error(`[French-Anime] Search error: ${t.message}`),null}})}function se(e){return e.includes("sibnet")?"Sibnet":e.includes("vidmoly")?"Vidmoly":e.includes("christopheruntilpoint")||e.includes("voe")?"Voe":e.includes("luluvid")?"Luluvid":e.includes("savefiles")?"Savefiles":e.includes("up4fun")?"Up4Fun":e.includes("uqload")?"Uqload":e.includes("hgcloud")?"HGCloud":e.includes("myvi")?"MyVi":e.includes("rutube")?"Rutube":e.includes("ok.ru")?"OK.ru":e.includes("doodstream")||e.includes("vvide0")?"Doodstream":e.includes("mail.ru")?"Mail.ru":"Player"}function ie(e,t){let n=[],r=/(\d+)!((?:https?:\/\/[^,<\s]+)(?:,(?:https?:\/\/[^,<\s]+))*)/g,s;for(;(s=r.exec(e))!==null;)if(parseInt(s[1])===t){let c=s[2].split(",").filter(a=>a.startsWith("http"));for(let a of c){let o=a.trim();o.length>10&&n.push(o)}}return n}function N(e,t,n,r){return u(this,null,function*(){let s=yield ne(e,t);if(!s)return[];let i=[r];try{let f=yield U(e,t);if(f){let h=yield I(f,n,r);h&&i.push(h)}}catch(f){console.warn(`[French-Anime] ArmSync failed: ${f.message}`)}let c=yield re(s);if(!c)return[];let a=[],o=new Set,l=[c.url];try{let f=yield b(`${A}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:A},body:`do=search&subaction=search&story=${encodeURIComponent(s)}`}),h=S.default.load(f),v=d=>d.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),g=v(s);h("a.mov-t").each((d,w)=>{let y=h(w).attr("href"),L=v(h(w).text().trim());y&&y.includes(".html")&&L.includes(g)&&(l.includes(y)||l.push(y))})}catch(f){}for(let f of l)if(!o.has(f)){o.add(f);try{let h=yield b(f),v="VOSTFR";(f.includes("animes-vf/")||f.toLowerCase().includes("french"))&&(v="VF");let g=[];for(let d of i){let w=ie(h,d);g.push(...w)}for(let d of g){let w=se(d),y=yield E({name:`French-Anime (${v})`,title:`${w} Player`,url:d,quality:"HD",headers:{Referer:A}});a.push(y)}g.length>0&&console.log(`[French-Anime] Found ${g.length} players on ${f}`)}catch(h){console.error(`[French-Anime] Failed to fetch ${f}: ${h.message}`)}}return a})}function oe(e,t,n,r){return u(this,null,function*(){console.log(`[French-Anime] Request: ${t} ${e} S${n}E${r}`);try{return yield N(e,t,n,r)}catch(s){return console.error("[French-Anime] Error:",s),[]}})}
