/**
 * french-anime - Built from src/french-anime/
 * Generated: 2026-02-25T11:06:32.960Z
 */
var _=Object.create;var $=Object.defineProperty,z=Object.defineProperties,K=Object.getOwnPropertyDescriptor,O=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertyNames,q=Object.getOwnPropertySymbols,G=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var C=(e,t,n)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d=(e,t)=>{for(var n in t||(t={}))E.call(t,n)&&C(e,n,t[n]);if(q)for(var n of q(t))J.call(t,n)&&C(e,n,t[n]);return e},x=(e,t)=>z(e,O(t));var Q=(e,t)=>{for(var n in t)$(e,n,{get:t[n],enumerable:!0})},k=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of B(t))!E.call(e,r)&&r!==n&&$(e,r,{get:()=>t[r],enumerable:!(s=K(t,r))||s.enumerable});return e};var X=(e,t,n)=>(n=e!=null?_(G(e)):{},k(t||!e||!e.__esModule?$(n,"default",{value:e,enumerable:!0}):n,e)),Y=e=>k($({},"__esModule",{value:!0}),e);var l=(e,t,n)=>new Promise((s,r)=>{var i=c=>{try{a(n.next(c))}catch(f){r(f)}},m=c=>{try{a(n.throw(c))}catch(f){r(f)}},a=c=>c.done?s(c.value):Promise.resolve(c.value).then(i,m);a((n=n.apply(e,t)).next())});var we={};Q(we,{getStreams:()=>pe});module.exports=Y(we);var Z={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function b(n){return l(this,arguments,function*(e,t={}){console.log(`[French-Anime] Fetching: ${e}`);let s=yield fetch(e,d({headers:d(d({},Z),t.headers)},t));if(!s.ok)throw new Error(`HTTP error ${s.status} for ${e}`);return yield s.text()})}var F=X(require("cheerio"));var ee={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"};function p(n){return l(this,arguments,function*(e,t={}){try{let s=new AbortController,r=setTimeout(()=>s.abort(),12e3),i=yield fetch(e,x(d({},t),{headers:d(d({},ee),t.headers),signal:s.signal}));return clearTimeout(r),i}catch(s){return console.error(`[Resolver] Fetch failed for ${e}: ${s.message}`),null}})}function te(e){return l(this,null,function*(){let t=yield p(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!t)return e;let n=yield t.text(),s=n.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||n.match(/src\s*:\s*"([^"]+\.mp4)"/)||n.match(/player\.setVideo\(\s*\{\s*"url"\s*:\s*"([^"]+)"/);if(s){let r=s[1];return r.startsWith("//")?r=`https:${r}`:r.startsWith("/")&&(r=`https://video.sibnet.ru${r}`),r}return e})}function S(e){return l(this,null,function*(){let t=yield p(e,{headers:{Referer:"https://vidmoly.to/"}});if(!t)return e;let n=yield t.text(),s=n.match(/file\s*:\s*"([^"]+\.m3u8)"/)||n.match(/file\s*:\s*"([^"]+\.mp4)"/)||n.match(/sources\s*:\s*\[\s*\{\s*file\s*:\s*"([^"]+)"/);return s?s[1]:e})}function ne(e){return l(this,null,function*(){let t=yield p(e,{headers:{Referer:"https://uqload.com/"}});if(!t)return e;let n=yield t.text(),s=n.match(/sources\s*:\s*\["([^"]+\.(?:mp4|m3u8))"\]/)||n.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/)||n.match(/file\s*:\s*"([^"]+\.(?:mp4|m3u8))"/);return s?s[1]:e})}function se(e){return l(this,null,function*(){let t=yield p(e);if(!t)return e;let n=yield t.text(),s=n.match(/'hls'\s*:\s*'([^']+)'/)||n.match(/"hls"\s*:\s*"([^"]+)"/)||n.match(/window\.location\.href\s*=\s*'([^']+)'/);if(s){let r=s[1];if(r.includes("base64"))try{let i=r.split(",")[1]||r;typeof atob=="function"&&(r=atob(i))}catch(i){}return r}return e})}function re(e){return l(this,null,function*(){let t=yield p(e);if(!t)return e;let n=yield t.text(),s=n.match(/sources\s*:\s*\[\s*\{\s*"file"\s*:\s*"([^"]+)"/i)||n.match(/file\s*:\s*"([^"]+)"/i)||n.match(/src\s*:\s*"([^"]+\.m3u8)"/i);return s?s[1]:e})}function ie(e){return l(this,null,function*(){let t=yield p(e);if(!t)return e;let n=yield t.text(),s=n.match(/file\s*:\s*"([^"]+)"/i)||n.match(/source\s*:\s*"([^"]+)"/i)||n.match(/video\s+src="([^"]+)"/i);return s?s[1]:e})}function oe(e){return l(this,null,function*(){let t=yield p(e);if(!t)return e;let n=yield t.text(),s=n.match(/file\s*:\s*"([^"]+)"/i)||n.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8|mkv))"/i);return s?s[1]:e})}function ae(e){return l(this,null,function*(){let t=yield p(e);if(!t)return e;let n=yield t.text(),s=n.match(/robotlink\.innerHTML\s*=\s*'([^']+)'\s*\+\s*'([^']+)'/);if(s)return`https:${s[1]}${s[2].substring(3)}`;let r=n.match(/id="robotlink">([^<]+)/);return r?`https:${r[1]}`:e})}function ce(e){return l(this,null,function*(){let t=yield p(e);if(!t)return e;let n=yield t.text(),s=n.match(/source\s+src="([^"]+\.mp4)"/i)||n.match(/video_source\s*:\s*"([^"]+)"/);return s?s[1]:e})}function le(e){return l(this,null,function*(){let t="https://dood.to",n=yield p(e,{headers:{Referer:t}});if(!n)return e;let s=yield n.text(),r=s.match(/\$.get\('\/pass_md5\/([^']+)'/);if(r){let m=`${t}/pass_md5/${r[1]}`,a=yield p(m,{headers:{Referer:e}});if(a)return`${yield a.text()}z72899?token=${r[1]}&expiry=${Date.now()}`}let i=s.match(/window\.open\('([^']+)'\)/);return i?i[1]:e})}function L(e){return l(this,null,function*(){let t=e.url,n=t.toLowerCase();if(n.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return x(d({},e),{isDirect:!0});try{let s=t,r=d({},e.headers);if(n.includes("sibnet.ru")?(s=yield te(t),r.Referer="https://video.sibnet.ru/"):n.includes("vidmoly.")?(s=yield S(t),r.Referer="https://vidmoly.to/"):n.includes("uqload.")?(s=yield ne(t),r.Referer="https://uqload.com/"):n.includes("voe.sx")||n.includes("christopheruntilpoint")?s=yield se(t):n.includes("moonplayer")||n.includes("moonembed")?s=yield re(t):n.includes("mytv")||n.includes("mycloud")||n.includes("mclls.net")?(s=yield ie(t),r.Referer="https://mycloud.cc/"):n.includes("fhd")||n.includes("fhd1")?s=yield oe(t):n.includes("upstream.")?s=yield S(t):n.includes("vido.")||n.includes("vidlo.")?s=yield S(t):n.includes("streamtape.com")?s=yield ae(t):n.includes("sendvid.com")?s=yield ce(t):(n.includes("dood")||n.includes("ds2play")||n.includes("viddood"))&&(s=yield le(t)),s!==t&&s.startsWith("http"))return console.log(`[Resolver] Success: ${t.substring(0,30)}... -> ${s.substring(0,30)}...`),x(d({},e),{url:s,isDirect:!0,headers:r,originalUrl:t})}catch(s){console.error(`[Resolver] Failed for ${t}:`,s)}return x(d({},e),{isDirect:!1})})}var N="https://arm.haglund.dev/api/v2",P="https://api.jikan.moe/v4",ue="https://v3-cinemeta.strem.io";function A(n){return l(this,arguments,function*(e,t={}){try{let s=new AbortController,r=setTimeout(()=>s.abort(),8e3),i=yield fetch(e,x(d({},t),{signal:s.signal}));return clearTimeout(r),i}catch(s){return console.error(`[ArmSync] Fetch failed: ${e}`,s.message),null}})}function H(e,t){return l(this,null,function*(){if(!e)return null;let n=yield A(`${N}/themoviedb?id=${e}`);if(n){let s=yield n.json(),r=Array.isArray(s)?s[0]:s;if(r&&r.imdb)return r.imdb}return null})}function W(e,t,n){return l(this,null,function*(){var a,c,f;if(!e)return null;let s=t===0||t===void 0?"movie":"series",r=yield A(`${ue}/meta/${s}/${e}.json`);if(!r)return null;let i=yield r.json();if(s==="movie")return((c=(a=i==null?void 0:i.meta)==null?void 0:a.released)==null?void 0:c.split("T")[0])||null;if(!((f=i==null?void 0:i.meta)!=null&&f.videos))return null;let m=i.meta.videos.find(o=>o.season==t&&o.episode==n);return m&&m.released?m.released.split("T")[0]:null})}function I(e,t){return l(this,null,function*(){var i,m,a,c;if(!e||!t)return null;let n=yield A(`${N}/imdb?id=${e}`);if(!n)return null;let s=yield n.json();if(!Array.isArray(s))return null;let r=new Date(t);for(let f of s){let o=f.myanimelist;if(!o)continue;let h=yield A(`${P}/anime/${o}`);if(!h)continue;let u=(i=yield h.json())==null?void 0:i.data;if(!u)continue;let v=(m=u.aired)!=null&&m.from?new Date(u.aired.from):null,w=(a=u.aired)!=null&&a.to?new Date(u.aired.to):null;if(v){let y=new Date(v);y.setDate(y.getDate()-2);let g=w?new Date(w):new Date;if(g.setDate(g.getDate()+2),r>=y&&r<=g){if(u.type==="Movie"||u.episodes===1)return{malId:o,absoluteEpisode:1,type:u.type};let D=yield A(`${P}/anime/${o}/episodes`);if(D){let T=(c=yield D.json())==null?void 0:c.data;if(Array.isArray(T)){let U=T.find(M=>{if(!M.aired)return!1;let j=new Date(M.aired);return Math.abs(r-j)/(1e3*60*60*24)<=2});if(U)return{malId:o,absoluteEpisode:U.mal_id,title:u.title,animeType:u.type}}}return{malId:o,absoluteEpisode:null,potentialMatch:!0}}}}return null})}var R="https://french-anime.com";function me(e,t){return l(this,null,function*(){try{let n=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,s=yield b(n),r=F.default.load(s),i=r('meta[property="og:title"]').attr("content")||r("h1").first().text()||r("h2").first().text();return i&&i.includes(" (")&&(i=i.split(" (")[0]),i&&i.includes(" - ")&&(i=i.split(" - ")[0]),i=i?i.trim():null,console.log(`[French-Anime] TMDB Title found: ${i}`),i}catch(n){return console.error(`[French-Anime] Failed to get title from TMDB: ${n.message}`),null}})}function fe(e){return l(this,null,function*(){try{let t=`do=search&subaction=search&story=${encodeURIComponent(e)}`,n=yield b(`${R}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:R},body:t}),s=F.default.load(n),r=[];s("a.mov-t").each((c,f)=>{let o=s(f).attr("href"),h=s(f).text().trim();o&&o.includes(".html")&&r.push({title:h,url:o})});let i=c=>c.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),m=i(e);console.log(`[French-Anime] Search results: ${r.length}`);let a=r.find(c=>i(c.title).includes(m)&&c.url.includes("animes-vostfr"));return a||(a=r.find(c=>i(c.title).includes(m))),a||(a=r[0]),a?(console.log(`[French-Anime] Selected: ${a.title} -> ${a.url}`),a):null}catch(t){return console.error(`[French-Anime] Search error: ${t.message}`),null}})}function he(e){return e.includes("sibnet")?"Sibnet":e.includes("vidmoly")?"Vidmoly":e.includes("christopheruntilpoint")||e.includes("voe")?"Voe":e.includes("luluvid")?"Luluvid":e.includes("savefiles")?"Savefiles":e.includes("up4fun")?"Up4Fun":e.includes("uqload")?"Uqload":e.includes("hgcloud")?"HGCloud":e.includes("myvi")?"MyVi":e.includes("rutube")?"Rutube":e.includes("ok.ru")?"OK.ru":e.includes("doodstream")||e.includes("vvide0")?"Doodstream":e.includes("mail.ru")?"Mail.ru":"Player"}function de(e,t){let n=[],s=/(\d+)!((?:https?:\/\/[^,<\s]+)(?:,(?:https?:\/\/[^,<\s]+))*)/g,r;for(;(r=s.exec(e))!==null;)if(parseInt(r[1])===t){let m=r[2].split(",").filter(a=>a.startsWith("http"));for(let a of m){let c=a.trim();c.length>10&&n.push(c)}}return n}function V(e,t,n,s){return l(this,null,function*(){let r=yield me(e,t);if(!r)return[];let i=[s];try{let o=yield H(e,t);if(o){let h=yield W(o,n,s);if(h){let u=yield I(o,h);u&&u.absoluteEpisode&&(console.log(`[French-Anime] ArmSync: S${n}E${s} -> Absolute ${u.absoluteEpisode}`),i.push(u.absoluteEpisode))}}}catch(o){console.warn(`[French-Anime] ArmSync failed: ${o.message}`)}let m=yield fe(r);if(!m)return[];let a=[],c=new Set,f=[m.url];try{let o=yield b(`${R}/index.php?do=search`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Referer:R},body:`do=search&subaction=search&story=${encodeURIComponent(r)}`}),h=F.default.load(o),u=w=>w.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),v=u(r);h("a.mov-t").each((w,y)=>{let g=h(y).attr("href"),D=u(h(y).text().trim());g&&g.includes(".html")&&D.includes(v)&&(f.includes(g)||f.push(g))})}catch(o){}for(let o of f)if(!c.has(o)){c.add(o);try{let h=yield b(o),u="VOSTFR";(o.includes("animes-vf/")||o.toLowerCase().includes("french"))&&(u="VF");let v=[];for(let w of i){let y=de(h,w);v.push(...y)}for(let w of v){let y=he(w),g=yield L({name:`French-Anime (${u})`,title:`${y} Player`,url:w,quality:"HD",headers:{Referer:R}});a.push(g)}v.length>0&&console.log(`[French-Anime] Found ${v.length} players on ${o}`)}catch(h){console.error(`[French-Anime] Failed to fetch ${o}: ${h.message}`)}}return a})}function pe(e,t,n,s){return l(this,null,function*(){console.log(`[French-Anime] Request: ${t} ${e} S${n}E${s}`);try{return yield V(e,t,n,s)}catch(r){return console.error("[French-Anime] Error:",r),[]}})}
