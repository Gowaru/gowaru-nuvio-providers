/**
 * franime - Built from src/franime/
 * Generated: 2026-02-25T10:09:14.928Z
 */
var k=Object.create;var d=Object.defineProperty,H=Object.defineProperties,B=Object.getOwnPropertyDescriptor,O=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols,J=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var R=(e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,c=(e,t)=>{for(var n in t||(t={}))S.call(t,n)&&R(e,n,t[n]);if(F)for(var n of F(t))K.call(t,n)&&R(e,n,t[n]);return e},v=(e,t)=>H(e,O(t));var V=(e,t)=>{for(var n in t)d(e,n,{get:t[n],enumerable:!0})},T=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of z(t))!S.call(e,o)&&o!==n&&d(e,o,{get:()=>t[o],enumerable:!(r=B(t,o))||r.enumerable});return e};var I=(e,t,n)=>(n=e!=null?k(J(e)):{},T(t||!e||!e.__esModule?d(n,"default",{value:e,enumerable:!0}):n,e)),P=e=>T(d({},"__esModule",{value:!0}),e);var i=(e,t,n)=>new Promise((r,o)=>{var s=a=>{try{m(n.next(a))}catch(f){o(f)}},l=a=>{try{m(n.throw(a))}catch(f){o(f)}},m=a=>a.done?r(a.value):Promise.resolve(a.value).then(s,l);m((n=n.apply(e,t)).next())});var se={};V(se,{getStreams:()=>oe});module.exports=P(se);var G={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function x(n){return i(this,arguments,function*(e,t={}){console.log(`[FRAnime] Fetching: ${e}`);let r=yield fetch(e,c({headers:c(c({},G),t.headers)},t));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${e}`);return yield r.text()})}function b(n){return i(this,arguments,function*(e,t={}){let r=yield x(e,t);try{return JSON.parse(r)}catch(o){throw console.error(`[FRAnime] Failed to parse JSON from ${e}`),o}})}var U=I(require("cheerio"));var _={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"*/*"};function u(n){return i(this,arguments,function*(e,t={}){try{let r=new AbortController,o=setTimeout(()=>r.abort(),1e4),s=yield fetch(e,v(c({},t),{headers:c(c({},_),t.headers),signal:r.signal}));return clearTimeout(o),s}catch(r){return console.error(`[Resolver] Fetch failed for ${e}: ${r.message}`),null}})}function j(e){return i(this,null,function*(){let t=yield u(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!t)return e;let r=(yield t.text()).match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let o=r[1];return o.startsWith("/")&&(o=`https://video.sibnet.ru${o}`),o}return e})}function Q(e){return i(this,null,function*(){let t=yield u(e);if(!t)return e;let r=(yield t.text()).match(/file\s*:\s*"([^"]+)"/);return r?r[1]:e})}function X(e){return i(this,null,function*(){let t=yield u(e);if(!t)return e;let r=(yield t.text()).match(/sources\s*:\s*\["([^"]+)"\]/);return r?r[1]:e})}function Y(e){return i(this,null,function*(){let t=yield u(e);if(!t)return e;let n=yield t.text(),r=n.match(/'hls'\s*:\s*'([^']+)'/)||n.match(/"hls"\s*:\s*"([^"]+)"/);return r?r[1]:e})}function Z(e){return i(this,null,function*(){let t=yield u(e);if(!t)return e;let r=(yield t.text()).match(/source\s+src="([^"]+\.mp4)"/i);return r?r[1]:e})}function ee(e){return i(this,null,function*(){let t=yield u(e.replace("/e/","/d/"));if(!t)return e;let r=(yield t.text()).match(/window\.open\('([^']+)'\)/);return r?r[1]:e})}function L(e){return i(this,null,function*(){let t=e.url,n=t.toLowerCase();try{let r=t;if(n.includes("sibnet.ru")?r=yield j(t):n.includes("vidmoly.")?r=yield Q(t):n.includes("uqload.")?r=yield X(t):n.includes("voe.sx")||n.includes("christopheruntilpoint")?r=yield Y(t):n.includes("sendvid.com")?r=yield Z(t):(n.includes("dood")||n.includes("ds2play")||n.includes("viddood"))&&(r=yield ee(t)),r!==t)return console.log(`[Resolver] Success: ${t.substring(0,30)}... -> ${r.substring(0,30)}...`),v(c({},e),{url:r,isDirect:!0,originalUrl:t})}catch(r){console.error(`[Resolver] Failed for ${t}:`,r)}return e})}var q="https://api.franime.fr/api",g=null;function te(e,t){return i(this,null,function*(){try{let n=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,r=yield x(n),o=U.default.load(r),s=o('meta[property="og:title"]').attr("content")||o("h1").first().text()||o("h2").first().text();return s&&s.includes(" (")&&(s=s.split(" (")[0]),s&&s.includes(" - ")&&(s=s.split(" - ")[0]),s=s?s.trim():null,console.log(`[FRAnime] TMDB Title found: ${s}`),s}catch(n){return console.error(`[FRAnime] Failed to get title from TMDB: ${n.message}`),null}})}function ne(){return i(this,null,function*(){if(g)return g;try{return console.log("[FRAnime] Loading full anime list..."),g=yield b(`${q}/animes/`),console.log(`[FRAnime] Loaded ${g.length} animes.`),g}catch(e){return console.error(`[FRAnime] Failed to load anime list: ${e.message}`),[]}})}function re(e,t){let n=s=>s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),r=n(t),o=e.find(s=>n(s.title)===r||n(s.titleO||"")===r);return o||(o=e.find(s=>n(s.title).includes(r)||n(s.titleO||"").includes(r))),o}function D(e,t,n,r){return i(this,null,function*(){let o=yield te(e,t);if(!o)return[];let s=yield ne(),l=re(s,o);if(!l)return console.warn(`[FRAnime] No match found for "${o}" in anime list.`),[];console.log(`[FRAnime] Found match: ${l.title} (ID: ${l.id})`);let m=[],a=n-1,f=r-1,y=l.saisons[a];if(!y)return console.warn(`[FRAnime] Season ${n} not found for ${l.title}`),[];let A=y.episodes[f];if(!A)return console.warn(`[FRAnime] Episode ${r} not found in Season ${n}`),[];let E=["vo","vf"];for(let w of E){let $=A.lang[w];if(!$||!$.lecteurs)continue;let C=w==="vo"?"VOSTFR":"VF";for(let h=0;h<$.lecteurs.length;h++){let N=$.lecteurs[h],W=`${q}/anime/${l.id}/${a}/${f}/${w}/${h}`;try{let p=yield x(W,{headers:{Referer:"https://franime.fr/"}});if(p&&p.startsWith("http")){let M=yield L({name:`FRAnime (${C})`,title:`${N} Player`,url:p,quality:"HD",headers:{Referer:"https://franime.fr/"}});m.push(M)}}catch(p){console.error(`[FRAnime] Failed to fetch player ${h} for ${w}: ${p.message}`)}}}return m})}function oe(e,t,n,r){return i(this,null,function*(){console.log(`[FRAnime] Request: ${t} ${e} S${n}E${r}`);try{return yield D(e,t,n,r)}catch(o){return console.error("[FRAnime] Error:",o),[]}})}
