/**
 * franime - Built from src/franime/
 * Generated: 2026-02-25T10:36:17.668Z
 */
var H=Object.create;var d=Object.defineProperty,N=Object.defineProperties,V=Object.getOwnPropertyDescriptor,B=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertyNames,A=Object.getOwnPropertySymbols,z=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var F=(e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,a=(e,t)=>{for(var n in t||(t={}))b.call(t,n)&&F(e,n,t[n]);if(A)for(var n of A(t))J.call(t,n)&&F(e,n,t[n]);return e},w=(e,t)=>N(e,B(t));var K=(e,t)=>{for(var n in t)d(e,n,{get:t[n],enumerable:!0})},S=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of O(t))!b.call(e,r)&&r!==n&&d(e,r,{get:()=>t[r],enumerable:!(s=V(t,r))||s.enumerable});return e};var _=(e,t,n)=>(n=e!=null?H(z(e)):{},S(t||!e||!e.__esModule?d(n,"default",{value:e,enumerable:!0}):n,e)),I=e=>S(d({},"__esModule",{value:!0}),e);var i=(e,t,n)=>new Promise((s,r)=>{var o=l=>{try{f(n.next(l))}catch(h){r(h)}},m=l=>{try{f(n.throw(l))}catch(h){r(h)}},f=l=>l.done?s(l.value):Promise.resolve(l.value).then(o,m);f((n=n.apply(e,t)).next())});var fe={};K(fe,{getStreams:()=>me});module.exports=I(fe);var P={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function y(n){return i(this,arguments,function*(e,t={}){console.log(`[FRAnime] Fetching: ${e}`);let s=yield fetch(e,a({headers:a(a({},P),t.headers)},t));if(!s.ok)throw new Error(`HTTP error ${s.status} for ${e}`);return yield s.text()})}function q(n){return i(this,arguments,function*(e,t={}){let s=yield y(e,t);try{return JSON.parse(s)}catch(r){throw console.error(`[FRAnime] Failed to parse JSON from ${e}`),r}})}var U=_(require("cheerio"));var G={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7"};function c(n){return i(this,arguments,function*(e,t={}){try{let s=new AbortController,r=setTimeout(()=>s.abort(),1e4),o=yield fetch(e,w(a({},t),{headers:a(a({},G),t.headers),signal:s.signal}));return clearTimeout(r),o}catch(s){return console.error(`[Resolver] Fetch failed for ${e}: ${s.message}`),null}})}function j(e){return i(this,null,function*(){let t=yield c(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!t)return e;let n=yield t.text(),s=n.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||n.match(/src\s*:\s*"([^"]+\.mp4)"/)||n.match(/player\.setVideo\(\s*\{\s*"url"\s*:\s*"([^"]+)"/);if(s){let r=s[1];return r.startsWith("//")?r=`https:${r}`:r.startsWith("/")&&(r=`https://video.sibnet.ru${r}`),r}return e})}function Q(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let s=(yield t.text()).match(/file\s*:\s*"([^"]+)"/);return s?s[1]:e})}function X(e){return i(this,null,function*(){let t=yield c(e,{headers:{Referer:"https://uqload.com/"}});if(!t)return e;let n=yield t.text(),s=n.match(/sources\s*:\s*\["([^"]+)"\]/)||n.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/);return s?s[1]:e})}function Y(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let n=yield t.text(),s=n.match(/'hls'\s*:\s*'([^']+)'/)||n.match(/"hls"\s*:\s*"([^"]+)"/)||n.match(/window\.location\.href\s*=\s*'([^']+)'/);if(s){let r=s[1];if(r.includes("base64"))try{let o=r.split(",")[1]||r;typeof atob!="undefined"&&(r=atob(o))}catch(o){}return r}return e})}function Z(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let n=yield t.text(),s=n.match(/sources\s*:\s*\[\s*\{\s*"file"\s*:\s*"([^"]+)"/i)||n.match(/file\s*:\s*"([^"]+)"/i);return s?s[1]:e})}function ee(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let n=yield t.text(),s=n.match(/file\s*:\s*"([^"]+)"/i)||n.match(/source\s*:\s*"([^"]+)"/i);return s?s[1]:e})}function te(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let n=yield t.text(),s=n.match(/file\s*:\s*"([^"]+)"/i)||n.match(/src\s*:\s*"([^"]+\.(?:mp4|m3u8))"/i);return s?s[1]:e})}function ne(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let s=(yield t.text()).match(/file\s*:\s*"([^"]+)"/);return s?s[1]:e})}function se(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let s=(yield t.text()).match(/file\s*:\s*"([^"]+)"/);return s?s[1]:e})}function re(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let n=yield t.text(),s=n.match(/robotlink\.innerHTML\s*=\s*'([^']+)'/);if(s){let o=s[1];return o.startsWith("//")&&(o=`https:${o}`),o}return n.match(/video_link\s*:\s*"([^"]+)"/)?s[2]:e})}function oe(e){return i(this,null,function*(){let t=yield c(e);if(!t)return e;let n=yield t.text(),s=n.match(/source\s+src="([^"]+\.mp4)"/i)||n.match(/video_source\s*:\s*"([^"]+)"/);return s?s[1]:e})}function ie(e){return i(this,null,function*(){let t=e.replace("/e/","/d/"),n=yield c(t);if(!n)return e;let r=(yield n.text()).match(/window\.open\('([^']+)'\)/);return r?r[1]:e})}function T(e){return i(this,null,function*(){let t=e.url,n=t.toLowerCase();if(n.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return w(a({},e),{isDirect:!0});try{let s=t,r=a({},e.headers);if(n.includes("sibnet.ru")?(s=yield j(t),r.Referer="https://video.sibnet.ru/"):n.includes("vidmoly.")?(s=yield Q(t),r.Referer="https://vidmoly.to/"):n.includes("uqload.")?(s=yield X(t),r.Referer="https://uqload.com/"):n.includes("voe.sx")||n.includes("christopheruntilpoint")?s=yield Y(t):n.includes("moonplayer")||n.includes("moonembed")?s=yield Z(t):n.includes("mytv")||n.includes("mycloud")||n.includes("mclls.net")?s=yield ee(t):n.includes("fhd")||n.includes("fhd1")?s=yield te(t):n.includes("upstream.")?s=yield ne(t):n.includes("vido.")||n.includes("vidlo.")?s=yield se(t):n.includes("streamtape.com")?s=yield re(t):n.includes("sendvid.com")?s=yield oe(t):(n.includes("dood")||n.includes("ds2play")||n.includes("viddood"))&&(s=yield ie(t)),s!==t&&s.startsWith("http"))return console.log(`[Resolver] Success: ${t.substring(0,30)}... -> ${s.substring(0,30)}...`),w(a({},e),{url:s,isDirect:!0,headers:r,originalUrl:t})}catch(s){console.error(`[Resolver] Failed for ${t}:`,s)}return w(a({},e),{isDirect:!1})})}var L="https://api.franime.fr/api",g=null;function ae(e,t){return i(this,null,function*(){try{let n=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,s=yield y(n),r=U.default.load(s),o=r('meta[property="og:title"]').attr("content")||r("h1").first().text()||r("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[FRAnime] TMDB Title found: ${o}`),o}catch(n){return console.error(`[FRAnime] Failed to get title from TMDB: ${n.message}`),null}})}function ce(){return i(this,null,function*(){if(g)return g;try{return console.log("[FRAnime] Loading full anime list..."),g=yield q(`${L}/animes/`),console.log(`[FRAnime] Loaded ${g.length} animes.`),g}catch(e){return console.error(`[FRAnime] Failed to load anime list: ${e.message}`),[]}})}function le(e,t){let n=o=>o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),s=n(t),r=e.find(o=>n(o.title)===s||n(o.titleO||"")===s);return r||(r=e.find(o=>n(o.title).includes(s)||n(o.titleO||"").includes(s))),r}function D(e,t,n,s){return i(this,null,function*(){let r=yield ae(e,t);if(!r)return[];let o=yield ce(),m=le(o,r);if(!m)return console.warn(`[FRAnime] No match found for "${r}" in anime list.`),[];console.log(`[FRAnime] Found match: ${m.title} (ID: ${m.id})`);let f=[],l=n-1,h=s-1,$=m.saisons[l];if(!$)return console.warn(`[FRAnime] Season ${n} not found for ${m.title}`),[];let R=$.episodes[h];if(!R)return console.warn(`[FRAnime] Episode ${s} not found in Season ${n}`),[];let W=["vo","vf"];for(let x of W){let v=R.lang[x];if(!v||!v.lecteurs)continue;let k=x==="vo"?"VOSTFR":"VF";for(let u=0;u<v.lecteurs.length;u++){let C=v.lecteurs[u],E=`${L}/anime/${m.id}/${l}/${h}/${x}/${u}`;try{let p=yield y(E,{headers:{Referer:"https://franime.fr/"}});if(p&&p.startsWith("http")){let M=yield T({name:`FRAnime (${k})`,title:`${C} Player`,url:p,quality:"HD",headers:{Referer:"https://franime.fr/"}});f.push(M)}}catch(p){console.error(`[FRAnime] Failed to fetch player ${u} for ${x}: ${p.message}`)}}}return f})}function me(e,t,n,s){return i(this,null,function*(){console.log(`[FRAnime] Request: ${t} ${e} S${n}E${s}`);try{return yield D(e,t,n,s)}catch(r){return console.error("[FRAnime] Error:",r),[]}})}
