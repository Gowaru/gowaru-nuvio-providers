/**
 * animevostfr - Built from src/animevostfr/
 * Generated: 2026-02-25T22:30:07.617Z
 */
var N=Object.create;var R=Object.defineProperty,_=Object.defineProperties,j=Object.getOwnPropertyDescriptor,H=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertyNames,U=Object.getOwnPropertySymbols,z=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var M=(e,s,t)=>s in e?R(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,p=(e,s)=>{for(var t in s||(s={}))O.call(s,t)&&M(e,t,s[t]);if(U)for(var t of U(s))K.call(s,t)&&M(e,t,s[t]);return e},y=(e,s)=>_(e,H(s));var G=(e,s)=>{for(var t in s)R(e,t,{get:s[t],enumerable:!0})},L=(e,s,t,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let i of B(s))!O.call(e,i)&&i!==t&&R(e,i,{get:()=>s[i],enumerable:!(r=j(s,i))||r.enumerable});return e};var J=(e,s,t)=>(t=e!=null?N(z(e)):{},L(s||!e||!e.__esModule?R(t,"default",{value:e,enumerable:!0}):t,e)),Q=e=>L(R({},"__esModule",{value:!0}),e);var d=(e,s,t)=>new Promise((r,i)=>{var n=c=>{try{a(t.next(c))}catch(u){i(u)}},o=c=>{try{a(t.throw(c))}catch(u){i(u)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(n,o);a((t=t.apply(e,s)).next())});var ye={};G(ye,{getStreams:()=>we});module.exports=Q(ye);var X={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function v(t){return d(this,arguments,function*(e,s={}){console.log(`[AnimeVOSTFR] Fetching: ${e}`);let r=yield fetch(e,p({headers:p(p({},X),s.headers)},s));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${e}`);return yield r.text()})}var x=J(require("cheerio"));var Y={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36"},C=e=>{try{return typeof atob=="function"?atob(e):Buffer.from(e,"base64").toString("binary")}catch(s){return e}};function g(t){return d(this,arguments,function*(e,s={}){try{let r=yield fetch(e,y(p({},s),{headers:p(p({},Y),s.headers),redirect:"follow"}));if(!r.ok)return null;let i=yield r.text();return{text:()=>Promise.resolve(i),ok:!0,url:r.url,headers:r.headers}}catch(r){return null}})}function b(e){try{if(!e.includes("p,a,c,k,e,d"))return e;let s=new RegExp("eval\\s*\\(\\s*function\\s*\\(\\s*p\\s*,\\s*a\\s*,\\s*c\\s*,\\s*k\\s*,\\s*e\\s*,\\s*d\\s*\\).*?\\}\\s*\\((.*?)\\)\\s*\\)","gs"),t=e,r;for(;(r=s.exec(e))!==null;)try{let n=r[1].match(new RegExp("^'(.*?)',\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*'(.*?)'\\.split\\('\\|'\\)","s"));if(!n)continue;let o=n[1].replace(/\\'/g,"'"),a=parseInt(n[2]),c=parseInt(n[3]),u=n[4].split("|"),l=m=>(m<a?"":l(parseInt(m/a)))+((m=m%a)>35?String.fromCharCode(m+29):m.toString(36)),f={};for(;c--;)f[l(c)]=u[c]||l(c);let h=o.replace(/\b\w+\b/g,m=>f[m]||m);t=t.replace(r[0],h)}catch(i){}return t}catch(s){return e}}function Z(e){return d(this,null,function*(){try{let s=yield g(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!s)return{url:e};let t=yield s.text(),r=t.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||t.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let i=r[1];return i.startsWith("//")?i="https:"+i:i.startsWith("/")&&(i="https://video.sibnet.ru"+i),{url:i,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(s){}return{url:e}})}function ee(e){return d(this,null,function*(){try{let s=yield g(e,{headers:{Referer:"https://vidmoly.to/"}});if(!s)return{url:e};let t=yield s.text();t.includes("eval(function(p,a,c,k,e,d)")&&(t=b(t));let r=t.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(s){}return{url:e}})}function te(e){return d(this,null,function*(){try{let s=yield g(e,{headers:{Referer:"https://uqload.com/"}});if(!s)return{url:e};let t=yield s.text(),r=t.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||t.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(r)return{url:r[1],headers:{Referer:"https://uqload.com/"}}}catch(s){}return{url:e}})}function se(e){return d(this,null,function*(){try{let s=yield g(e);if(!s)return{url:e};let t=yield s.text(),r=t.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r){let n=yield g(r[1]);n&&(t=yield n.text())}let i=t.match(/'hls'\s*:\s*'([^']+)'/)||t.match(/"hls"\s*:\s*"([^"]+)"/)||t.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(i){let n=i[1]||i[0];return n.includes("base64")&&(n=C(n.split(",")[1]||n)),{url:n,headers:{Referer:e}}}}catch(s){}return{url:e}})}function re(e){return d(this,null,function*(){try{let s=yield g(e);if(!s)return{url:e};let t=yield s.text();t.includes("p,a,c,k,e,d")&&(t=b(t));let r=t.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(r){let i="https:"+r[1],n=r[2].split("+");for(let o of n){let a=o.match(/['"]([^'"]+)['"]/);if(a){let c=a[1],u=o.match(/substring\((\d+)\)/);u&&(c=c.substring(parseInt(u[1]))),i+=c}}return{url:i,headers:{Referer:"https://streamtape.com/"}}}}catch(s){}return{url:e}})}function ne(e){return d(this,null,function*(){try{let s=yield g(e);if(!s)return{url:e};let t=yield s.text(),r=t.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["']/)||t.match(/source\s+src=["']([^"']+\.mp4[^"']*)["']/);if(r)return{url:r[1]}}catch(s){}return{url:e}})}function ie(e){return d(this,null,function*(){try{let s=yield g(e);if(!s)return{url:e};let t=yield s.text();t.includes("p,a,c,k,e,d")&&(t=b(t));let r=t.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||t.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r){let i=r[1];return i.includes("base64")&&(i=C(i.split(",")[1]||i)),{url:i,headers:{Referer:e}}}}catch(s){}return{url:e}})}function ae(e){return d(this,null,function*(){try{let s=yield g(e);if(!s)return{url:e};let r=(yield s.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:e}}}catch(s){}return{url:e}})}function oe(e){return d(this,null,function*(){var s;try{let t=((s=e.match(/https?:\/\/([^\/]+)/))==null?void 0:s[1])||"dood.to",r=yield g(e);if(!r)return{url:e};let i=yield r.text();i.includes("eval(function(p,a,c,k,e,d)")&&(i=b(i));let n=i.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(n){let o=n[1],a=`https://${t}/pass_md5/${o}`,c=yield fetch(a,{headers:{Referer:e}});if(c.ok){let u=yield c.text(),l=Math.random().toString(36).substring(2,12);return{url:u+l+"?token="+o+"&expiry="+Date.now(),headers:{Referer:`https://${t}/`}}}}}catch(t){}return{url:e}})}function ce(e){return d(this,null,function*(){try{let s=yield g(e);if(!s)return{url:e};let r=(yield s.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:e}}}catch(s){}return{url:e}})}function F(e,s=0){return d(this,null,function*(){var i;if(s>3)return y(p({},e),{isDirect:!1});let t=e.url,r=t.toLowerCase();if(!t||t.includes("google-analytics")||t.includes("doubleclick"))return null;if(r.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!r.includes("html"))return y(p({},e),{isDirect:!0});try{let n=null;if(r.includes("sibnet.ru")?n=yield Z(t):r.includes("vidmoly.")?n=yield ee(t):r.includes("uqload.")||r.includes("oneupload.")?n=yield te(t):r.includes("voe.")?n=yield se(t):r.includes("streamtape.com")||r.includes("stape")?n=yield re(t):r.includes("dood")||r.includes("ds2play")?n=yield oe(t):r.includes("moonplayer")||r.includes("moon.")?n=yield ce(t):r.includes("sendvid.")?n=yield ne(t):r.includes("luluvid.")||r.includes("lulu.")?n=yield ie(t):(r.includes("hgcloud.")||r.includes("savefiles."))&&(n=yield ae(t)),n&&n.url!==t)return y(p({},e),{url:n.url,headers:p(p({},e.headers),n.headers||{}),isDirect:!0,originalUrl:t});if(!n||n.url===t){let o=yield g(t,{headers:e.headers});if(o){let a=yield o.text();a.includes("p,a,c,k,e,d")&&(a=b(a));let c=a.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||a.match(/https?:\/\/[^"']+\.mp4[^"']*/)||a.match(/file\s*:\s*["']([^"']+)["']/);if(c){let u=c[1]||c[0];u.startsWith("//")&&(u="https:"+u),u.startsWith("http")&&!u.includes(le)&&(n={url:u})}if(!n){let u=a.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(u){let l=u[1];if(l.startsWith("//")&&(l="https:"+l),l.startsWith("/")){let f=(i=t.match(/^https?:\/\/[^\/]+/))==null?void 0:i[0];f&&(l=f+l)}if(l.startsWith("http")&&l!==t)return console.log(`[Resolver] Peeling: Found nested iframe -> ${l}`),yield F(y(p({},e),{url:l}),s+1)}}}}if(n&&n.url!==t&&n.url.startsWith("http"))return y(p({},e),{url:n.url,headers:p(p({},e.headers),n.headers||{}),isDirect:!0,originalUrl:t})}catch(n){}return y(p({},e),{isDirect:!1})})}var le="googletagmanager";var ue="https://arm.haglund.dev/api/v2";var fe="https://v3-cinemeta.strem.io";function k(t){return d(this,arguments,function*(e,s={}){try{let r=new AbortController,i=setTimeout(()=>r.abort(),8e3),n=yield fetch(e,y(p({},s),{signal:r.signal}));return clearTimeout(i),n}catch(r){return console.error(`[ArmSync] Fetch failed: ${e}`,r.message),null}})}function q(e,s){return d(this,null,function*(){if(!e)return null;let t=yield k(`${ue}/themoviedb?id=${e}`);if(t)try{let n=yield t.json(),o=Array.isArray(n)?n[0]:n;if(o&&o.imdb)return o.imdb}catch(n){}let r=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${e}`,i=yield k(r);if(i){let o=(yield i.text()).match(/imdb\.com\/title\/(tt\d+)/);if(o)return o[1]}return null})}function W(e,s,t){return d(this,null,function*(){var u;if(!e||s===0)return null;let r=yield k(`${fe}/meta/series/${e}.json`);if(!r)return null;let i=yield r.json();if(!((u=i==null?void 0:i.meta)!=null&&u.videos))return null;let n=i.meta.videos.filter(l=>l.season>0&&l.episode>0).sort((l,f)=>l.season-f.season||l.episode-f.episode),o=[],a=new Set;for(let l of n){let f=`${l.season}-${l.episode}`;a.has(f)||(a.add(f),o.push(l))}let c=o.findIndex(l=>l.season==s&&l.episode==t);if(c!==-1){let l=c+1;return console.log(`[ArmSync] Resolved: S${s}E${t} -> Absolute ${l}`),l}return null})}var V="https://animevostfr.org";function de(e,s){return d(this,null,function*(){try{let t=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${e}?language=en-US`,r=yield v(t),i=x.load(r),n=i('meta[property="og:title"]').attr("content")||i("h1").first().text()||i("h2").first().text();return n&&n.includes(" (")&&(n=n.split(" (")[0]),n&&n.includes(" - ")&&(n=n.split(" - ")[0]),n=n?n.trim():null,console.log(`[AnimeVOSTFR] TMDB Title found: ${n}`),n}catch(t){return console.error(`[AnimeVOSTFR] Failed to get title from TMDB: ${t.message}`),null}})}function he(e){return d(this,null,function*(){try{let s=yield v(`${V}/?s=${encodeURIComponent(e)}`),t=x.load(s),r=[];t("a").each((u,l)=>{let f=t(l).attr("href")||"",h=t(l).text().trim();f.includes("/animes/")&&h.length>2&&r.push({title:h,url:f})});let i=new Set,n=r.filter(u=>i.has(u.url)?!1:(i.add(u.url),!0));console.log(`[AnimeVOSTFR] Search results: ${n.length}`);let o=u=>u.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),a=o(e),c=n.filter(u=>o(u.title).includes(a));return c.length===0&&n.length>0&&(console.log(`[AnimeVOSTFR] No exact match for "${e}", falling back to ${n.length} search results`),c=n),c.length>0&&console.log(`[AnimeVOSTFR] Found ${c.length} matches for ${e}`),c}catch(s){return console.error(`[AnimeVOSTFR] Search error: ${s.message}`),[]}})}function me(e,s,t,r=!1){return d(this,null,function*(){try{let i=yield v(e),n=x.load(i),o=[];n('a[href*="/episode/"]').each((f,h)=>{let m=n(h).attr("href")||"",w=n(h).text().trim();o.push({url:m,text:w})}),console.log(`[AnimeVOSTFR] Found ${o.length} episode links`);let a=String(t),c=a.padStart(2,"0"),u=[new RegExp(`-saison-${s}-episode-${a}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-saison-${s}-episode-${c}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-episode-${a}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-episode-${c}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-ep-${a}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-ep-${c}(?:-vostfr|-vf|/|$)`,"i")];for(let f of u){let h=o.find(m=>{if(!f.test(m.url))return!1;if(!r){let w=m.url.match(/-(?:saison-)?(\d+)-episode-/i);if(w&&parseInt(w[1])!==s)return!1}return!0});if(h)return console.log(`[AnimeVOSTFR] Found episode in URL: ${h.url}`),h.url}let l=[new RegExp(`^\\s*Episode\\s+${a}\\s*$`,"i"),new RegExp(`^\\s*Ep\\s*${a}\\s*$`,"i"),new RegExp(`(?:^|[^0-9])${a}(?:$|[^0-9])`)];for(let f of l){let h=o.find(m=>{if(!f.test(m.text))return!1;if(!r){let w=m.url.match(/-(?:saison-)?(\d+)-episode-/i);if(w&&parseInt(w[1])!==s)return!1}return!0});if(h)return console.log(`[AnimeVOSTFR] Found episode in text: ${h.url}`),h.url}return null}catch(i){return console.error(`[AnimeVOSTFR] Error finding episode: ${i.message}`),null}})}function pe(e){return d(this,null,function*(){let s=[];try{let t=yield v(e),r=x.load(t),i=[];r(".TPlayerNv li").each((o,a)=>{i.push(r(a).text().trim())});let n=[];r(".TPlayerTb").each((o,a)=>{let c=r(a).find("iframe"),u=r(a).find(".lazy-player");c.length&&c.attr("src")?n.push(c.attr("src")):u.length&&u.attr("data-src")&&n.push(u.attr("data-src"))}),console.log(`[AnimeVOSTFR] Found ${n.length} player tabs`);for(let o=0;o<n.length;o++)try{let a=n[o];a.startsWith("/")&&(a=V+a);let c=yield v(a),l=x.load(c)("iframe").attr("src");if(l&&l.startsWith("http")){let f=i[o]||`Lecteur ${o+1}`,h=ge(l),m=yield F({name:"AnimeVOSTFR",title:`${h} (${f})`,url:l,quality:"HD",headers:{Referer:V}});s.push(m)}}catch(a){console.error(`[AnimeVOSTFR] Failed to resolve player ${o}: ${a.message}`)}}catch(t){console.error(`[AnimeVOSTFR] Error extracting players: ${t.message}`)}return s})}function ge(e){return e.includes("sibnet")?"Sibnet":e.includes("vidmoly")?"Vidmoly":e.includes("christopheruntilpoint")||e.includes("voe")?"Voe":e.includes("luluvid")?"Luluvid":e.includes("savefiles")?"Savefiles":e.includes("uqload")||e.includes("oneupload")?"Uqload":e.includes("hgcloud")?"HGCloud":e.includes("dood")||e.includes("ds2play")?"Doodstream":e.includes("myvi")||e.includes("mytv")?"MyVi":e.includes("sendvid")?"Sendvid":e.includes("stape")||e.includes("streamtape")?"Streamtape":e.includes("moon")?"Moon":"Player"}function P(e,s,t,r){return d(this,null,function*(){let i=yield de(e,s);if(!i)return[];let n=[r];try{let f=yield q(e,s);if(f){let h=yield W(f,t,r);h&&h!==r&&n.push(h)}}catch(f){console.warn(`[AnimeVOSTFR] ArmSync failed: ${f.message}`)}let o=yield he(i);if(!o||o.length===0)return[];o=o.sort((f,h)=>{let m=f.title.toLowerCase(),w=h.title.toLowerCase(),S=`saison ${t}`,$=m.includes(S),A=w.includes(S);return $&&!A?-1:!$&&A?1:0});let a=[],c=new Set,u=new Set;for(let f of o){if(u.has(f.url))continue;u.add(f.url);let h=f.title.toLowerCase(),w=h.includes(" vf")||f.url.includes("vf")?"VF":"VOSTFR",S=h.match(/saison\s*(\d+)/);if(!(S&&parseInt(S[1])!==t&&n.length===1))for(let $ of n){let A=$!==r,T=yield me(f.url,t,$,A);if(T&&!c.has(T)){c.add(T);let D=yield pe(T),I=$===r?"":` (Abs ${$})`;D.forEach(E=>{E.name.includes("(")||(E.name=`AnimeVOSTFR (${w})`),E.title=`${E.title}${I}`}),a.push(...D)}}}a.length===0&&console.warn(`[AnimeVOSTFR] Episode S${t}E${r} not found (targets: ${n.join(", ")})`);let l=a.filter(f=>f&&f.isDirect);return console.log(`[AnimeVOSTFR] Total streams found: ${l.length}`),l})}function we(e,s,t,r){return d(this,null,function*(){console.log(`[AnimeVOSTFR] Request: ${s} ${e} S${t}E${r}`);try{return yield P(e,s,t,r)}catch(i){return console.error("[AnimeVOSTFR] Error:",i),[]}})}
