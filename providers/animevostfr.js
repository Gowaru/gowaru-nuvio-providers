/**
 * animevostfr - Built from src/animevostfr/
 * Generated: 2026-02-25T23:09:39.619Z
 */
var B=Object.create;var S=Object.defineProperty,z=Object.defineProperties,K=Object.getOwnPropertyDescriptor,G=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertyNames,U=Object.getOwnPropertySymbols,Y=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var V=(t,s,e)=>s in t?S(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,p=(t,s)=>{for(var e in s||(s={}))O.call(s,e)&&V(t,e,s[e]);if(U)for(var e of U(s))Q.call(s,e)&&V(t,e,s[e]);return t},v=(t,s)=>z(t,G(s));var X=(t,s)=>{for(var e in s)S(t,e,{get:s[e],enumerable:!0})},_=(t,s,e,n)=>{if(s&&typeof s=="object"||typeof s=="function")for(let i of J(s))!O.call(t,i)&&i!==e&&S(t,i,{get:()=>s[i],enumerable:!(n=K(s,i))||n.enumerable});return t};var Z=(t,s,e)=>(e=t!=null?B(Y(t)):{},_(s||!t||!t.__esModule?S(e,"default",{value:t,enumerable:!0}):e,t)),tt=t=>_(S({},"__esModule",{value:!0}),t);var d=(t,s,e)=>new Promise((n,i)=>{var r=l=>{try{a(e.next(l))}catch(u){i(u)}},o=l=>{try{a(e.throw(l))}catch(u){i(u)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,o);a((e=e.apply(t,s)).next())});var xt={};X(xt,{getStreams:()=>vt});module.exports=tt(xt);var et={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function R(e){return d(this,arguments,function*(t,s={}){console.log(`[AnimeVOSTFR] Fetching: ${t}`);let n=yield fetch(t,p({headers:p(p({},et),s.headers)},s));if(!n.ok)throw new Error(`HTTP error ${n.status} for ${t}`);return yield n.text()})}var b=Z(require("cheerio-without-node-native"));var st={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36"},C=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(s){return t}};function $(e){return d(this,arguments,function*(t,s={}){try{let n=yield fetch(t,v(p({},s),{headers:p(p({},st),s.headers),redirect:"follow"}));if(!n.ok)return null;let i=yield n.text();return{text:()=>Promise.resolve(i),ok:!0,url:n.url,headers:n.headers}}catch(n){return null}})}function A(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let s=new RegExp("eval\\s*\\(\\s*function\\s*\\(\\s*p\\s*,\\s*a\\s*,\\s*c\\s*,\\s*k\\s*,\\s*e\\s*,\\s*d\\s*\\).*?\\}\\s*\\((.*?)\\)\\s*\\)","gs"),e=t,n;for(;(n=s.exec(t))!==null;)try{let r=n[1].match(new RegExp("^'(.*?)',\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*'(.*?)'\\.split\\('\\|'\\)","s"));if(!r)continue;let o=r[1].replace(/\\'/g,"'"),a=parseInt(r[2]),l=parseInt(r[3]),u=r[4].split("|"),c=m=>(m<a?"":c(parseInt(m/a)))+((m=m%a)>35?String.fromCharCode(m+29):m.toString(36)),f={};for(;l--;)f[c(l)]=u[l]||c(l);let h=o.replace(/\b\w+\b/g,m=>f[m]||m);e=e.replace(n[0],h)}catch(i){}return e}catch(s){return t}}function nt(t){return d(this,null,function*(){try{let s=yield $(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!s)return{url:t};let e=yield s.text(),n=e.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||e.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(n){let i=n[1];return i.startsWith("//")?i="https:"+i:i.startsWith("/")&&(i="https://video.sibnet.ru"+i),{url:i,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(s){}return{url:t}})}function rt(t){return d(this,null,function*(){try{let s=yield $(t,{headers:{Referer:"https://vidmoly.to/"}});if(!s)return{url:t};let e=yield s.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=A(e));let n=e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(n)return{url:n[1],headers:{Referer:"https://vidmoly.to/"}}}catch(s){}return{url:t}})}function it(t){return d(this,null,function*(){try{let s=yield $(t,{headers:{Referer:"https://uqload.com/"}});if(!s)return{url:t};let e=yield s.text(),n=e.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(n)return{url:n[1],headers:{Referer:"https://uqload.com/"}}}catch(s){}return{url:t}})}function at(t){return d(this,null,function*(){try{let s=yield $(t);if(!s)return{url:t};let e=yield s.text(),n=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(n){let r=yield $(n[1]);r&&(e=yield r.text())}let i=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(i){let r=i[1]||i[0];return r.includes("base64")&&(r=C(r.split(",")[1]||r)),{url:r,headers:{Referer:t}}}}catch(s){}return{url:t}})}function ot(t){return d(this,null,function*(){try{let s=yield $(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=A(e));let n=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(n){let i="https:"+n[1],r=n[2].split("+");for(let o of r){let a=o.match(/['"]([^'"]+)['"]/);if(a){let l=a[1],u=o.match(/substring\((\d+)\)/);u&&(l=l.substring(parseInt(u[1]))),i+=l}}return{url:i,headers:{Referer:"https://streamtape.com/"}}}}catch(s){}return{url:t}})}function ct(t){return d(this,null,function*(){try{let s=yield $(t);if(!s)return{url:t};let e=yield s.text(),n=e.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.mp4[^"']*)["']/);if(n)return{url:n[1]}}catch(s){}return{url:t}})}function lt(t){return d(this,null,function*(){try{let s=yield $(t);if(!s)return{url:t};let e=yield s.text();e.includes("p,a,c,k,e,d")&&(e=A(e));let n=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(n){let i=n[1];return i.includes("base64")&&(i=C(i.split(",")[1]||i)),{url:i,headers:{Referer:t}}}}catch(s){}return{url:t}})}function ut(t){return d(this,null,function*(){try{let s=yield $(t);if(!s)return{url:t};let n=(yield s.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(n)return{url:n[1],headers:{Referer:t}}}catch(s){}return{url:t}})}function ft(t){return d(this,null,function*(){var s;try{let e=((s=t.match(/https?:\/\/([^\/]+)/))==null?void 0:s[1])||"dood.to",n=yield $(t);if(!n)return{url:t};let i=yield n.text();i.includes("eval(function(p,a,c,k,e,d)")&&(i=A(i));let r=i.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(r){let o=r[1],a=`https://${e}/pass_md5/${o}`,l=yield fetch(a,{headers:{Referer:t}});if(l.ok){let u=yield l.text(),c=Math.random().toString(36).substring(2,12);return{url:u+c+"?token="+o+"&expiry="+Date.now(),headers:{Referer:`https://${e}/`}}}}}catch(e){}return{url:t}})}function dt(t){return d(this,null,function*(){try{let s=yield $(t);if(!s)return{url:t};let n=(yield s.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(n)return{url:n[1],headers:{Referer:t}}}catch(s){}return{url:t}})}function F(t,s=0){return d(this,null,function*(){var i;if(s>3)return v(p({},t),{isDirect:!1});let e=t.url,n=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(n.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!n.includes("html"))return v(p({},t),{isDirect:!0});try{let r=null;if(n.includes("sibnet.ru")?r=yield nt(e):n.includes("vidmoly.")?r=yield rt(e):n.includes("uqload.")||n.includes("oneupload.")?r=yield it(e):n.includes("voe.")?r=yield at(e):n.includes("streamtape.com")||n.includes("stape")?r=yield ot(e):n.includes("dood")||n.includes("ds2play")?r=yield ft(e):n.includes("moonplayer")||n.includes("moon.")?r=yield dt(e):n.includes("sendvid.")?r=yield ct(e):n.includes("luluvid.")||n.includes("lulu.")?r=yield lt(e):(n.includes("hgcloud.")||n.includes("savefiles."))&&(r=yield ut(e)),r&&r.url!==e)return v(p({},t),{url:r.url,headers:p(p({},t.headers),r.headers||{}),isDirect:!0,originalUrl:e});if(!r||r.url===e){let o=yield $(e,{headers:t.headers});if(o){let a=yield o.text();a.includes("p,a,c,k,e,d")&&(a=A(a));let l=a.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||a.match(/https?:\/\/[^"']+\.mp4[^"']*/)||a.match(/file\s*:\s*["']([^"']+)["']/);if(l){let u=l[1]||l[0];u.startsWith("//")&&(u="https:"+u),u.startsWith("http")&&!u.includes(ht)&&(r={url:u})}if(!r){let u=a.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(u){let c=u[1];if(c.startsWith("//")&&(c="https:"+c),c.startsWith("/")){let f=(i=e.match(/^https?:\/\/[^\/]+/))==null?void 0:i[0];f&&(c=f+c)}if(c.startsWith("http")&&c!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${c}`),yield F(v(p({},t),{url:c}),s+1)}}}}if(r&&r.url!==e&&r.url.startsWith("http"))return v(p({},t),{url:r.url,headers:p(p({},t.headers),r.headers||{}),isDirect:!0,originalUrl:e})}catch(r){}return v(p({},t),{isDirect:!1})})}var ht="googletagmanager";var mt="https://arm.haglund.dev/api/v2";var pt="https://v3-cinemeta.strem.io";function k(e){return d(this,arguments,function*(t,s={}){try{let n=new AbortController,i=setTimeout(()=>n.abort(),8e3),r=yield fetch(t,v(p({},s),{signal:n.signal}));return clearTimeout(i),r}catch(n){return console.error(`[ArmSync] Fetch failed: ${t}`,n.message),null}})}function L(t,s){return d(this,null,function*(){if(!t)return null;let e=yield k(`${mt}/themoviedb?id=${t}`);if(e)try{let r=yield e.json(),o=Array.isArray(r)?r[0]:r;if(o&&o.imdb)return o.imdb}catch(r){}let n=`https://www.themoviedb.org/${s==="movie"?"movie":"tv"}/${t}`,i=yield k(n);if(i){let o=(yield i.text()).match(/imdb\.com\/title\/(tt\d+)/);if(o)return o[1]}return null})}function P(t,s,e){return d(this,null,function*(){var u;if(!t||s===0)return null;let n=yield k(`${pt}/meta/series/${t}.json`);if(!n)return null;let i=yield n.json();if(!((u=i==null?void 0:i.meta)!=null&&u.videos))return null;let r=i.meta.videos.filter(c=>c.season>0&&c.episode>0).sort((c,f)=>c.season-f.season||c.episode-f.episode),o=[],a=new Set;for(let c of r){let f=`${c.season}-${c.episode}`;a.has(f)||(a.add(f),o.push(c))}let l=o.findIndex(c=>c.season==s&&c.episode==e);if(l!==-1){let c=l+1;return console.log(`[ArmSync] Resolved: S${s}E${e} -> Absolute ${c}`),c}return null})}var q="8265bd1679663a7ea12ac168da84d2e8",W="https://api.themoviedb.org/3";function j(t){return d(this,null,function*(){try{let s=new AbortController,e=setTimeout(()=>s.abort(),8e3),n=yield fetch(t,{headers:{"User-Agent":"Mozilla/5.0",Accept:"application/json"},signal:s.signal});return clearTimeout(e),n.ok?n:null}catch(s){return null}})}function I(t,s){return d(this,null,function*(){var i,r,o,a,l,u;let e=s==="movie"?"movie":"tv",n=[];try{let c=`${W}/${e}/${t}?api_key=${q}&language=en-US`,f=yield j(c);if(f){let g=yield f.json(),w=(i=e==="movie"?g.title:g.name)==null?void 0:i.trim(),y=(r=e==="movie"?g.original_title:g.original_name)==null?void 0:r.trim();w&&n.push(w),y&&y!==w&&/^[\x00-\x7F\u00C0-\u024F\s]+$/.test(y)&&n.push(y)}let h=`${W}/${e}/${t}/translations?api_key=${q}`,m=yield j(h);if(m){let w=((yield m.json()).translations||[]).find(x=>x.iso_639_1==="fr"),y=((a=(o=w==null?void 0:w.data)==null?void 0:o.name)==null?void 0:a.trim())||((u=(l=w==null?void 0:w.data)==null?void 0:l.title)==null?void 0:u.trim());y&&!n.includes(y)&&n.push(y)}}catch(c){console.error(`[Metadata] TMDB API error: ${c.message}`)}return console.log(`[Metadata] Titles for ${t}: ${n.join(" | ")}`),n})}var D="https://animevostfr.org";function gt(t){return d(this,null,function*(){try{let s=yield R(`${D}/?s=${encodeURIComponent(t)}`),e=b.load(s),n=[];e("a").each((u,c)=>{let f=e(c).attr("href")||"",h=e(c).text().trim();f.includes("/animes/")&&h.length>2&&n.push({title:h,url:f})});let i=new Set,r=n.filter(u=>i.has(u.url)?!1:(i.add(u.url),!0));console.log(`[AnimeVOSTFR] Search results: ${r.length}`);let o=u=>u.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),a=o(t),l=r.filter(u=>o(u.title).includes(a));return l.length===0&&r.length>0&&(console.log(`[AnimeVOSTFR] No exact match for "${t}", falling back to ${r.length} search results`),l=r),l.length>0&&console.log(`[AnimeVOSTFR] Found ${l.length} matches for ${t}`),l}catch(s){return console.error(`[AnimeVOSTFR] Search error: ${s.message}`),[]}})}function wt(t,s,e,n=!1){return d(this,null,function*(){try{let i=yield R(t),r=b.load(i),o=[];r('a[href*="/episode/"]').each((f,h)=>{let m=r(h).attr("href")||"",g=r(h).text().trim();o.push({url:m,text:g})}),console.log(`[AnimeVOSTFR] Found ${o.length} episode links`);let a=String(e),l=a.padStart(2,"0"),u=[new RegExp(`-saison-${s}-episode-${a}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-saison-${s}-episode-${l}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-episode-${a}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-episode-${l}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-ep-${a}(?:-vostfr|-vf|/|$)`,"i"),new RegExp(`-ep-${l}(?:-vostfr|-vf|/|$)`,"i")];for(let f of u){let h=o.find(m=>{if(!f.test(m.url))return!1;if(!n){let g=m.url.match(/-(?:saison-)?(\d+)-episode-/i);if(g&&parseInt(g[1])!==s)return!1}return!0});if(h)return console.log(`[AnimeVOSTFR] Found episode in URL: ${h.url}`),h.url}let c=[new RegExp(`^\\s*Episode\\s+${a}\\s*$`,"i"),new RegExp(`^\\s*Ep\\s*${a}\\s*$`,"i"),new RegExp(`(?:^|[^0-9])${a}(?:$|[^0-9])`)];for(let f of c){let h=o.find(m=>{if(!f.test(m.text))return!1;if(!n){let g=m.url.match(/-(?:saison-)?(\d+)-episode-/i);if(g&&parseInt(g[1])!==s)return!1}return!0});if(h)return console.log(`[AnimeVOSTFR] Found episode in text: ${h.url}`),h.url}return null}catch(i){return console.error(`[AnimeVOSTFR] Error finding episode: ${i.message}`),null}})}function yt(t){return d(this,null,function*(){let s=[];try{let e=yield R(t),n=b.load(e),i=[];n(".TPlayerNv li").each((o,a)=>{i.push(n(a).text().trim())});let r=[];n(".TPlayerTb").each((o,a)=>{let l=n(a).find("iframe"),u=n(a).find(".lazy-player");l.length&&l.attr("src")?r.push(l.attr("src")):u.length&&u.attr("data-src")&&r.push(u.attr("data-src"))}),console.log(`[AnimeVOSTFR] Found ${r.length} player tabs`);for(let o=0;o<r.length;o++)try{let a=r[o];a.startsWith("/")&&(a=D+a);let l=yield R(a),c=b.load(l)("iframe").attr("src");if(c&&c.startsWith("http")){let f=i[o]||`Lecteur ${o+1}`,h=$t(c),m=yield F({name:"AnimeVOSTFR",title:`${h} (${f})`,url:c,quality:"HD",headers:{Referer:D}});s.push(m)}}catch(a){console.error(`[AnimeVOSTFR] Failed to resolve player ${o}: ${a.message}`)}}catch(e){console.error(`[AnimeVOSTFR] Error extracting players: ${e.message}`)}return s})}function $t(t){return t.includes("sibnet")?"Sibnet":t.includes("vidmoly")?"Vidmoly":t.includes("christopheruntilpoint")||t.includes("voe")?"Voe":t.includes("luluvid")?"Luluvid":t.includes("savefiles")?"Savefiles":t.includes("uqload")||t.includes("oneupload")?"Uqload":t.includes("hgcloud")?"HGCloud":t.includes("dood")||t.includes("ds2play")?"Doodstream":t.includes("myvi")||t.includes("mytv")?"MyVi":t.includes("sendvid")?"Sendvid":t.includes("stape")||t.includes("streamtape")?"Streamtape":t.includes("moon")?"Moon":"Player"}function N(t,s,e,n){return d(this,null,function*(){let i=yield I(t,s);if(i.length===0)return[];let r=[n];try{let f=yield L(t,s);if(f){let h=yield P(f,e,n);h&&h!==n&&r.push(h)}}catch(f){console.warn(`[AnimeVOSTFR] ArmSync failed: ${f.message}`)}let o=[];for(let f of i)if(o=yield gt(f),o&&o.length>0)break;if(!o||o.length===0)return[];o=o.sort((f,h)=>{let m=f.title.toLowerCase(),g=h.title.toLowerCase(),w=`saison ${e}`,y=m.includes(w),x=g.includes(w);return y&&!x?-1:!y&&x?1:0});let a=[],l=new Set,u=new Set;for(let f of o){if(u.has(f.url))continue;u.add(f.url);let h=f.title.toLowerCase(),g=h.includes(" vf")||f.url.includes("vf")?"VF":"VOSTFR",w=h.match(/saison\s*(\d+)/);if(!(w&&parseInt(w[1])!==e&&r.length===1))for(let y of r){let x=y!==n,T=yield wt(f.url,e,y,x);if(T&&!l.has(T)){l.add(T);let M=yield yt(T),H=y===n?"":` (Abs ${y})`;M.forEach(E=>{E.name.includes("(")||(E.name=`AnimeVOSTFR (${g})`),E.title=`${E.title}${H}`}),a.push(...M)}}}a.length===0&&console.warn(`[AnimeVOSTFR] Episode S${e}E${n} not found (targets: ${r.join(", ")})`);let c=a.filter(f=>f&&f.isDirect);return console.log(`[AnimeVOSTFR] Total streams found: ${c.length}`),c})}function vt(t,s,e,n){return d(this,null,function*(){console.log(`[AnimeVOSTFR] Request: ${s} ${t} S${e}E${n}`);try{return yield N(t,s,e,n)}catch(i){return console.error("[AnimeVOSTFR] Error:",i),[]}})}
