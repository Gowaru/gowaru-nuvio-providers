/**
 * animevostfr - Built from src/animevostfr/
 * Generated: 2026-02-25T16:19:28.004Z
 */
var q=Object.create;var $=Object.defineProperty,U=Object.defineProperties,L=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertyNames,S=Object.getOwnPropertySymbols,H=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var b=(e,t,s)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,d=(e,t)=>{for(var s in t||(t={}))A.call(t,s)&&b(e,s,t[s]);if(S)for(var s of S(t))I.call(t,s)&&b(e,s,t[s]);return e},f=(e,t)=>U(e,j(t));var P=(e,t)=>{for(var s in t)$(e,s,{get:t[s],enumerable:!0})},R=(e,t,s,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of W(t))!A.call(e,n)&&n!==s&&$(e,n,{get:()=>t[n],enumerable:!(r=L(t,n))||r.enumerable});return e};var N=(e,t,s)=>(s=e!=null?q(H(e)):{},R(t||!e||!e.__esModule?$(s,"default",{value:e,enumerable:!0}):s,e)),_=e=>R($({},"__esModule",{value:!0}),e);var h=(e,t,s)=>new Promise((r,n)=>{var o=a=>{try{c(s.next(a))}catch(i){n(i)}},l=a=>{try{c(s.throw(a))}catch(i){n(i)}},c=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,l);c((s=s.apply(e,t)).next())});var le={};P(le,{getStreams:()=>ce});module.exports=_(le);var z={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function w(s){return h(this,arguments,function*(e,t={}){console.log(`[AnimeVOSTFR] Fetching: ${e}`);let r=yield fetch(e,d({headers:d(d({},z),t.headers)},t));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${e}`);return yield r.text()})}var v=N(require("cheerio"));var T={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"};function y(s){return h(this,arguments,function*(e,t={}){try{let r=yield fetch(e,f(d({},t),{headers:d(d({},T),t.headers),redirect:"follow"}));if(!r.ok)return null;let n=yield r.text(),o={};r.headers&&r.headers.forEach((c,a)=>{o[a.toLowerCase()]=c});let l=n.match(/window\.location\.(?:replace|href)\s*\(['"]([^'"]+)['"]\)/i);if(l){let c=l[1];c.startsWith("/")&&(c=e.match(/https?:\/\/[^\/]+/)[0]+c);let a=o["set-cookie"]||"",i=yield fetch(c,f(d({},t),{headers:d(f(d({},T),{Referer:e,Cookie:a}),t.headers)}));if(i.ok){let u=yield i.text(),m={};return i.headers&&i.headers.forEach((g,x)=>m[x.toLowerCase()]=g),{text:()=>Promise.resolve(u),ok:!0,url:i.url,headers:d(d({},o),m)}}}return{text:()=>Promise.resolve(n),ok:!0,url:r.url,headers:o}}catch(r){return null}})}function p(e){if(!e)return"";let t=e["set-cookie"];return t?Array.isArray(t)?t.map(s=>s.split(";")[0]).join("; "):t.split(";")[0]:""}function C(e){try{if(!e.includes("p,a,c,k,e,d"))return e;let t=e.match(/}\s*\((.*)\)\s*$/);if(!t)return e;let s=t[1].match(/(".+"|\d+)/g);if(s.length<4)return e;let[r,n,o,l]=[s[0].replace(/^"|"$/g,""),parseInt(s[1]),parseInt(s[2]),s[3].replace(/^"|"$/g,"").split("|")],c=i=>(i<n?"":c(parseInt(i/n)))+((i=i%n)>35?String.fromCharCode(i+29):i.toString(36)),a={};for(;o--;)a[c(o)]=l[o]||c(o);return r.replace(/\b\w+\b/g,i=>a[i]||i)}catch(t){return e}}function B(s){return h(this,arguments,function*(e,t={}){try{let r=yield fetch(e,{method:"GET",headers:f(d({},t),{Range:"bytes=0-1"})});if(r.status===200||r.status===206){let n=r.headers.get("content-type")||"";return n.includes("video")||n.includes("mpegurl")||n.includes("application/octet-stream")}return!1}catch(r){return!1}})}function K(e){return h(this,null,function*(){try{let t=yield y(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!t)return{url:e};let s=yield t.text(),r=p(t.headers),n=s.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||s.match(/"url"\s*:\s*"([^"]+\.mp4)"/)||s.match(/video_url\s*:\s*'([^']+)'/);if(n){let o=n[1];return o.startsWith("//")?o="https:"+o:o.startsWith("/")&&(o="https://video.sibnet.ru"+o),{url:o,headers:{Cookie:r}}}}catch(t){}return{url:e}})}function G(e){return h(this,null,function*(){try{let t=yield y(e,{headers:{Referer:"https://vidmoly.to/"}});if(!t)return{url:e};let s=yield t.text(),r=p(t.headers);s.includes("eval(function(p,a,c,k,e,d)")&&(s=C(s));let n=s.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/)||s.match(/sources\s*:\s*\[\s*\{\s*file\s*:\s*["']([^"']+)["']/)||s.match(/["']?file["']?\s*:\s*["']([^"']+)["']/);if(n)return{url:n[1],headers:{Cookie:r}}}catch(t){}return{url:e}})}function J(e){return h(this,null,function*(){try{let t=yield y(e,{headers:{Referer:"https://uqload.com/"}});if(!t)return{url:e};let s=yield t.text(),r=p(t.headers),n=s.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||s.match(/src\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/)||s.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/)||s.match(/vurl\s*=\s*["']([^"']+)["']/);if(n)return{url:n[1],headers:{Cookie:r}}}catch(t){}return{url:e}})}function F(e){return h(this,null,function*(){try{let t=yield y(e);if(!t)return{url:e};let s=yield t.text(),r=p(t.headers),n=s.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(n)return F(n[1]);let o=s.match(/'hls'\s*:\s*'([^']+)'/)||s.match(/"hls"\s*:\s*"([^"]+)"/)||s.match(/file\s*:\s*['"]([^'"]+\.m3u8[^'"]*)['"]/);if(o){let c=o[1];if(c.includes("base64"))try{let a=c.split(",")[1]||c;c=atob(a)}catch(a){}return{url:c,headers:{Cookie:r}}}let l=s.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(l)return{url:l[0],headers:{Cookie:r}}}catch(t){}return{url:e}})}function Q(e){return h(this,null,function*(){try{let t=yield y(e);if(!t)return{url:e};let s=yield t.text(),r=p(t.headers),n=s.match(/document\.getElementById\(['"]robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*(?:['"]([^'"]+)['"]|['"]([^'"]+)['"]\.substring\(\d+\))/);if(n){let c=n[1],a=n[2]||"";if(n[3]){let i=s.match(/substring\((\d+)\)/),u=i?parseInt(i[1]):0;a=n[3].substring(u)}return{url:"https:"+c+a,headers:{Cookie:r}}}let o=s.match(/id=['"]robotlink['"]>([^<]+)/);if(o)return{url:"https:"+o[1],headers:{Cookie:r}};let l=s.match(/get_video\?id=[^&'"]+/);if(l)return{url:"https://streamtape.com/"+l[0],headers:{Cookie:r}}}catch(t){}return{url:e}})}function X(e){return h(this,null,function*(){try{let t=e.match(/https?:\/\/([^\/]+)/);if(!t)return{url:e};let s=t[1],r=yield y(e);if(!r)return{url:e};let n=yield r.text(),o=p(r.headers);n.includes("eval(function(p,a,c,k,e,d)")&&(n=C(n));let l=n.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(l){let c=l[1],a=`https://${s}/pass_md5/${c}`,i=yield fetch(a,{headers:{Referer:e,Cookie:o}});if(i.ok){let u=yield i.text(),m=p({"set-cookie":i.headers.get("set-cookie")}),g=[o,m].filter(Boolean).join("; ");return{url:u+"z762vpz?token="+c+"&expiry="+Date.now(),headers:{Cookie:g}}}}}catch(t){}return{url:e}})}function Y(e){return h(this,null,function*(){try{let t=yield y(e);if(!t)return{url:e};let s=yield t.text(),r=p(t.headers),n=s.match(/source\s*src=['"]([^'"]+\.mp4)['"]/)||s.match(/content=['"]([^'"]+\.mp4)['"]/)||s.match(/video_url\s*:\s*['"]([^'"]+)['"]/);if(n)return{url:n[1],headers:{Cookie:r}}}catch(t){}return{url:e}})}function Z(e){return h(this,null,function*(){try{let t=yield y(e);if(!t)return{url:e};let s=yield t.text(),r=p(t.headers),n=s.match(/vurl=["']([^"']+)["']/)||s.match(/file\s*:\s*["']([^"']+)["']/)||s.match(/["']?url["']?\s*:\s*["']([^"']+)["']/);if(n){let o=n[1];return o.startsWith("//")&&(o="https:"+o),{url:o,headers:{Cookie:r}}}}catch(t){}return{url:e}})}function ee(e){return h(this,null,function*(){try{let t=yield y(e);if(!t)return{url:e};let s=yield t.text(),r=p(t.headers),n=s.match(/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/)||s.match(/file\s*:\s*["']([^"']+\.mp4[^"']*)["']/);if(n)return{url:n[1],headers:{Cookie:r}}}catch(t){}return{url:e}})}function E(e){return h(this,null,function*(){let t=e.url,s=t.toLowerCase();if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return f(d({},e),{isDirect:!0});try{let r={url:t,headers:d({},e.headers)};if(s.includes("sibnet.ru"))r=yield K(t),r.headers=f(d({},r.headers),{Referer:"https://video.sibnet.ru/"});else if(s.includes("vidmoly."))r=yield G(t),r.headers=f(d({},r.headers),{Referer:"https://vidmoly.to/"});else if(s.includes("uqload.")||s.includes("oneupload."))r=yield J(t),r.headers=f(d({},r.headers),{Referer:"https://uqload.com/"});else if(s.includes("voe."))r=yield F(t);else if(s.includes("streamtape.com")||s.includes("stape"))r=yield Q(t);else if(s.includes("dood")||s.includes("ds2play"))r=yield X(t);else if(s.includes("sendvid.com"))r=yield Y(t);else if(s.includes("myvi.")||s.includes("mytv"))r=yield Z(t);else if(s.includes("moonplayer")||s.includes("moon."))r=yield ee(t);else{let n=yield y(t);if(n){let o=yield n.text(),l=p(n.headers),c=o.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||o.match(/https?:\/\/[^"']+\.mp4[^"']*/);c&&(r={url:c[0],headers:{Cookie:l}})}}if(r.url!==t&&r.url.startsWith("http"))return console.log("[Resolver] Successfully resolved: "+t.substring(0,30)+"..."),(yield B(r.url,d(d({},e.headers),r.headers)))?f(d({},e),{url:r.url,isDirect:!0,headers:d(d({},e.headers),r.headers),originalUrl:t}):(console.log("[Resolver] Stream validation failed for: "+r.url.substring(0,30)),f(d({},e),{isDirect:!1,error:"Link expired or invalid"}))}catch(r){console.error("[Resolver] Failed for "+t+":",r.message)}return f(d({},e),{isDirect:!1})})}var te="https://arm.haglund.dev/api/v2";var se="https://v3-cinemeta.strem.io";function V(s){return h(this,arguments,function*(e,t={}){try{let r=new AbortController,n=setTimeout(()=>r.abort(),8e3),o=yield fetch(e,f(d({},t),{signal:r.signal}));return clearTimeout(n),o}catch(r){return console.error(`[ArmSync] Fetch failed: ${e}`,r.message),null}})}function D(e,t){return h(this,null,function*(){if(!e)return null;let s=yield V(`${te}/themoviedb?id=${e}`);if(s){let r=yield s.json(),n=Array.isArray(r)?r[0]:r;if(n&&n.imdb)return n.imdb}return null})}function M(e,t,s){return h(this,null,function*(){var c;if(!e||t===0)return null;let r=yield V(`${se}/meta/series/${e}.json`);if(!r)return null;let n=yield r.json();if(!((c=n==null?void 0:n.meta)!=null&&c.videos))return null;let l=n.meta.videos.filter(a=>a.season>0).sort((a,i)=>a.season-i.season||a.episode-i.episode).findIndex(a=>a.season==t&&a.episode==s);if(l!==-1){let a=l+1;return console.log(`[ArmSync] Resolved: S${t}E${s} -> Absolute ${a}`),a}return null})}var k="https://animevostfr.org";function re(e,t){return h(this,null,function*(){try{let s=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,r=yield w(s),n=v.default.load(r),o=n('meta[property="og:title"]').attr("content")||n("h1").first().text()||n("h2").first().text();return o&&o.includes(" (")&&(o=o.split(" (")[0]),o&&o.includes(" - ")&&(o=o.split(" - ")[0]),o=o?o.trim():null,console.log(`[AnimeVOSTFR] TMDB Title found: ${o}`),o}catch(s){return console.error(`[AnimeVOSTFR] Failed to get title from TMDB: ${s.message}`),null}})}function ne(e){return h(this,null,function*(){try{let t=yield w(`${k}/?s=${encodeURIComponent(e)}`),s=v.default.load(t),r=[];s("a").each((i,u)=>{let m=s(u).attr("href")||"",g=s(u).text().trim();m.includes("/animes/")&&g.length>2&&r.push({title:g,url:m})});let n=new Set,o=r.filter(i=>n.has(i.url)?!1:(n.add(i.url),!0));console.log(`[AnimeVOSTFR] Search results: ${o.length}`);let l=i=>i.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),c=l(e),a=o.find(i=>l(i.title).includes(c)&&(i.url.includes("vostfr")||i.url.includes("voir-")));return a||(a=o.find(i=>l(i.title).includes(c))),!a&&o.length>0&&(a=o[0]),a&&console.log(`[AnimeVOSTFR] Selected: ${a.title} -> ${a.url}`),a||null}catch(t){return console.error(`[AnimeVOSTFR] Search error: ${t.message}`),null}})}function oe(e,t,s){return h(this,null,function*(){try{let r=yield w(e),n=v.default.load(r),o=[];n('a[href*="/episode/"]').each((i,u)=>{let m=n(u).attr("href")||"",g=n(u).text().trim();o.push({url:m,text:g})}),console.log(`[AnimeVOSTFR] Found ${o.length} episode links`);let l=[`episode-${s}/`,`episode-${s}`,`saison-${t}-episode-${s}`,`-${t}-episode-${s}`];for(let i of l){let u=o.find(m=>m.url.includes(i));if(u)return console.log(`[AnimeVOSTFR] Found episode: ${u.url}`),u.url}let c=String(s).padStart(1,"0"),a=o.find(i=>{let u=i.url.toLowerCase();return u.includes(`episode-${c}/`)||u.includes(`episode-${c}`)});return a?(console.log(`[AnimeVOSTFR] Found episode (fallback): ${a.url}`),a.url):null}catch(r){return console.error(`[AnimeVOSTFR] Error finding episode: ${r.message}`),null}})}function ie(e){return h(this,null,function*(){let t=[];try{let s=yield w(e),r=v.default.load(s),n=[];r(".TPlayerNv li").each((l,c)=>{n.push(r(c).text().trim())});let o=[];r(".TPlayerTb").each((l,c)=>{let a=r(c).find("iframe"),i=r(c).find(".lazy-player");a.length&&a.attr("src")?o.push(a.attr("src")):i.length&&i.attr("data-src")&&o.push(i.attr("data-src"))}),console.log(`[AnimeVOSTFR] Found ${o.length} player tabs`);for(let l=0;l<o.length;l++)try{let c=o[l];c.startsWith("/")&&(c=k+c);let a=yield w(c),u=v.default.load(a)("iframe").attr("src");if(u&&u.startsWith("http")){let m=n[l]||`Lecteur ${l+1}`,g=ae(u),x=yield E({name:"AnimeVOSTFR",title:`${g} (${m})`,url:u,quality:"HD",headers:{Referer:k}});t.push(x)}}catch(c){console.error(`[AnimeVOSTFR] Failed to resolve player ${l}: ${c.message}`)}}catch(s){console.error(`[AnimeVOSTFR] Error extracting players: ${s.message}`)}return t})}function ae(e){return e.includes("sibnet")?"Sibnet":e.includes("vidmoly")?"Vidmoly":e.includes("christopheruntilpoint")||e.includes("voe")?"Voe":e.includes("luluvid")?"Luluvid":e.includes("savefiles")?"Savefiles":e.includes("uqload")||e.includes("oneupload")?"Uqload":e.includes("hgcloud")?"HGCloud":e.includes("dood")||e.includes("ds2play")?"Doodstream":e.includes("myvi")||e.includes("mytv")?"MyVi":e.includes("sendvid")?"Sendvid":e.includes("stape")||e.includes("streamtape")?"Streamtape":e.includes("moon")?"Moon":"Player"}function O(e,t,s,r){return h(this,null,function*(){let n=yield re(e,t);if(!n)return[];let o=[r];try{let i=yield D(e,t);if(i){let u=yield M(i,s,r);u&&o.push(u)}}catch(i){console.warn(`[AnimeVOSTFR] ArmSync failed: ${i.message}`)}let l=yield ne(n);if(!l)return[];let c=[],a=new Set;for(let i of o){let u=yield oe(l.url,s,i);if(u&&!a.has(u)){a.add(u);let m=yield ie(u);c.push(...m)}}return c.length===0&&console.warn(`[AnimeVOSTFR] Episode S${s}E${r} not found (targets: ${o.join(", ")})`),console.log(`[AnimeVOSTFR] Total streams found: ${c.length}`),c})}function ce(e,t,s,r){return h(this,null,function*(){console.log(`[AnimeVOSTFR] Request: ${t} ${e} S${s}E${r}`);try{return yield O(e,t,s,r)}catch(n){return console.error("[AnimeVOSTFR] Error:",n),[]}})}
