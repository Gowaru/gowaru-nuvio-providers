/**
 * animevostfr - Built from src/animevostfr/
 * Generated: 2026-02-25T17:10:18.106Z
 */
var M=Object.create;var $=Object.defineProperty,O=Object.defineProperties,U=Object.getOwnPropertyDescriptor,q=Object.getOwnPropertyDescriptors,C=Object.getOwnPropertyNames,x=Object.getOwnPropertySymbols,L=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var b=(t,e,n)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,f=(t,e)=>{for(var n in e||(e={}))A.call(e,n)&&b(t,n,e[n]);if(x)for(var n of x(e))j.call(e,n)&&b(t,n,e[n]);return t},p=(t,e)=>O(t,q(e));var N=(t,e)=>{for(var n in e)$(t,n,{get:e[n],enumerable:!0})},R=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of C(e))!A.call(t,i)&&i!==n&&$(t,i,{get:()=>e[i],enumerable:!(r=U(e,i))||r.enumerable});return t};var P=(t,e,n)=>(n=t!=null?M(L(t)):{},R(e||!t||!t.__esModule?$(n,"default",{value:t,enumerable:!0}):n,t)),I=t=>R($({},"__esModule",{value:!0}),t);var m=(t,e,n)=>new Promise((r,i)=>{var s=c=>{try{u(n.next(c))}catch(o){i(o)}},l=c=>{try{u(n.throw(c))}catch(o){i(o)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,l);u((n=n.apply(t,e)).next())});var ot={};N(ot,{getStreams:()=>it});module.exports=I(ot);var W={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function y(n){return m(this,arguments,function*(t,e={}){console.log(`[AnimeVOSTFR] Fetching: ${t}`);let r=yield fetch(t,f({headers:f(f({},W),e.headers)},e));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${t}`);return yield r.text()})}var g=P(require("cheerio"));var H={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"},_=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(e){return t}};function h(n){return m(this,arguments,function*(t,e={}){try{let r=yield fetch(t,p(f({},e),{headers:f(f({},H),e.headers),redirect:"follow"}));if(!r.ok)return null;let i=yield r.text();return{text:()=>Promise.resolve(i),ok:!0,url:r.url,headers:r.headers}}catch(r){return null}})}function T(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let e=t.match(/}\s*\((.*)\)\s*$/);if(!e)return t;let n=e[1].match(/(".+"|\d+)/g);if(n.length<4)return t;let[r,i,s,l]=[n[0].replace(/^"|"$/g,""),parseInt(n[1]),parseInt(n[2]),n[3].replace(/^"|"$/g,"").split("|")],u=o=>(o<i?"":u(parseInt(o/i)))+((o=o%i)>35?String.fromCharCode(o+29):o.toString(36)),c={};for(;s--;)c[u(s)]=l[s]||u(s);return r.replace(/\b\w+\b/g,o=>c[o]||o)}catch(e){return t}}function z(t){return m(this,null,function*(){try{let e=yield h(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!e)return{url:t};let n=yield e.text(),r=n.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||n.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let i=r[1];return i.startsWith("//")&&(i="https:"+i),{url:i,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(e){}return{url:t}})}function K(t){return m(this,null,function*(){try{let e=yield h(t,{headers:{Referer:"https://vidmoly.to/"}});if(!e)return{url:t};let n=yield e.text();n.includes("eval(function(p,a,c,k,e,d)")&&(n=T(n));let r=n.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(e){}return{url:t}})}function B(t){return m(this,null,function*(){try{let e=yield h(t,{headers:{Referer:"https://uqload.com/"}});if(!e)return{url:t};let n=yield e.text(),r=n.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||n.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(r)return{url:r[1],headers:{Referer:"https://uqload.com/"}}}catch(e){}return{url:t}})}function G(t){return m(this,null,function*(){try{let e=yield h(t);if(!e)return{url:t};let n=yield e.text(),r=n.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r){let s=yield h(r[1]);s&&(n=yield s.text())}let i=n.match(/'hls'\s*:\s*'([^']+)'/)||n.match(/"hls"\s*:\s*"([^"]+)"/)||n.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(i){let s=i[1]||i[0];return s.includes("base64")&&(s=_(s.split(",")[1]||s)),{url:s}}}catch(e){}return{url:t}})}function J(t){return m(this,null,function*(){try{let e=yield h(t);if(!e)return{url:t};let r=(yield e.text()).match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(r){let i="https:"+r[1],s=r[2].split("+");for(let l of s){let u=l.match(/['"]([^'"]+)['"]/);if(u){let c=u[1],o=l.match(/substring\((\d+)\)/);o&&(c=c.substring(parseInt(o[1]))),i+=c}}return{url:i}}}catch(e){}return{url:t}})}function Q(t){return m(this,null,function*(){var e;try{let n=((e=t.match(/https?:\/\/([^\/]+)/))==null?void 0:e[1])||"dood.to",r=yield h(t);if(!r)return{url:t};let i=yield r.text();i.includes("eval(function(p,a,c,k,e,d)")&&(i=T(i));let s=i.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(s){let l=s[1],u=`https://${n}/pass_md5/${l}`,c=yield fetch(u,{headers:{Referer:t}});if(c.ok){let o=yield c.text(),a=Math.random().toString(36).substring(2,12);return{url:o+a+"?token="+l+"&expiry="+Date.now()}}}}catch(n){}return{url:t}})}function X(t){return m(this,null,function*(){try{let e=yield h(t);if(!e)return{url:t};let r=(yield e.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(r)return{url:r[1]}}catch(e){}return{url:t}})}function F(t){return m(this,null,function*(){let e=t.url,n=e.toLowerCase();if(n.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return p(f({},t),{isDirect:!0});try{let r=null;if(n.includes("sibnet.ru"))r=yield z(e);else if(n.includes("vidmoly."))r=yield K(e);else if(n.includes("uqload.")||n.includes("oneupload."))r=yield B(e);else if(n.includes("voe."))r=yield G(e);else if(n.includes("streamtape.com")||n.includes("stape"))r=yield J(e);else if(n.includes("dood")||n.includes("ds2play"))r=yield Q(e);else if(n.includes("moonplayer")||n.includes("moon."))r=yield X(e);else{let i=yield h(e);if(i){let s=yield i.text(),l=s.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||s.match(/https?:\/\/[^"']+\.mp4[^"']*/);l&&(r={url:l[0]})}}if(r&&r.url!==e&&r.url.startsWith("http"))return p(f({},t),{url:r.url,isDirect:!0,headers:f(f({},t.headers),r.headers||{}),originalUrl:e})}catch(r){}return p(f({},t),{isDirect:!1})})}var Y="https://arm.haglund.dev/api/v2";var Z="https://v3-cinemeta.strem.io";function v(n){return m(this,arguments,function*(t,e={}){try{let r=new AbortController,i=setTimeout(()=>r.abort(),8e3),s=yield fetch(t,p(f({},e),{signal:r.signal}));return clearTimeout(i),s}catch(r){return console.error(`[ArmSync] Fetch failed: ${t}`,r.message),null}})}function E(t,e){return m(this,null,function*(){if(!t)return null;let n=yield v(`${Y}/themoviedb?id=${t}`);if(n)try{let s=yield n.json(),l=Array.isArray(s)?s[0]:s;if(l&&l.imdb)return l.imdb}catch(s){}let r=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}`,i=yield v(r);if(i){let l=(yield i.text()).match(/imdb\.com\/title\/(tt\d+)/);if(l)return l[1]}return null})}function k(t,e,n){return m(this,null,function*(){var o;if(!t||e===0)return null;let r=yield v(`${Z}/meta/series/${t}.json`);if(!r)return null;let i=yield r.json();if(!((o=i==null?void 0:i.meta)!=null&&o.videos))return null;let s=i.meta.videos.filter(a=>a.season>0&&a.episode>0).sort((a,d)=>a.season-d.season||a.episode-d.episode),l=[],u=new Set;for(let a of s){let d=`${a.season}-${a.episode}`;u.has(d)||(u.add(d),l.push(a))}let c=l.findIndex(a=>a.season==e&&a.episode==n);if(c!==-1){let a=c+1;return console.log(`[ArmSync] Resolved: S${e}E${n} -> Absolute ${a}`),a}return null})}var S="https://animevostfr.org";function tt(t,e){return m(this,null,function*(){try{let n=`https://www.themoviedb.org/${e==="movie"?"movie":"tv"}/${t}?language=en-US`,r=yield y(n),i=g.default.load(r),s=i('meta[property="og:title"]').attr("content")||i("h1").first().text()||i("h2").first().text();return s&&s.includes(" (")&&(s=s.split(" (")[0]),s&&s.includes(" - ")&&(s=s.split(" - ")[0]),s=s?s.trim():null,console.log(`[AnimeVOSTFR] TMDB Title found: ${s}`),s}catch(n){return console.error(`[AnimeVOSTFR] Failed to get title from TMDB: ${n.message}`),null}})}function et(t){return m(this,null,function*(){try{let e=yield y(`${S}/?s=${encodeURIComponent(t)}`),n=g.default.load(e),r=[];n("a").each((o,a)=>{let d=n(a).attr("href")||"",w=n(a).text().trim();d.includes("/animes/")&&w.length>2&&r.push({title:w,url:d})});let i=new Set,s=r.filter(o=>i.has(o.url)?!1:(i.add(o.url),!0));console.log(`[AnimeVOSTFR] Search results: ${s.length}`);let l=o=>o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),u=l(t),c=s.find(o=>l(o.title).includes(u)&&(o.url.includes("vostfr")||o.url.includes("voir-")));return c||(c=s.find(o=>l(o.title).includes(u))),!c&&s.length>0&&(c=s[0]),c&&console.log(`[AnimeVOSTFR] Selected: ${c.title} -> ${c.url}`),c||null}catch(e){return console.error(`[AnimeVOSTFR] Search error: ${e.message}`),null}})}function nt(t,e,n){return m(this,null,function*(){try{let r=yield y(t),i=g.default.load(r),s=[];i('a[href*="/episode/"]').each((o,a)=>{let d=i(a).attr("href")||"",w=i(a).text().trim();s.push({url:d,text:w})}),console.log(`[AnimeVOSTFR] Found ${s.length} episode links`);let l=[`episode-${n}/`,`episode-${n}`,`saison-${e}-episode-${n}`,`-${e}-episode-${n}`];for(let o of l){let a=s.find(d=>d.url.includes(o));if(a)return console.log(`[AnimeVOSTFR] Found episode: ${a.url}`),a.url}let u=String(n).padStart(1,"0"),c=s.find(o=>{let a=o.url.toLowerCase();return a.includes(`episode-${u}/`)||a.includes(`episode-${u}`)});return c?(console.log(`[AnimeVOSTFR] Found episode (fallback): ${c.url}`),c.url):null}catch(r){return console.error(`[AnimeVOSTFR] Error finding episode: ${r.message}`),null}})}function rt(t){return m(this,null,function*(){let e=[];try{let n=yield y(t),r=g.default.load(n),i=[];r(".TPlayerNv li").each((l,u)=>{i.push(r(u).text().trim())});let s=[];r(".TPlayerTb").each((l,u)=>{let c=r(u).find("iframe"),o=r(u).find(".lazy-player");c.length&&c.attr("src")?s.push(c.attr("src")):o.length&&o.attr("data-src")&&s.push(o.attr("data-src"))}),console.log(`[AnimeVOSTFR] Found ${s.length} player tabs`);for(let l=0;l<s.length;l++)try{let u=s[l];u.startsWith("/")&&(u=S+u);let c=yield y(u),a=g.default.load(c)("iframe").attr("src");if(a&&a.startsWith("http")){let d=i[l]||`Lecteur ${l+1}`,w=st(a),V=yield F({name:"AnimeVOSTFR",title:`${w} (${d})`,url:a,quality:"HD",headers:{Referer:S}});e.push(V)}}catch(u){console.error(`[AnimeVOSTFR] Failed to resolve player ${l}: ${u.message}`)}}catch(n){console.error(`[AnimeVOSTFR] Error extracting players: ${n.message}`)}return e})}function st(t){return t.includes("sibnet")?"Sibnet":t.includes("vidmoly")?"Vidmoly":t.includes("christopheruntilpoint")||t.includes("voe")?"Voe":t.includes("luluvid")?"Luluvid":t.includes("savefiles")?"Savefiles":t.includes("uqload")||t.includes("oneupload")?"Uqload":t.includes("hgcloud")?"HGCloud":t.includes("dood")||t.includes("ds2play")?"Doodstream":t.includes("myvi")||t.includes("mytv")?"MyVi":t.includes("sendvid")?"Sendvid":t.includes("stape")||t.includes("streamtape")?"Streamtape":t.includes("moon")?"Moon":"Player"}function D(t,e,n,r){return m(this,null,function*(){let i=yield tt(t,e);if(!i)return[];let s=[r];try{let o=yield E(t,e);if(o){let a=yield k(o,n,r);a&&s.push(a)}}catch(o){console.warn(`[AnimeVOSTFR] ArmSync failed: ${o.message}`)}let l=yield et(i);if(!l)return[];let u=[],c=new Set;for(let o of s){let a=yield nt(l.url,n,o);if(a&&!c.has(a)){c.add(a);let d=yield rt(a);u.push(...d)}}return u.length===0&&console.warn(`[AnimeVOSTFR] Episode S${n}E${r} not found (targets: ${s.join(", ")})`),console.log(`[AnimeVOSTFR] Total streams found: ${u.length}`),u})}function it(t,e,n,r){return m(this,null,function*(){console.log(`[AnimeVOSTFR] Request: ${e} ${t} S${n}E${r}`);try{return yield D(t,e,n,r)}catch(i){return console.error("[AnimeVOSTFR] Error:",i),[]}})}
