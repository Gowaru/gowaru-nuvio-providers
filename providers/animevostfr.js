/**
 * animevostfr - Built from src/animevostfr/
 * Generated: 2026-02-25T16:30:00.212Z
 */
var M=Object.create;var $=Object.defineProperty,C=Object.defineProperties,U=Object.getOwnPropertyDescriptor,L=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertyNames,S=Object.getOwnPropertySymbols,j=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var A=(e,t,n)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f=(e,t)=>{for(var n in t||(t={}))b.call(t,n)&&A(e,n,t[n]);if(S)for(var n of S(t))q.call(t,n)&&A(e,n,t[n]);return e},p=(e,t)=>C(e,L(t));var N=(e,t)=>{for(var n in t)$(e,n,{get:t[n],enumerable:!0})},x=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of I(t))!b.call(e,s)&&s!==n&&$(e,s,{get:()=>t[s],enumerable:!(r=U(t,s))||r.enumerable});return e};var P=(e,t,n)=>(n=e!=null?M(j(e)):{},x(t||!e||!e.__esModule?$(n,"default",{value:e,enumerable:!0}):n,e)),W=e=>x($({},"__esModule",{value:!0}),e);var d=(e,t,n)=>new Promise((r,s)=>{var i=a=>{try{c(n.next(a))}catch(o){s(o)}},l=a=>{try{c(n.throw(a))}catch(o){s(o)}},c=a=>a.done?r(a.value):Promise.resolve(a.value).then(i,l);c((n=n.apply(e,t)).next())});var se={};N(se,{getStreams:()=>re});module.exports=W(se);var H={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function g(n){return d(this,arguments,function*(e,t={}){console.log(`[AnimeVOSTFR] Fetching: ${e}`);let r=yield fetch(e,f({headers:f(f({},H),t.headers)},t));if(!r.ok)throw new Error(`HTTP error ${r.status} for ${e}`);return yield r.text()})}var w=P(require("cheerio"));var z={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"},_=e=>{try{return typeof atob=="function"?atob(e):Buffer.from(e,"base64").toString("binary")}catch(t){return e}};function y(n){return d(this,arguments,function*(e,t={}){try{let r=yield fetch(e,p(f({},t),{headers:f(f({},z),t.headers)}));if(!r.ok)return null;let s=yield r.text(),i=r.headers.get("set-cookie")||"";return{text:()=>Promise.resolve(s),ok:!0,url:r.url,headers:{"set-cookie":i}}}catch(r){return null}})}function T(e){try{if(!e.includes("p,a,c,k,e,d"))return e;let t=e.match(/}\s*\((.*)\)\s*$/);if(!t)return e;let n=t[1].match(/(".+"|\d+)/g);if(n.length<4)return e;let[r,s,i,l]=[n[0].replace(/^"|"$/g,""),parseInt(n[1]),parseInt(n[2]),n[3].replace(/^"|"$/g,"").split("|")],c=o=>(o<s?"":c(parseInt(o/s)))+((o=o%s)>35?String.fromCharCode(o+29):o.toString(36)),a={};for(;i--;)a[c(i)]=l[i]||c(i);return r.replace(/\b\w+\b/g,o=>a[o]||o)}catch(t){return e}}function B(e){return d(this,null,function*(){try{let t=yield y(e,{headers:{Referer:"https://video.sibnet.ru/"}});if(!t)return{url:e};let n=yield t.text(),r=n.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||n.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(r){let s=r[1];return s.startsWith("//")&&(s="https:"+s),{url:s,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(t){}return{url:e}})}function K(e){return d(this,null,function*(){try{let t=yield y(e,{headers:{Referer:"https://vidmoly.to/"}});if(!t)return{url:e};let n=yield t.text();n.includes("eval(function(p,a,c,k,e,d)")&&(n=T(n));let r=n.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(r)return{url:r[1],headers:{Referer:"https://vidmoly.to/"}}}catch(t){}return{url:e}})}function R(e){return d(this,null,function*(){try{let t=yield y(e);if(!t)return{url:e};let n=yield t.text(),r=n.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(r)return R(r[1]);let s=n.match(/'hls'\s*:\s*'([^']+)'/)||n.match(/file\s*:\s*['"]([^'"]+\.m3u8[^'"]*)['"]/);if(s){let i=s[1];return i.includes("base64")&&(i=_(i.split(",")[1]||i)),{url:i}}}catch(t){}return{url:e}})}function G(e){return d(this,null,function*(){try{let t=yield y(e);if(!t)return{url:e};let n=yield t.text(),r=n.match(/document\.getElementById\(['"]robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*(?:['"]([^'"]+)['"]|['"]([^'"]+)['"]\.substring\(\d+\))/);if(r){let s=r[1],i=r[2]||"";if(r[3]){let l=n.match(/substring\((\d+)\)/);i=r[3].substring(l?parseInt(l[1]):0)}return{url:"https:"+s+i}}}catch(t){}return{url:e}})}function J(e){return d(this,null,function*(){var t;try{let n=(t=e.match(/https?:\/\/([^\/]+)/))==null?void 0:t[1],r=yield y(e);if(!r||!n)return{url:e};let s=yield r.text();s.includes("eval(function(p,a,c,k,e,d)")&&(s=T(s));let i=s.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(i){let l=i[1],c=yield fetch(`https://${n}/pass_md5/${l}`,{headers:{Referer:e}});if(c.ok)return{url:(yield c.text())+"z762vpz?token="+l+"&expiry="+Date.now()}}}catch(n){}return{url:e}})}function F(e){return d(this,null,function*(){let t=e.url,n=t.toLowerCase();if(n.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/))return p(f({},e),{isDirect:!0});try{let r={url:t};if(n.includes("sibnet.ru"))r=yield B(t);else if(n.includes("vidmoly."))r=yield K(t);else if(n.includes("voe."))r=yield R(t);else if(n.includes("streamtape.com")||n.includes("stape"))r=yield G(t);else if(n.includes("dood")||n.includes("ds2play"))r=yield J(t);else{let s=yield y(t);if(s){let i=yield s.text(),l=i.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||i.match(/https?:\/\/[^"']+\.mp4[^"']*/);l&&(r={url:l[0]})}}if(r.url!==t&&r.url.startsWith("http"))return p(f({},e),{url:r.url,isDirect:!0,headers:f(f({},e.headers),r.headers||{}),originalUrl:t})}catch(r){}return p(f({},e),{isDirect:!1})})}var Q="https://arm.haglund.dev/api/v2";var X="https://v3-cinemeta.strem.io";function k(n){return d(this,arguments,function*(e,t={}){try{let r=new AbortController,s=setTimeout(()=>r.abort(),8e3),i=yield fetch(e,p(f({},t),{signal:r.signal}));return clearTimeout(s),i}catch(r){return console.error(`[ArmSync] Fetch failed: ${e}`,r.message),null}})}function E(e,t){return d(this,null,function*(){if(!e)return null;let n=yield k(`${Q}/themoviedb?id=${e}`);if(n){let r=yield n.json(),s=Array.isArray(r)?r[0]:r;if(s&&s.imdb)return s.imdb}return null})}function D(e,t,n){return d(this,null,function*(){var c;if(!e||t===0)return null;let r=yield k(`${X}/meta/series/${e}.json`);if(!r)return null;let s=yield r.json();if(!((c=s==null?void 0:s.meta)!=null&&c.videos))return null;let l=s.meta.videos.filter(a=>a.season>0).sort((a,o)=>a.season-o.season||a.episode-o.episode).findIndex(a=>a.season==t&&a.episode==n);if(l!==-1){let a=l+1;return console.log(`[ArmSync] Resolved: S${t}E${n} -> Absolute ${a}`),a}return null})}var v="https://animevostfr.org";function Y(e,t){return d(this,null,function*(){try{let n=`https://www.themoviedb.org/${t==="movie"?"movie":"tv"}/${e}?language=en-US`,r=yield g(n),s=w.default.load(r),i=s('meta[property="og:title"]').attr("content")||s("h1").first().text()||s("h2").first().text();return i&&i.includes(" (")&&(i=i.split(" (")[0]),i&&i.includes(" - ")&&(i=i.split(" - ")[0]),i=i?i.trim():null,console.log(`[AnimeVOSTFR] TMDB Title found: ${i}`),i}catch(n){return console.error(`[AnimeVOSTFR] Failed to get title from TMDB: ${n.message}`),null}})}function Z(e){return d(this,null,function*(){try{let t=yield g(`${v}/?s=${encodeURIComponent(e)}`),n=w.default.load(t),r=[];n("a").each((o,u)=>{let m=n(u).attr("href")||"",h=n(u).text().trim();m.includes("/animes/")&&h.length>2&&r.push({title:h,url:m})});let s=new Set,i=r.filter(o=>s.has(o.url)?!1:(s.add(o.url),!0));console.log(`[AnimeVOSTFR] Search results: ${i.length}`);let l=o=>o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),c=l(e),a=i.find(o=>l(o.title).includes(c)&&(o.url.includes("vostfr")||o.url.includes("voir-")));return a||(a=i.find(o=>l(o.title).includes(c))),!a&&i.length>0&&(a=i[0]),a&&console.log(`[AnimeVOSTFR] Selected: ${a.title} -> ${a.url}`),a||null}catch(t){return console.error(`[AnimeVOSTFR] Search error: ${t.message}`),null}})}function ee(e,t,n){return d(this,null,function*(){try{let r=yield g(e),s=w.default.load(r),i=[];s('a[href*="/episode/"]').each((o,u)=>{let m=s(u).attr("href")||"",h=s(u).text().trim();i.push({url:m,text:h})}),console.log(`[AnimeVOSTFR] Found ${i.length} episode links`);let l=[`episode-${n}/`,`episode-${n}`,`saison-${t}-episode-${n}`,`-${t}-episode-${n}`];for(let o of l){let u=i.find(m=>m.url.includes(o));if(u)return console.log(`[AnimeVOSTFR] Found episode: ${u.url}`),u.url}let c=String(n).padStart(1,"0"),a=i.find(o=>{let u=o.url.toLowerCase();return u.includes(`episode-${c}/`)||u.includes(`episode-${c}`)});return a?(console.log(`[AnimeVOSTFR] Found episode (fallback): ${a.url}`),a.url):null}catch(r){return console.error(`[AnimeVOSTFR] Error finding episode: ${r.message}`),null}})}function te(e){return d(this,null,function*(){let t=[];try{let n=yield g(e),r=w.default.load(n),s=[];r(".TPlayerNv li").each((l,c)=>{s.push(r(c).text().trim())});let i=[];r(".TPlayerTb").each((l,c)=>{let a=r(c).find("iframe"),o=r(c).find(".lazy-player");a.length&&a.attr("src")?i.push(a.attr("src")):o.length&&o.attr("data-src")&&i.push(o.attr("data-src"))}),console.log(`[AnimeVOSTFR] Found ${i.length} player tabs`);for(let l=0;l<i.length;l++)try{let c=i[l];c.startsWith("/")&&(c=v+c);let a=yield g(c),u=w.default.load(a)("iframe").attr("src");if(u&&u.startsWith("http")){let m=s[l]||`Lecteur ${l+1}`,h=ne(u),O=yield F({name:"AnimeVOSTFR",title:`${h} (${m})`,url:u,quality:"HD",headers:{Referer:v}});t.push(O)}}catch(c){console.error(`[AnimeVOSTFR] Failed to resolve player ${l}: ${c.message}`)}}catch(n){console.error(`[AnimeVOSTFR] Error extracting players: ${n.message}`)}return t})}function ne(e){return e.includes("sibnet")?"Sibnet":e.includes("vidmoly")?"Vidmoly":e.includes("christopheruntilpoint")||e.includes("voe")?"Voe":e.includes("luluvid")?"Luluvid":e.includes("savefiles")?"Savefiles":e.includes("uqload")||e.includes("oneupload")?"Uqload":e.includes("hgcloud")?"HGCloud":e.includes("dood")||e.includes("ds2play")?"Doodstream":e.includes("myvi")||e.includes("mytv")?"MyVi":e.includes("sendvid")?"Sendvid":e.includes("stape")||e.includes("streamtape")?"Streamtape":e.includes("moon")?"Moon":"Player"}function V(e,t,n,r){return d(this,null,function*(){let s=yield Y(e,t);if(!s)return[];let i=[r];try{let o=yield E(e,t);if(o){let u=yield D(o,n,r);u&&i.push(u)}}catch(o){console.warn(`[AnimeVOSTFR] ArmSync failed: ${o.message}`)}let l=yield Z(s);if(!l)return[];let c=[],a=new Set;for(let o of i){let u=yield ee(l.url,n,o);if(u&&!a.has(u)){a.add(u);let m=yield te(u);c.push(...m)}}return c.length===0&&console.warn(`[AnimeVOSTFR] Episode S${n}E${r} not found (targets: ${i.join(", ")})`),console.log(`[AnimeVOSTFR] Total streams found: ${c.length}`),c})}function re(e,t,n,r){return d(this,null,function*(){console.log(`[AnimeVOSTFR] Request: ${t} ${e} S${n}E${r}`);try{return yield V(e,t,n,r)}catch(s){return console.error("[AnimeVOSTFR] Error:",s),[]}})}
