/**
 * animevostfr - Built from src/animevostfr/
 * Generated: 2026-02-25T18:32:18.177Z
 */
var N=Object.create;var A=Object.defineProperty,P=Object.defineProperties,I=Object.getOwnPropertyDescriptor,_=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertyNames,V=Object.getOwnPropertySymbols,H=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var D=(t,n,e)=>n in t?A(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,d=(t,n)=>{for(var e in n||(n={}))U.call(n,e)&&D(t,e,n[e]);if(V)for(var e of V(n))B.call(n,e)&&D(t,e,n[e]);return t},p=(t,n)=>P(t,_(n));var z=(t,n)=>{for(var e in n)A(t,e,{get:n[e],enumerable:!0})},M=(t,n,e,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of j(n))!U.call(t,i)&&i!==e&&A(t,i,{get:()=>n[i],enumerable:!(s=I(n,i))||s.enumerable});return t};var K=(t,n,e)=>(e=t!=null?N(H(t)):{},M(n||!t||!t.__esModule?A(e,"default",{value:t,enumerable:!0}):e,t)),G=t=>M(A({},"__esModule",{value:!0}),t);var m=(t,n,e)=>new Promise((s,i)=>{var r=u=>{try{l(e.next(u))}catch(a){i(a)}},c=u=>{try{l(e.throw(u))}catch(a){i(a)}},l=u=>u.done?s(u.value):Promise.resolve(u.value).then(r,c);l((e=e.apply(t,n)).next())});var wt={};z(wt,{getStreams:()=>pt});module.exports=G(wt);var J={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7","Cache-Control":"max-age=0",Connection:"keep-alive"};function $(e){return m(this,arguments,function*(t,n={}){console.log(`[AnimeVOSTFR] Fetching: ${t}`);let s=yield fetch(t,d({headers:d(d({},J),n.headers)},n));if(!s.ok)throw new Error(`HTTP error ${s.status} for ${t}`);return yield s.text()})}var v=K(require("cheerio"));var Q={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"},O=t=>{try{return typeof atob=="function"?atob(t):Buffer.from(t,"base64").toString("binary")}catch(n){return t}};function h(e){return m(this,arguments,function*(t,n={}){try{let s=yield fetch(t,p(d({},n),{headers:d(d({},Q),n.headers),redirect:"follow"}));if(!s.ok)return null;let i=yield s.text();return{text:()=>Promise.resolve(i),ok:!0,url:s.url,headers:s.headers}}catch(s){return null}})}function b(t){try{if(!t.includes("p,a,c,k,e,d"))return t;let n=t.match(/}\s*\((.*)\)\s*$/);if(!n)return t;let e=n[1].match(/(".+"|\d+)/g);if(e.length<4)return t;let[s,i,r,c]=[e[0].replace(/^"|"$/g,""),parseInt(e[1]),parseInt(e[2]),e[3].replace(/^"|"$/g,"").split("|")],l=a=>(a<i?"":l(parseInt(a/i)))+((a=a%i)>35?String.fromCharCode(a+29):a.toString(36)),u={};for(;r--;)u[l(r)]=c[r]||l(r);return s.replace(/\b\w+\b/g,a=>u[a]||a)}catch(n){return t}}function X(t){return m(this,null,function*(){try{let n=yield h(t,{headers:{Referer:"https://video.sibnet.ru/"}});if(!n)return{url:t};let e=yield n.text(),s=e.match(/src\s*:\s*["']([^"']+\.mp4)["']/)||e.match(/"url"\s*:\s*"([^"]+\.mp4)"/);if(s){let i=s[1];return i.startsWith("//")&&(i="https:"+i),{url:i,headers:{Referer:"https://video.sibnet.ru/"}}}}catch(n){}return{url:t}})}function Y(t){return m(this,null,function*(){try{let n=yield h(t,{headers:{Referer:"https://vidmoly.to/"}});if(!n)return{url:t};let e=yield n.text();e.includes("eval(function(p,a,c,k,e,d)")&&(e=b(e));let s=e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(s)return{url:s[1],headers:{Referer:"https://vidmoly.to/"}}}catch(n){}return{url:t}})}function Z(t){return m(this,null,function*(){try{let n=yield h(t,{headers:{Referer:"https://uqload.com/"}});if(!n)return{url:t};let e=yield n.text(),s=e.match(/sources\s*:\s*\[["']([^"']+\.(?:mp4|m3u8))["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8))["']/);if(s)return{url:s[1],headers:{Referer:"https://uqload.com/"}}}catch(n){}return{url:t}})}function tt(t){return m(this,null,function*(){try{let n=yield h(t);if(!n)return{url:t};let e=yield n.text(),s=e.match(/window\.location\.href\s*=\s*['"]([^'"]+)['"]/);if(s){let r=yield h(s[1]);r&&(e=yield r.text())}let i=e.match(/'hls'\s*:\s*'([^']+)'/)||e.match(/"hls"\s*:\s*"([^"]+)"/)||e.match(/https?:\/\/[^"']+\.m3u8[^"']*/);if(i){let r=i[1]||i[0];return r.includes("base64")&&(r=O(r.split(",")[1]||r)),{url:r}}}catch(n){}return{url:t}})}function et(t){return m(this,null,function*(){try{let n=yield h(t);if(!n)return{url:t};let e=yield n.text();e.includes("p,a,c,k,e,d")&&(e=b(e));let s=e.match(/robotlink['"]\)\.innerHTML\s*=\s*['"]([^'"]+)['"]\s*\+\s*([^;]+)/);if(s){let i="https:"+s[1],r=s[2].split("+");for(let c of r){let l=c.match(/['"]([^'"]+)['"]/);if(l){let u=l[1],a=c.match(/substring\((\d+)\)/);a&&(u=u.substring(parseInt(a[1]))),i+=u}}return{url:i,headers:{Referer:"https://streamtape.com/"}}}}catch(n){}return{url:t}})}function nt(t){return m(this,null,function*(){try{let n=yield h(t);if(!n)return{url:t};let e=yield n.text(),s=e.match(/video_source\s*:\s*["']([^"']+\.mp4[^"']*)["']/)||e.match(/source\s+src=["']([^"']+\.mp4[^"']*)["']/);if(s)return{url:s[1]}}catch(n){}return{url:t}})}function st(t){return m(this,null,function*(){try{let n=yield h(t);if(!n)return{url:t};let e=yield n.text();e.includes("p,a,c,k,e,d")&&(e=b(e));let s=e.match(/sources\s*:\s*\[["']([^"']+\.(?:m3u8|mp4)[^"']*)["']\]/)||e.match(/file\s*:\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/);if(s){let i=s[1];return i.includes("base64")&&(i=O(i.split(",")[1]||i)),{url:i}}}catch(n){}return{url:t}})}function rt(t){return m(this,null,function*(){try{let n=yield h(t);if(!n)return{url:t};let s=(yield n.text()).match(/["'](https?:\/\/[^"']+\.m3u8[^"']*)["']/);if(s)return{url:s[1]}}catch(n){}return{url:t}})}function it(t){return m(this,null,function*(){var n;try{let e=((n=t.match(/https?:\/\/([^\/]+)/))==null?void 0:n[1])||"dood.to",s=yield h(t);if(!s)return{url:t};let i=yield s.text();i.includes("eval(function(p,a,c,k,e,d)")&&(i=b(i));let r=i.match(/\$\.get\(['"]\/pass_md5\/([^'"]+)['"]/);if(r){let c=r[1],l=`https://${e}/pass_md5/${c}`,u=yield fetch(l,{headers:{Referer:t}});if(u.ok){let a=yield u.text(),o=Math.random().toString(36).substring(2,12);return{url:a+o+"?token="+c+"&expiry="+Date.now()}}}}catch(e){}return{url:t}})}function ot(t){return m(this,null,function*(){try{let n=yield h(t);if(!n)return{url:t};let s=(yield n.text()).match(/file\s*:\s*["']([^"']+\.(?:mp4|m3u8)[^"']*)["']/);if(s)return{url:s[1]}}catch(n){}return{url:t}})}function T(t,n=0){return m(this,null,function*(){var i;if(n>3)return p(d({},t),{isDirect:!1});let e=t.url,s=e.toLowerCase();if(!e||e.includes("google-analytics")||e.includes("doubleclick"))return null;if(s.match(/\.(mp4|m3u8|mkv|webm)(\?.*)?$/)&&!s.includes("html"))return p(d({},t),{isDirect:!0});try{let r=null;if(s.includes("sibnet.ru")?r=yield X(e):s.includes("vidmoly.")?r=yield Y(e):s.includes("uqload.")||s.includes("oneupload.")?r=yield Z(e):s.includes("voe.")?r=yield tt(e):s.includes("streamtape.com")||s.includes("stape")?r=yield et(e):s.includes("dood")||s.includes("ds2play")?r=yield it(e):s.includes("moonplayer")||s.includes("moon.")?r=yield ot(e):s.includes("sendvid.")?r=yield nt(e):s.includes("luluvid.")||s.includes("lulu.")?r=yield st(e):(s.includes("hgcloud.")||s.includes("savefiles."))&&(r=yield rt(e)),!r||r.url===e){let c=yield h(e,{headers:t.headers});if(c){let l=yield c.text();l.includes("p,a,c,k,e,d")&&(l=b(l));let u=l.match(/https?:\/\/[^"']+\.m3u8[^"']*/)||l.match(/https?:\/\/[^"']+\.mp4[^"']*/)||l.match(/file\s*:\s*["']([^"']+)["']/);if(u){let a=u[1]||u[0];a.startsWith("//")&&(a="https:"+a),a.startsWith("http")&&!a.includes(at)&&(r={url:a})}if(!r){let a=l.match(/<iframe\s+[^>]*src=["']([^"']+)["']/i);if(a){let o=a[1];if(o.startsWith("//")&&(o="https:"+o),o.startsWith("/")){let f=(i=e.match(/^https?:\/\/[^\/]+/))==null?void 0:i[0];f&&(o=f+o)}if(o.startsWith("http")&&o!==e)return console.log(`[Resolver] Peeling: Found nested iframe -> ${o}`),yield T(p(d({},t),{url:o}),n+1)}}}}if(r&&r.url!==e&&r.url.startsWith("http")){let c=yield T(p(d({},t),{url:r.url,headers:d(d({},t.headers),r.headers||{})}),n+1);return p(d({},c),{isDirect:!0,originalUrl:e})}}catch(r){}return p(d({},t),{isDirect:!1})})}var at="googletagmanager";var ct="https://arm.haglund.dev/api/v2";var lt="https://v3-cinemeta.strem.io";function F(e){return m(this,arguments,function*(t,n={}){try{let s=new AbortController,i=setTimeout(()=>s.abort(),8e3),r=yield fetch(t,p(d({},n),{signal:s.signal}));return clearTimeout(i),r}catch(s){return console.error(`[ArmSync] Fetch failed: ${t}`,s.message),null}})}function L(t,n){return m(this,null,function*(){if(!t)return null;let e=yield F(`${ct}/themoviedb?id=${t}`);if(e)try{let r=yield e.json(),c=Array.isArray(r)?r[0]:r;if(c&&c.imdb)return c.imdb}catch(r){}let s=`https://www.themoviedb.org/${n==="movie"?"movie":"tv"}/${t}`,i=yield F(s);if(i){let c=(yield i.text()).match(/imdb\.com\/title\/(tt\d+)/);if(c)return c[1]}return null})}function C(t,n,e){return m(this,null,function*(){var a;if(!t||n===0)return null;let s=yield F(`${lt}/meta/series/${t}.json`);if(!s)return null;let i=yield s.json();if(!((a=i==null?void 0:i.meta)!=null&&a.videos))return null;let r=i.meta.videos.filter(o=>o.season>0&&o.episode>0).sort((o,f)=>o.season-f.season||o.episode-f.episode),c=[],l=new Set;for(let o of r){let f=`${o.season}-${o.episode}`;l.has(f)||(l.add(f),c.push(o))}let u=c.findIndex(o=>o.season==n&&o.episode==e);if(u!==-1){let o=u+1;return console.log(`[ArmSync] Resolved: S${n}E${e} -> Absolute ${o}`),o}return null})}var E="https://animevostfr.org";function ut(t,n){return m(this,null,function*(){try{let e=`https://www.themoviedb.org/${n==="movie"?"movie":"tv"}/${t}?language=en-US`,s=yield $(e),i=v.default.load(s),r=i('meta[property="og:title"]').attr("content")||i("h1").first().text()||i("h2").first().text();return r&&r.includes(" (")&&(r=r.split(" (")[0]),r&&r.includes(" - ")&&(r=r.split(" - ")[0]),r=r?r.trim():null,console.log(`[AnimeVOSTFR] TMDB Title found: ${r}`),r}catch(e){return console.error(`[AnimeVOSTFR] Failed to get title from TMDB: ${e.message}`),null}})}function ft(t){return m(this,null,function*(){try{let n=yield $(`${E}/?s=${encodeURIComponent(t)}`),e=v.default.load(n),s=[];e("a").each((a,o)=>{let f=e(o).attr("href")||"",w=e(o).text().trim();f.includes("/animes/")&&w.length>2&&s.push({title:w,url:f})});let i=new Set,r=s.filter(a=>i.has(a.url)?!1:(i.add(a.url),!0));console.log(`[AnimeVOSTFR] Search results: ${r.length}`);let c=a=>a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[':!.,?]/g,"").replace(/\bthe\s+/g,"").replace(/\s+/g," ").trim(),l=c(t),u=r.filter(a=>c(a.title).includes(l));return u.length>0&&console.log(`[AnimeVOSTFR] Found ${u.length} matches for ${t}`),u}catch(n){return console.error(`[AnimeVOSTFR] Search error: ${n.message}`),[]}})}function mt(t,n,e){return m(this,null,function*(){try{let s=yield $(t),i=v.default.load(s),r=[];i('a[href*="/episode/"]').each((a,o)=>{let f=i(o).attr("href")||"",w=i(o).text().trim();r.push({url:f,text:w})}),console.log(`[AnimeVOSTFR] Found ${r.length} episode links`);let c=String(e),l=c.padStart(2,"0"),u=[new RegExp(`(?:^|[^0-9])${c}(?:$|[^0-9])`),new RegExp(`episode-${c}(?:$|[^0-9])`,"i"),new RegExp(`episode-${l}(?:$|[^0-9])`,"i"),new RegExp(`saison-${n}-episode-${c}(?:$|[^0-9])`,"i")];for(let a of u){let o=r.find(f=>a.test(f.url));if(o)return console.log(`[AnimeVOSTFR] Found episode in URL: ${o.url}`),o.url}for(let a of u){let o=r.find(f=>a.test(f.text));if(o)return console.log(`[AnimeVOSTFR] Found episode in text: ${o.url}`),o.url}return null}catch(s){return console.error(`[AnimeVOSTFR] Error finding episode: ${s.message}`),null}})}function dt(t){return m(this,null,function*(){let n=[];try{let e=yield $(t),s=v.default.load(e),i=[];s(".TPlayerNv li").each((c,l)=>{i.push(s(l).text().trim())});let r=[];s(".TPlayerTb").each((c,l)=>{let u=s(l).find("iframe"),a=s(l).find(".lazy-player");u.length&&u.attr("src")?r.push(u.attr("src")):a.length&&a.attr("data-src")&&r.push(a.attr("data-src"))}),console.log(`[AnimeVOSTFR] Found ${r.length} player tabs`);for(let c=0;c<r.length;c++)try{let l=r[c];l.startsWith("/")&&(l=E+l);let u=yield $(l),o=v.default.load(u)("iframe").attr("src");if(o&&o.startsWith("http")){let f=i[c]||`Lecteur ${c+1}`,w=ht(o),x=yield T({name:"AnimeVOSTFR",title:`${w} (${f})`,url:o,quality:"HD",headers:{Referer:E}});n.push(x)}}catch(l){console.error(`[AnimeVOSTFR] Failed to resolve player ${c}: ${l.message}`)}}catch(e){console.error(`[AnimeVOSTFR] Error extracting players: ${e.message}`)}return n})}function ht(t){return t.includes("sibnet")?"Sibnet":t.includes("vidmoly")?"Vidmoly":t.includes("christopheruntilpoint")||t.includes("voe")?"Voe":t.includes("luluvid")?"Luluvid":t.includes("savefiles")?"Savefiles":t.includes("uqload")||t.includes("oneupload")?"Uqload":t.includes("hgcloud")?"HGCloud":t.includes("dood")||t.includes("ds2play")?"Doodstream":t.includes("myvi")||t.includes("mytv")?"MyVi":t.includes("sendvid")?"Sendvid":t.includes("stape")||t.includes("streamtape")?"Streamtape":t.includes("moon")?"Moon":"Player"}function q(t,n,e,s){return m(this,null,function*(){let i=yield ut(t,n);if(!i)return[];let r=[s];try{let o=yield L(t,n);if(o){let f=yield C(o,e,s);f&&f!==s&&r.push(f)}}catch(o){console.warn(`[AnimeVOSTFR] ArmSync failed: ${o.message}`)}let c=yield ft(i);if(!c||c.length===0)return[];c=c.sort((o,f)=>{let w=o.title.toLowerCase(),x=f.title.toLowerCase(),S=`saison ${e}`,y=w.includes(S),g=x.includes(S);return y&&!g?-1:!y&&g?1:0});let l=[],u=new Set,a=new Set;for(let o of c){if(a.has(o.url))continue;a.add(o.url);let f=o.title.toLowerCase(),x=f.includes(" vf")||o.url.includes("vf")?"VF":"VOSTFR",S=f.match(/saison\s*(\d+)/);if(!(S&&parseInt(S[1])!==e&&r.length===1))for(let y of r){let g=yield mt(o.url,e,y);if(g&&!u.has(g)){u.add(g);let k=yield dt(g),W=y===s?"":` (Abs ${y})`;k.forEach(R=>{R.name.includes("(")||(R.name=`AnimeVOSTFR (${x})`),R.title=`${R.title}${W}`}),l.push(...k)}}}return l.length===0&&console.warn(`[AnimeVOSTFR] Episode S${e}E${s} not found (targets: ${r.join(", ")})`),console.log(`[AnimeVOSTFR] Total streams found: ${l.length}`),l})}function pt(t,n,e,s){return m(this,null,function*(){console.log(`[AnimeVOSTFR] Request: ${n} ${t} S${e}E${s}`);try{return yield q(t,n,e,s)}catch(i){return console.error("[AnimeVOSTFR] Error:",i),[]}})}
